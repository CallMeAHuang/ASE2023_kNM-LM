["<s>", "private", "RequestTemplate", "header", "(", "String", "name", ",", "TemplateChunk", ".", ".", ".", "chunks", ")", "{", "if", "(", "chunks", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "return", "appendHeader", "(", "name", ",", "Arrays", ".", "asList", "(", "chunks", ")", ")", ";", "}", "</s>"]
["<s>", "private", "RequestTemplate", "appendHeader", "(", "String", "name", ",", "List", "<", "TemplateChunk", ">", "chunks", ")", "{", "if", "(", "chunks", ".", "isEmpty", "(", ")", ")", "{", "this", ".", "headers", ".", "remove", "(", "name", ")", ";", "return", "this", ";", "}", "this", ".", "headers", ".", "compute", "(", "name", ",", "(", "headerName", ",", "headerTemplate", ")", "-", ">", "{", "if", "(", "headerTemplate", "=", "=", "null", ")", "{", "return", "HeaderTemplate", ".", "from", "(", "name", ",", "chunks", ")", ";", "}", "else", "{", "return", "HeaderTemplate", ".", "appendFrom", "(", "headerTemplate", ",", "chunks", ")", ";", "}", "}", ")", ";", "return", "this", ";", "}", "</s>"]
["<s>", "public", "static", "HeaderTemplate", "from", "(", "String", "name", ",", "List", "<", "TemplateChunk", ">", "chunks", ")", "{", "if", "(", "name", "=", "=", "null", "|", "|", "name", ".", "isEmpty", "(", ")", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "if", "(", "chunks", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "return", "new", "HeaderTemplate", "(", "name", ",", "Util", ".", "UTF_8", ",", "chunks", ")", ";", "}", "</s>"]
["<s>", "public", "static", "HeaderTemplate", "appendFrom", "(", "HeaderTemplate", "headerTemplate", ",", "List", "<", "TemplateChunk", ">", "chunks", ")", "{", "List", "<", "TemplateChunk", ">", "existing", "=", "new", "CopyOnWriteArrayList", "<", ">", "(", "headerTemplate", ".", "getTemplateChunks", "(", ")", ")", ";", "existing", ".", "addAll", "(", "chunks", ")", ";", "return", "from", "(", "headerTemplate", ".", "getName", "(", ")", ",", "existing", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "String", "expand", "(", "Map", "<", "String", ",", "?", ">", "variables", ")", "{", "String", "result", "=", "super", ".", "expand", "(", "variables", ")", ";", "while", "(", "result", ".", "endsWith", "(", "\"", "<STR_LIT:U+002C>", "\"", ")", ")", "{", "result", "=", "result", ".", "replaceAll", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "\"", ")", ";", "}", "result", "=", "result", ".", "replaceAll", "(", "\"", "<STR_LIT:U+002C>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "return", "result", ";", "}", "</s>"]
["<s>", "public", "List", "<", "TemplateChunk", ">", "getTemplateChunks", "(", ")", "{", "return", "Collections", ".", "unmodifiableList", "(", "this", ".", "templateChunks", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "(", "expected", "=", "IllegalArgumentException", ".", "class", ")", "public", "void", "it_should_throw_exception_when_value_is_null_for_chunks", "(", ")", "{", "HeaderTemplate", ".", "from", "(", "\"", "<STR_LIT>", "\"", ",", "null", ")", ";", "exception", ".", "expectMessage", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "it_should_return_expanded_literals", "(", ")", "{", "HeaderTemplate", "headerTemplate", "=", "HeaderTemplate", ".", "create", "(", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "headerTemplate", ".", "expand", "(", "Collections", ".", "singletonMap", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:{}>", "\"", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "expandEmptyCollection", "(", ")", "{", "QueryTemplate", "template", "=", "QueryTemplate", ".", "create", "(", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ",", "Util", ".", "UTF_8", ")", ";", "String", "expanded", "=", "template", ".", "expand", "(", "Collections", ".", "singletonMap", "(", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "emptyList", "(", ")", ")", ")", ";", "assertThat", "(", "expanded", ")", ".", "isEqualToIgnoringCase", "(", "\"", "<STR_LIT:=>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "expandCollection", "(", ")", "{", "QueryTemplate", "template", "=", "QueryTemplate", ".", "create", "(", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ",", "Util", ".", "UTF_8", ")", ";", "String", "expanded", "=", "template", ".", "expand", "(", "Collections", ".", "singletonMap", "(", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "assertThat", "(", "expanded", ")", ".", "isEqualToIgnoringCase", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "testConsumesMultipleWithContentTypeHeaderAndBody", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "final", "JaxRSClientTestInterfaceWithJaxRsContract", "api", "=", "newBuilder", "(", ")", ".", "contract", "(", "new", "JAXRSContract", "(", ")", ")", ".", "target", "(", "JaxRSClientTestInterfaceWithJaxRsContract", ".", "class", ",", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "Response", "response", "=", "api", ".", "consumesMultipleWithContentTypeHeaderAndBody", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "Util", ".", "toString", "(", "response", ".", "body", "(", ")", ".", "asReader", "(", "UTF_8", ")", ")", ")", ";", "MockWebServerAssertions", ".", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasHeaders", "(", "MapEntry", ".", "entry", "(", "\"", "<STR_LIT:Content-Type>", "\"", ",", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ".", "hasMethod", "(", "\"", "<STR_LIT:POST>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "arrayQueryMapParams", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "TestInterface", "api", "=", "new", "TestInterfaceBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "api", ".", "queryArrParams", "(", "Maps", ".", "newHashMap", "(", "\"", "<STR_LIT:1>", "\"", ",", "new", "String", "[", "]", "{", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", "}", ")", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "public", "String", "metricName", "(", "MethodMetadata", "methodMetadata", ",", "Target", "<", "?", ">", "target", ",", "String", "suffix", ")", "{", "return", "MetricRegistry", ".", "name", "(", "metricName", "(", "methodMetadata", ",", "target", ")", ",", "suffix", ")", ";", "}", "</s>"]
["<s>", "public", "String", "metricName", "(", "MethodMetadata", "methodMetadata", ",", "Target", "<", "?", ">", "target", ")", "{", "return", "metricName", "(", "methodMetadata", ".", "targetType", "(", ")", ",", "methodMetadata", ".", "method", "(", ")", ",", "target", ".", "url", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "String", "metricName", "(", "Class", "<", "?", ">", "targetType", ",", "Method", "method", ",", "String", "url", ")", "{", "return", "MetricRegistry", ".", "name", "(", "meteredComponent", ",", "targetType", ".", "getName", "(", ")", ",", "method", ".", "getName", "(", ")", ",", "extractHost", "(", "url", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Response", "execute", "(", "Request", "request", ",", "Options", "options", ")", "throws", "IOException", "{", "final", "RequestTemplate", "template", "=", "request", ".", "requestTemplate", "(", ")", ";", "try", "(", "final", "Timer", ".", "Context", "classTimer", "=", "metricRegistry", ".", "timer", "(", "metricName", ".", "metricName", "(", "template", ".", "methodMetadata", "(", ")", ",", "template", ".", "feignTarget", "(", ")", ")", ",", "metricSuppliers", ".", "timers", "(", ")", ")", ".", "time", "(", ")", ")", "{", "return", "client", ".", "execute", "(", "request", ",", "options", ")", ";", "}", "}", "</s>"]
["<s>", "@", "Override", "public", "Object", "decode", "(", "Response", "response", ",", "Type", "type", ")", "throws", "IOException", ",", "DecodeException", ",", "FeignException", "{", "final", "RequestTemplate", "template", "=", "response", ".", "request", "(", ")", ".", "requestTemplate", "(", ")", ";", "final", "MeteredBody", "body", "=", "response", ".", "body", "(", ")", "=", "=", "null", "?", "null", ":", "new", "MeteredBody", "(", "response", ".", "body", "(", ")", ")", ";", "response", "=", "response", ".", "toBuilder", "(", ")", ".", "body", "(", "body", ")", ".", "build", "(", ")", ";", "final", "Object", "decoded", ";", "try", "(", "final", "Timer", ".", "Context", "classTimer", "=", "metricRegistry", ".", "timer", "(", "metricName", ".", "metricName", "(", "template", ".", "methodMetadata", "(", ")", ",", "template", ".", "feignTarget", "(", ")", ")", ",", "metricSuppliers", ".", "timers", "(", ")", ")", ".", "time", "(", ")", ")", "{", "decoded", "=", "decoder", ".", "decode", "(", "response", ",", "type", ")", ";", "}", "if", "(", "body", "!", "=", "null", ")", "{", "metricRegistry", ".", "histogram", "(", "metricName", ".", "metricName", "(", "template", ".", "methodMetadata", "(", ")", ",", "template", ".", "feignTarget", "(", ")", ",", "\"", "<STR_LIT>", "\"", ")", ",", "metricSuppliers", ".", "histograms", "(", ")", ")", ".", "update", "(", "body", ".", "count", "(", ")", ")", ";", "}", "return", "decoded", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "encode", "(", "Object", "object", ",", "Type", "bodyType", ",", "RequestTemplate", "template", ")", "throws", "EncodeException", "{", "try", "(", "final", "Timer", ".", "Context", "classTimer", "=", "metricRegistry", ".", "timer", "(", "metricName", ".", "metricName", "(", "template", ".", "methodMetadata", "(", ")", ",", "template", ".", "feignTarget", "(", ")", ")", ",", "metricSuppliers", ".", "timers", "(", ")", ")", ".", "time", "(", ")", ")", "{", "encoder", ".", "encode", "(", "object", ",", "bodyType", ",", "template", ")", ";", "}", "if", "(", "template", ".", "body", "(", ")", "!", "=", "null", ")", "{", "metricRegistry", ".", "histogram", "(", "metricName", ".", "metricName", "(", "template", ".", "methodMetadata", "(", ")", ",", "template", ".", "feignTarget", "(", ")", ",", "\"", "<STR_LIT>", "\"", ")", ",", "metricSuppliers", ".", "histograms", "(", ")", ")", ".", "update", "(", "template", ".", "body", "(", ")", ".", "length", ")", ";", "}", "}", "</s>"]
["<s>", "@", "Override", "public", "InvocationHandler", "create", "(", "Target", "target", ",", "Map", "<", "Method", ",", "MethodHandler", ">", "dispatch", ")", "{", "final", "Class", "clientClass", "=", "target", ".", "type", "(", ")", ";", "final", "InvocationHandler", "invocationHandle", "=", "invocationHandler", ".", "create", "(", "target", ",", "dispatch", ")", ";", "return", "(", "proxy", ",", "method", ",", "args", ")", "-", ">", "{", "if", "(", "JAVA_OBJECT_METHODS", ".", "contains", "(", "method", ".", "getName", "(", ")", ")", "|", "|", "Util", ".", "isDefault", "(", "method", ")", ")", "{", "LOG", ".", "trace", "(", "\"", "<STR_LIT>", "\"", ",", "method", ")", ";", "return", "invocationHandle", ".", "invoke", "(", "proxy", ",", "method", ",", "args", ")", ";", "}", "try", "(", "final", "Timer", ".", "Context", "classTimer", "=", "metricRegistry", ".", "timer", "(", "metricName", ".", "metricName", "(", "clientClass", ",", "method", ",", "target", ".", "url", "(", ")", ")", ",", "metricSuppliers", ".", "timers", "(", ")", ")", ".", "time", "(", ")", ")", "{", "return", "invocationHandle", ".", "invoke", "(", "proxy", ",", "method", ",", "args", ")", ";", "}", "catch", "(", "final", "FeignException", "e", ")", "{", "metricRegistry", ".", "meter", "(", "MetricRegistry", ".", "name", "(", "metricName", ".", "metricName", "(", "clientClass", ",", "method", ",", "target", ".", "url", "(", ")", ")", ",", "\"", "<STR_LIT>", "\"", ",", "e", ".", "status", "(", ")", "/", "<NUM_LIT:100>", "+", "\"", "<STR_LIT>", "\"", ",", "String", ".", "valueOf", "(", "e", ".", "status", "(", ")", ")", ")", ",", "metricSuppliers", ".", "meters", "(", ")", ")", ".", "mark", "(", ")", ";", "throw", "e", ";", "}", "catch", "(", "final", "Throwable", "e", ")", "{", "metricRegistry", ".", "meter", "(", "MetricRegistry", ".", "name", "(", "metricName", ".", "metricName", "(", "clientClass", ",", "method", ",", "target", ".", "url", "(", ")", ")", ",", "\"", "<STR_LIT>", "\"", ",", "e", ".", "getClass", "(", ")", ".", "getSimpleName", "(", ")", ")", ",", "metricSuppliers", ".", "meters", "(", ")", ")", ".", "mark", "(", ")", ";", "throw", "e", ";", "}", "}", ";", "}", "</s>"]
["<s>", "public", "MetricRegistry", ".", "MetricSupplier", "<", "Timer", ">", "timers", "(", ")", "{", "return", "(", ")", "-", ">", "new", "Timer", "(", "new", "SlidingTimeWindowArrayReservoir", "(", "1", ",", "TimeUnit", ".", "MINUTES", ")", ")", ";", "}", "</s>"]
["<s>", "public", "MetricRegistry", ".", "MetricSupplier", "<", "Meter", ">", "meters", "(", ")", "{", "return", "Meter", ":", ":", "new", ";", "}", "</s>"]
["<s>", "public", "MetricRegistry", ".", "MetricSupplier", "<", "Histogram", ">", "histograms", "(", ")", "{", "return", "(", ")", "-", ">", "new", "Histogram", "(", "new", "SlidingTimeWindowArrayReservoir", "(", "1", ",", "TimeUnit", ".", "MINUTES", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "addMetricsCapability", "(", ")", "{", "final", "MetricRegistry", "registry", "=", "SharedMetricRegistries", ".", "getOrCreate", "(", "\"", "<STR_LIT>", "\"", ")", ";", "final", "SimpleSource", "source", "=", "Feign", ".", "builder", "(", ")", ".", "client", "(", "new", "MockClient", "(", ")", ".", "ok", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ".", "addCapability", "(", "new", "Metrics4Capability", "(", "registry", ")", ")", ".", "target", "(", "new", "MockTarget", "<", ">", "(", "Metrics4CapabilityTest", ".", "SimpleSource", ".", "class", ")", ")", ";", "source", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ";", "assertThat", "(", "registry", ".", "getMetrics", "(", ")", ",", "aMapWithSize", "(", "<NUM_LIT:6>", ")", ")", ";", "registry", ".", "getMetrics", "(", ")", ".", "keySet", "(", ")", ".", "forEach", "(", "metricName", "-", ">", "assertThat", "(", "\"", "<STR_LIT>", "\"", "+", "metricName", ",", "metricName", ",", "containsString", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "registry", ".", "getMetrics", "(", ")", ".", "keySet", "(", ")", ".", "forEach", "(", "metricName", "-", ">", "assertThat", "(", "\"", "<STR_LIT>", "\"", "+", "metricName", ",", "metricName", ",", "containsString", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "}", "</s>"]
["<s>", "private", "Builder", "newRequestBuilder", "(", "Request", "request", ",", "Options", "options", ")", "throws", "IOException", "{", "URI", "uri", ";", "try", "{", "uri", "=", "new", "URI", "(", "request", ".", "url", "(", ")", ")", ";", "}", "catch", "(", "final", "URISyntaxException", "e", ")", "{", "throw", "new", "IOException", "(", "\"", "<STR_LIT>", "\"", "+", "request", ".", "url", "(", ")", ",", "e", ")", ";", "}", "final", "BodyPublisher", "body", ";", "final", "byte", "[", "]", "data", "=", "request", ".", "body", "(", ")", ";", "if", "(", "data", "=", "=", "null", ")", "{", "body", "=", "BodyPublishers", ".", "noBody", "(", ")", ";", "}", "else", "{", "body", "=", "BodyPublishers", ".", "ofByteArray", "(", "data", ")", ";", "}", "final", "Builder", "requestBuilder", "=", "HttpRequest", ".", "newBuilder", "(", ")", ".", "uri", "(", "uri", ")", ".", "timeout", "(", "Duration", ".", "ofMillis", "(", "options", ".", "readTimeoutMillis", "(", ")", ")", ")", ".", "version", "(", "Version", ".", "HTTP_2", ")", ";", "final", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "headers", "=", "filterRestrictedHeaders", "(", "request", ".", "headers", "(", ")", ")", ";", "if", "(", "!", "headers", ".", "isEmpty", "(", ")", ")", "{", "requestBuilder", ".", "headers", "(", "asString", "(", "headers", ")", ")", ";", "}", "switch", "(", "request", ".", "httpMethod", "(", ")", ")", "{", "case", "GET", ":", "return", "requestBuilder", ".", "GET", "(", ")", ";", "case", "POST", ":", "return", "requestBuilder", ".", "POST", "(", "body", ")", ";", "case", "PUT", ":", "return", "requestBuilder", ".", "PUT", "(", "body", ")", ";", "case", "DELETE", ":", "return", "requestBuilder", ".", "DELETE", "(", ")", ";", "default", ":", "return", "requestBuilder", ".", "method", "(", "request", ".", "httpMethod", "(", ")", ".", "toString", "(", ")", ",", "body", ")", ";", "}", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "timeoutTest", "(", ")", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT>", "\"", ")", ".", "setBodyDelay", "(", "<NUM_LIT:30>", ",", "TimeUnit", ".", "SECONDS", ")", ")", ";", "final", "TestInterface", "api", "=", "newBuilder", "(", ")", ".", "retryer", "(", "Retryer", ".", "NEVER_RETRY", ")", ".", "options", "(", "new", "Request", ".", "Options", "(", "1", ",", "TimeUnit", ".", "SECONDS", ",", "1", ",", "TimeUnit", ".", "SECONDS", ",", "true", ")", ")", ".", "target", "(", "TestInterface", ".", "class", ",", "server", ".", "url", "(", "\"", "<STR_LIT:/>", "\"", ")", ".", "toString", "(", ")", ")", ";", "thrown", ".", "expect", "(", "FeignException", ".", "class", ")", ";", "thrown", ".", "expectCause", "(", "CoreMatchers", ".", "isA", "(", "HttpTimeoutException", ".", "class", ")", ")", ";", "api", ".", "timeout", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "clientPropagatesUncheckedException", "(", ")", "{", "SimpleMeterRegistry", "registry", "=", "new", "SimpleMeterRegistry", "(", "SimpleConfig", ".", "DEFAULT", ",", "new", "MockClock", "(", ")", ")", ";", "final", "AtomicReference", "<", "FeignException", ".", "NotFound", ">", "notFound", "=", "new", "AtomicReference", "<", ">", "(", ")", ";", "final", "SimpleSource", "source", "=", "Feign", ".", "builder", "(", ")", ".", "client", "(", "(", "request", ",", "options", ")", "-", ">", "{", "notFound", ".", "set", "(", "new", "FeignException", ".", "NotFound", "(", "\"", "<STR_LIT>", "\"", ",", "request", ",", "null", ")", ")", ";", "throw", "notFound", ".", "get", "(", ")", ";", "}", ")", ".", "addCapability", "(", "new", "MicrometerCapability", "(", "registry", ")", ")", ".", "target", "(", "new", "MockTarget", "<", ">", "(", "MicrometerCapabilityTest", ".", "SimpleSource", ".", "class", ")", ")", ";", "try", "{", "source", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ";", "fail", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "catch", "(", "FeignException", ".", "NotFound", "e", ")", "{", "assertSame", "(", "notFound", ".", "get", "(", ")", ",", "e", ")", ";", "}", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "decoderPropagatesUncheckedException", "(", ")", "{", "SimpleMeterRegistry", "registry", "=", "new", "SimpleMeterRegistry", "(", "SimpleConfig", ".", "DEFAULT", ",", "new", "MockClock", "(", ")", ")", ";", "final", "AtomicReference", "<", "FeignException", ".", "NotFound", ">", "notFound", "=", "new", "AtomicReference", "<", ">", "(", ")", ";", "final", "SimpleSource", "source", "=", "Feign", ".", "builder", "(", ")", ".", "client", "(", "new", "MockClient", "(", ")", ".", "ok", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ".", "decoder", "(", "(", "response", ",", "type", ")", "-", ">", "{", "notFound", ".", "set", "(", "new", "FeignException", ".", "NotFound", "(", "\"", "<STR_LIT>", "\"", ",", "response", ".", "request", "(", ")", ",", "null", ")", ")", ";", "throw", "notFound", ".", "get", "(", ")", ";", "}", ")", ".", "addCapability", "(", "new", "MicrometerCapability", "(", "registry", ")", ")", ".", "target", "(", "new", "MockTarget", "<", ">", "(", "MicrometerCapabilityTest", ".", "SimpleSource", ".", "class", ")", ")", ";", "try", "{", "source", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ";", "fail", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "catch", "(", "FeignException", ".", "NotFound", "e", ")", "{", "assertSame", "(", "notFound", ".", "get", "(", ")", ",", "e", ")", ";", "}", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "autoDiscoverParamNames", "(", ")", "throws", "Exception", "{", "final", "MethodMetadata", "md", "=", "parseAndValidateMetadata", "(", "AutoDiscoverParamNames", ".", "class", ",", "\"", "<STR_LIT>", "\"", ",", "int", ".", "class", ",", "String", ".", "class", ",", "String", ".", "class", ")", ";", "assertThat", "(", "md", ".", "template", "(", ")", ")", ".", "hasQueries", "(", "entry", "(", "\"", "<STR_LIT>", "\"", ",", "asList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ",", "entry", "(", "\"", "<STR_LIT>", "\"", ",", "asList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "assertThat", "(", "md", ".", "indexToName", "(", ")", ")", ".", "containsExactly", "(", "entry", "(", "0", ",", "asList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ",", "entry", "(", "1", ",", "asList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ",", "entry", "(", "<NUM_LIT:2>", ",", "asList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "}", "</s>"]
["<s>", "private", "HttpClient", "getOrCreateClient", "(", "Options", "options", ")", "{", "if", "(", "doesClientConfigurationDiffer", "(", "options", ")", ")", "{", "java", ".", "net", ".", "http", ".", "HttpClient", ".", "Builder", "builder", "=", "newClientBuilder", "(", "options", ")", ".", "sslContext", "(", "client", ".", "sslContext", "(", ")", ")", ".", "sslParameters", "(", "client", ".", "sslParameters", "(", ")", ")", ".", "version", "(", "client", ".", "version", "(", ")", ")", ";", "client", ".", "authenticator", "(", ")", ".", "ifPresent", "(", "builder", ":", ":", "authenticator", ")", ";", "client", ".", "cookieHandler", "(", ")", ".", "ifPresent", "(", "builder", ":", ":", "cookieHandler", ")", ";", "client", ".", "executor", "(", ")", ".", "ifPresent", "(", "builder", ":", ":", "executor", ")", ";", "client", ".", "proxy", "(", ")", ".", "ifPresent", "(", "builder", ":", ":", "proxy", ")", ";", "return", "builder", ".", "build", "(", ")", ";", "}", "return", "client", ";", "}", "</s>"]
["<s>", "private", "boolean", "doesClientConfigurationDiffer", "(", "Options", "options", ")", "{", "if", "(", "(", "client", ".", "followRedirects", "(", ")", "=", "=", "Redirect", ".", "ALWAYS", ")", "!", "=", "options", ".", "isFollowRedirects", "(", ")", ")", "{", "return", "true", ";", "}", "return", "client", ".", "connectTimeout", "(", ")", ".", "map", "(", "timeout", "-", ">", "timeout", ".", "toMillis", "(", ")", "!", "=", "options", ".", "connectTimeoutMillis", "(", ")", ")", ".", "orElse", "(", "true", ")", ";", "}", "</s>"]
["<s>", "private", "static", "java", ".", "net", ".", "http", ".", "HttpClient", ".", "Builder", "newClientBuilder", "(", "Options", "options", ")", "{", "return", "HttpClient", ".", "newBuilder", "(", ")", ".", "followRedirects", "(", "options", ".", "isFollowRedirects", "(", ")", "?", "Redirect", ".", "ALWAYS", ":", "Redirect", ".", "NEVER", ")", ".", "connectTimeout", "(", "Duration", ".", "ofMillis", "(", "options", ".", "connectTimeoutMillis", "(", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "it_should_support_http_date", "(", ")", "{", "HeaderTemplate", "headerTemplate", "=", "HeaderTemplate", ".", "create", "(", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "headerTemplate", ".", "expand", "(", "Collections", ".", "singletonMap", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ",", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "injectBeanParam", "(", ")", "throws", "Exception", "{", "final", "MethodMetadata", "methodMetadata", "=", "parseAndValidateMetadata", "(", "Jaxrs2Internals", ".", "class", ",", "\"", "<STR_LIT>", "\"", ",", "Input", ".", "class", ")", ";", "assertThat", "(", "methodMetadata", ".", "template", "(", ")", ")", ".", "noRequestBody", "(", ")", ";", "}", "</s>"]
["<s>", "private", "boolean", "isGzip", "(", "Collection", "<", "String", ">", "contentEncodingValues", ")", "{", "return", "contentEncodingValues", "!", "=", "null", "&", "&", "!", "contentEncodingValues", ".", "isEmpty", "(", ")", "&", "&", "contentEncodingValues", ".", "contains", "(", "ENCODING_GZIP", ")", ";", "}", "</s>"]
["<s>", "private", "boolean", "isDeflate", "(", "Collection", "<", "String", ">", "contentEncodingValues", ")", "{", "return", "contentEncodingValues", "!", "=", "null", "&", "&", "!", "contentEncodingValues", ".", "isEmpty", "(", ")", "&", "&", "contentEncodingValues", ".", "contains", "(", "ENCODING_DEFLATE", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "canSupportGzip", "(", ")", "throws", "Exception", "{", "final", "String", "responseData", "=", "\"", "<STR_LIT>", "\"", ";", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "addHeader", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ".", "setBody", "(", "new", "Buffer", "(", ")", ".", "write", "(", "compress", "(", "responseData", ")", ")", ")", ")", ";", "TestInterface", "api", "=", "newBuilder", "(", ")", ".", "target", "(", "TestInterface", ".", "class", ",", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "String", "result", "=", "api", ".", "get", "(", ")", ";", "assertThat", "(", "result", ")", ".", "isNotNull", "(", ")", ".", "isEqualToIgnoringCase", "(", "responseData", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "canSupportDeflate", "(", ")", "throws", "Exception", "{", "final", "String", "responseData", "=", "\"", "<STR_LIT>", "\"", ";", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "addHeader", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ".", "setBody", "(", "new", "Buffer", "(", ")", ".", "write", "(", "deflate", "(", "responseData", ")", ")", ")", ")", ";", "TestInterface", "api", "=", "newBuilder", "(", ")", ".", "target", "(", "TestInterface", ".", "class", ",", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "String", "result", "=", "api", ".", "get", "(", ")", ";", "assertThat", "(", "result", ")", ".", "isNotNull", "(", ")", ".", "isEqualToIgnoringCase", "(", "responseData", ")", ";", "}", "</s>"]
["<s>", "private", "byte", "[", "]", "compress", "(", "String", "data", ")", "throws", "Exception", "{", "try", "(", "ByteArrayOutputStream", "bos", "=", "new", "ByteArrayOutputStream", "(", "data", ".", "length", "(", ")", ")", ")", "{", "GZIPOutputStream", "gzipOutputStream", "=", "new", "GZIPOutputStream", "(", "bos", ")", ";", "gzipOutputStream", ".", "write", "(", "data", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ",", "0", ",", "data", ".", "length", "(", ")", ")", ";", "gzipOutputStream", ".", "close", "(", ")", ";", "return", "bos", ".", "toByteArray", "(", ")", ";", "}", "}", "</s>"]
["<s>", "private", "byte", "[", "]", "deflate", "(", "String", "data", ")", "throws", "Exception", "{", "try", "(", "ByteArrayOutputStream", "bos", "=", "new", "ByteArrayOutputStream", "(", "data", ".", "length", "(", ")", ")", ")", "{", "DeflaterOutputStream", "deflaterOutputStream", "=", "new", "DeflaterOutputStream", "(", "bos", ")", ";", "deflaterOutputStream", ".", "write", "(", "data", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ",", "0", ",", "data", ".", "length", "(", ")", ")", ";", "deflaterOutputStream", ".", "close", "(", ")", ";", "return", "bos", ".", "toByteArray", "(", ")", ";", "}", "}", "</s>"]
["<s>", "public", "Charset", "charset", "(", ")", "{", "Collection", "<", "String", ">", "contentTypeHeaders", "=", "headers", "(", ")", ".", "get", "(", "\"", "<STR_LIT:Content-Type>", "\"", ")", ";", "if", "(", "contentTypeHeaders", "!", "=", "null", ")", "{", "for", "(", "String", "contentTypeHeader", ":", "contentTypeHeaders", ")", "{", "String", "[", "]", "contentTypeParmeters", "=", "contentTypeHeader", ".", "split", "(", "\"", "<STR_LIT:;>", "\"", ")", ";", "if", "(", "contentTypeParmeters", ".", "length", ">", "1", ")", "{", "String", "[", "]", "charsetParts", "=", "contentTypeParmeters", "[", "1", "]", ".", "split", "(", "\"", "<STR_LIT:=>", "\"", ")", ";", "if", "(", "charsetParts", ".", "length", "=", "=", "<NUM_LIT:2>", "&", "&", "\"", "<STR_LIT>", "\"", ".", "equalsIgnoreCase", "(", "charsetParts", "[", "0", "]", ".", "trim", "(", ")", ")", ")", "{", "return", "Charset", ".", "forName", "(", "charsetParts", "[", "1", "]", ")", ";", "}", "}", "}", "}", "return", "Util", ".", "UTF_8", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "decoderCharset", "(", ")", "throws", "IOException", "{", "Zone", "zone", "=", "new", "Zone", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "headers", "=", "new", "HashMap", "<", "String", ",", "Collection", "<", "String", ">", ">", "(", ")", ";", "headers", ".", "put", "(", "\"", "<STR_LIT:Content-Type>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "request", "(", "Request", ".", "create", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "emptyMap", "(", ")", ",", "null", ",", "Util", ".", "UTF_8", ")", ")", ".", "headers", "(", "headers", ")", ".", "body", "(", "new", "String", "(", "\"", "\"", "+", "\"", "<STR_LIT:{>", "\"", "+", "System", ".", "lineSeparator", "(", ")", "+", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "\"", "+", "System", ".", "lineSeparator", "(", ")", "+", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "\"", "+", "System", ".", "lineSeparator", "(", ")", "+", "\"", "<STR_LIT:}>", "\"", ")", ".", "getBytes", "(", "StandardCharsets", ".", "ISO_8859_1", ")", ")", ".", "build", "(", ")", ";", "assertEquals", "(", "zone", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ",", "(", "(", "Zone", ")", "new", "JacksonDecoder", "(", ")", ".", "decode", "(", "response", ",", "new", "TypeReference", "<", "Zone", ">", "(", ")", "{", "}", ".", "getType", "(", ")", ")", ")", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "createFeignExceptionWithCorrectCharsetResponse", "(", ")", "{", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "map", "=", "new", "HashMap", "<", ">", "(", ")", ";", "map", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "new", "ArrayList", "<", ">", "(", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "map", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "new", "ArrayList", "<", ">", "(", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "map", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "new", "ArrayList", "<", ">", "(", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "Request", "request", "=", "Request", ".", "create", "(", "Request", ".", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "emptyMap", "(", ")", ",", "\"", "<STR_LIT>", "\"", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_16BE", ")", ",", "StandardCharsets", ".", "UTF_16BE", ",", "null", ")", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "body", "(", "\"", "<STR_LIT>", "\"", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_16BE", ")", ")", ".", "headers", "(", "map", ")", ".", "request", "(", "request", ")", ".", "build", "(", ")", ";", "FeignException", "exception", "=", "FeignException", ".", "errorStatus", "(", "\"", "<STR_LIT>", "\"", ",", "response", ")", ";", "assertThat", "(", "exception", ".", "getMessage", "(", ")", ")", ".", "isEqualTo", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "createFeignExceptionWithErrorCharsetResponse", "(", ")", "{", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "map", "=", "new", "HashMap", "<", ">", "(", ")", ";", "map", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "new", "ArrayList", "<", ">", "(", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "map", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "new", "ArrayList", "<", ">", "(", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "map", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "new", "ArrayList", "<", ">", "(", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "Request", "request", "=", "Request", ".", "create", "(", "Request", ".", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "emptyMap", "(", ")", ",", "\"", "<STR_LIT>", "\"", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_16BE", ")", ",", "StandardCharsets", ".", "UTF_16BE", ",", "null", ")", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "body", "(", "\"", "<STR_LIT>", "\"", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_16BE", ")", ")", ".", "headers", "(", "map", ")", ".", "request", "(", "request", ")", ".", "build", "(", ")", ";", "FeignException", "exception", "=", "FeignException", ".", "errorStatus", "(", "\"", "<STR_LIT>", "\"", ",", "response", ")", ";", "assertThat", "(", "exception", ".", "getMessage", "(", ")", ")", ".", "isNotEqualTo", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "MetricRegistry", "createMetricsRegistry", "(", ")", "{", "return", "new", "MetricRegistry", "(", ")", ";", "}", "</s>"]
["<s>", "protected", "Capability", "createMetricCapability", "(", ")", "{", "return", "new", "Metrics4Capability", "(", "metricsRegistry", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "Map", "<", "String", ",", "Metric", ">", "getFeignMetrics", "(", ")", "{", "return", "metricsRegistry", ".", "getMetrics", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "doesMetricIdIncludeClient", "(", "String", "metricId", ")", "{", "return", "metricId", ".", "contains", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "doesMetricIncludeVerb", "(", "String", "metricId", ",", "String", "verb", ")", "{", "return", "metricId", ".", "contains", "(", "verb", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "doesMetricIncludeHost", "(", "String", "metricId", ")", "{", "return", "true", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "Metric", "getMetric", "(", "String", "suffix", ",", "String", ".", ".", ".", "tags", ")", "{", "Util", ".", "checkArgument", "(", "tags", ".", "length", "%", "<NUM_LIT:2>", "=", "=", "0", ",", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "toString", "(", "tags", ")", ")", ";", "return", "getFeignMetrics", "(", ")", ".", "entrySet", "(", ")", ".", "stream", "(", ")", ".", "filter", "(", "entry", "-", ">", "{", "String", "name", "=", "entry", ".", "getKey", "(", ")", ";", "if", "(", "!", "name", ".", "contains", "(", "suffix", ")", ")", "{", "return", "false", ";", "}", "for", "(", "int", "i", "=", "0", ";", "i", "<", "tags", ".", "length", ";", "i", "+", "=", "<NUM_LIT:2>", ")", "{", "if", "(", "!", "name", ".", "contains", "(", "tags", "[", "i", "]", ")", "&", "&", "!", "name", ".", "contains", "(", "tags", "[", "i", "]", "+", "1", ")", ")", "{", "return", "false", ";", "}", "}", "return", "true", ";", "}", ")", ".", "findAny", "(", ")", ".", "map", "(", "Entry", ":", ":", "getValue", ")", ".", "orElse", "(", "null", ")", ";", "}", "</s>"]
["<s>", "protected", "Capability", "createMetricCapability", "(", ")", "{", "return", "new", "Metrics5Capability", "(", "metricsRegistry", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "Map", "<", "MetricName", ",", "Metric", ">", "getFeignMetrics", "(", ")", "{", "return", "metricsRegistry", ".", "getMetrics", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "doesMetricIdIncludeClient", "(", "MetricName", "metricId", ")", "{", "return", "hasEntry", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ".", "matches", "(", "metricId", ".", "getTags", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "doesMetricIncludeVerb", "(", "MetricName", "metricId", ",", "String", "verb", ")", "{", "return", "hasEntry", "(", "\"", "<STR_LIT>", "\"", ",", "verb", ")", ".", "matches", "(", "metricId", ".", "getTags", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "doesMetricIncludeHost", "(", "MetricName", "metricId", ")", "{", "return", "hasEntry", "(", "\"", "<STR_LIT>", "\"", ",", "null", ")", ".", "matches", "(", "metricId", ".", "getTags", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "Metric", "getMetric", "(", "String", "suffix", ",", "String", ".", ".", ".", "tags", ")", "{", "Util", ".", "checkArgument", "(", "tags", ".", "length", "%", "<NUM_LIT:2>", "=", "=", "0", ",", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "toString", "(", "tags", ")", ")", ";", "return", "getFeignMetrics", "(", ")", ".", "entrySet", "(", ")", ".", "stream", "(", ")", ".", "filter", "(", "entry", "-", ">", "{", "MetricName", "name", "=", "entry", ".", "getKey", "(", ")", ";", "if", "(", "!", "name", ".", "getKey", "(", ")", ".", "endsWith", "(", "suffix", ")", ")", "{", "return", "false", ";", "}", "for", "(", "int", "i", "=", "0", ";", "i", "<", "tags", ".", "length", ";", "i", "+", "=", "<NUM_LIT:2>", ")", "{", "if", "(", "name", ".", "getTags", "(", ")", ".", "containsKey", "(", "tags", "[", "i", "]", ")", ")", "{", "if", "(", "!", "name", ".", "getTags", "(", ")", ".", "get", "(", "tags", "[", "i", "]", ")", ".", "equals", "(", "tags", "[", "i", "+", "1", "]", ")", ")", "{", "return", "false", ";", "}", "}", "}", "return", "true", ";", "}", ")", ".", "findAny", "(", ")", ".", "map", "(", "Entry", ":", ":", "getValue", ")", ".", "orElse", "(", "null", ")", ";", "}", "</s>"]
["<s>", "@", "Before", "public", "final", "void", "initializeMetricRegistry", "(", ")", "{", "this", ".", "metricsRegistry", "=", "createMetricsRegistry", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "final", "void", "addMetricsCapability", "(", ")", "{", "final", "SimpleSource", "source", "=", "Feign", ".", "builder", "(", ")", ".", "client", "(", "new", "MockClient", "(", ")", ".", "ok", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ".", "addCapability", "(", "createMetricCapability", "(", ")", ")", ".", "target", "(", "new", "MockTarget", "<", ">", "(", "SimpleSource", ".", "class", ")", ")", ";", "source", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ";", "Map", "<", "METRIC_ID", ",", "METRIC", ">", "metrics", "=", "getFeignMetrics", "(", ")", ";", "assertThat", "(", "metrics", ",", "aMapWithSize", "(", "<NUM_LIT:7>", ")", ")", ";", "metrics", ".", "keySet", "(", ")", ".", "forEach", "(", "metricId", "-", ">", "assertThat", "(", "\"", "<STR_LIT>", "\"", "+", "metricId", ",", "doesMetricIdIncludeClient", "(", "metricId", ")", ")", ")", ";", "metrics", ".", "keySet", "(", ")", ".", "forEach", "(", "metricId", "-", ">", "assertThat", "(", "\"", "<STR_LIT>", "\"", "+", "metricId", ",", "doesMetricIncludeVerb", "(", "metricId", ",", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "metrics", ".", "keySet", "(", ")", ".", "forEach", "(", "metricId", "-", ">", "assertThat", "(", "\"", "<STR_LIT>", "\"", "+", "metricId", ",", "doesMetricIncludeHost", "(", "metricId", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "clientPropagatesUncheckedException", "(", ")", "{", "final", "AtomicReference", "<", "FeignException", ".", "NotFound", ">", "notFound", "=", "new", "AtomicReference", "<", ">", "(", ")", ";", "final", "SimpleSource", "source", "=", "Feign", ".", "builder", "(", ")", ".", "client", "(", "(", "request", ",", "options", ")", "-", ">", "{", "notFound", ".", "set", "(", "new", "FeignException", ".", "NotFound", "(", "\"", "<STR_LIT>", "\"", ",", "request", ",", "null", ")", ")", ";", "throw", "notFound", ".", "get", "(", ")", ";", "}", ")", ".", "addCapability", "(", "createMetricCapability", "(", ")", ")", ".", "target", "(", "new", "MockTarget", "<", ">", "(", "MicrometerCapabilityTest", ".", "SimpleSource", ".", "class", ")", ")", ";", "try", "{", "source", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ";", "fail", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "catch", "(", "FeignException", ".", "NotFound", "e", ")", "{", "assertSame", "(", "notFound", ".", "get", "(", ")", ",", "e", ")", ";", "}", "assertThat", "(", "getMetric", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ",", "notNullValue", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "decoderPropagatesUncheckedException", "(", ")", "{", "final", "AtomicReference", "<", "FeignException", ".", "NotFound", ">", "notFound", "=", "new", "AtomicReference", "<", ">", "(", ")", ";", "final", "SimpleSource", "source", "=", "Feign", ".", "builder", "(", ")", ".", "client", "(", "new", "MockClient", "(", ")", ".", "ok", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ".", "decoder", "(", "(", "response", ",", "type", ")", "-", ">", "{", "notFound", ".", "set", "(", "new", "FeignException", ".", "NotFound", "(", "\"", "<STR_LIT>", "\"", ",", "response", ".", "request", "(", ")", ",", "null", ")", ")", ";", "throw", "notFound", ".", "get", "(", ")", ";", "}", ")", ".", "addCapability", "(", "createMetricCapability", "(", ")", ")", ".", "target", "(", "new", "MockTarget", "<", ">", "(", "MicrometerCapabilityTest", ".", "SimpleSource", ".", "class", ")", ")", ";", "try", "{", "source", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ";", "fail", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "catch", "(", "FeignException", ".", "NotFound", "e", ")", "{", "assertSame", "(", "notFound", ".", "get", "(", ")", ",", "e", ")", ";", "}", "}", "</s>"]
["<s>", "@", "Override", "protected", "SimpleMeterRegistry", "createMetricsRegistry", "(", ")", "{", "return", "new", "SimpleMeterRegistry", "(", "SimpleConfig", ".", "DEFAULT", ",", "new", "MockClock", "(", ")", ")", ";", "}", "</s>"]
["<s>", "protected", "Capability", "createMetricCapability", "(", ")", "{", "return", "new", "MicrometerCapability", "(", "metricsRegistry", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "Map", "<", "Id", ",", "Meter", ">", "getFeignMetrics", "(", ")", "{", "List", "<", "Meter", ">", "metrics", "=", "new", "ArrayList", "<", ">", "(", ")", ";", "metricsRegistry", ".", "forEachMeter", "(", "metrics", ":", ":", "add", ")", ";", "metrics", ".", "removeIf", "(", "meter", "-", ">", "!", "meter", ".", "getId", "(", ")", ".", "getName", "(", ")", ".", "startsWith", "(", "\"", "<STR_LIT:.>", "\"", ")", ")", ";", "return", "metrics", ".", "stream", "(", ")", ".", "collect", "(", "Collectors", ".", "toMap", "(", "Meter", ":", ":", "getId", ",", "Function", ".", "identity", "(", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "doesMetricIdIncludeClient", "(", "Id", "metricId", ")", "{", "return", "metricId", ".", "getTag", "(", "\"", "<STR_LIT>", "\"", ")", ".", "contains", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "doesMetricIncludeVerb", "(", "Id", "metricId", ",", "String", "verb", ")", "{", "return", "metricId", ".", "getTag", "(", "\"", "<STR_LIT>", "\"", ")", ".", "equals", "(", "verb", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "doesMetricIncludeHost", "(", "Id", "metricId", ")", "{", "return", "metricId", ".", "getTag", "(", "\"", "<STR_LIT>", "\"", ")", ".", "equals", "(", "\"", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "Meter", "getMetric", "(", "String", "suffix", ",", "String", ".", ".", ".", "tags", ")", "{", "Util", ".", "checkArgument", "(", "tags", ".", "length", "%", "<NUM_LIT:2>", "=", "=", "0", ",", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "toString", "(", "tags", ")", ")", ";", "return", "getFeignMetrics", "(", ")", ".", "entrySet", "(", ")", ".", "stream", "(", ")", ".", "filter", "(", "entry", "-", ">", "{", "Id", "name", "=", "entry", ".", "getKey", "(", ")", ";", "if", "(", "!", "name", ".", "getName", "(", ")", ".", "endsWith", "(", "suffix", ")", ")", "{", "return", "false", ";", "}", "for", "(", "int", "i", "=", "0", ";", "i", "<", "tags", ".", "length", ";", "i", "+", "=", "<NUM_LIT:2>", ")", "{", "if", "(", "name", ".", "getTag", "(", "tags", "[", "i", "]", ")", "!", "=", "null", ")", "{", "if", "(", "!", "name", ".", "getTag", "(", "tags", "[", "i", "]", ")", ".", "equals", "(", "tags", "[", "i", "+", "1", "]", ")", ")", "{", "return", "false", ";", "}", "}", "}", "return", "true", ";", "}", ")", ".", "findAny", "(", ")", ".", "map", "(", "Entry", ":", ":", "getValue", ")", ".", "orElse", "(", "null", ")", ";", "}", "</s>"]
["<s>", "private", "String", "fieldName", "(", "Pair", "<", "Field", ",", "Optional", "<", "Object", ">", ">", "pair", ")", "{", "Param", "alias", "=", "pair", ".", "left", ".", "getAnnotation", "(", "Param", ".", "class", ")", ";", "return", "alias", "!", "=", "null", "?", "alias", ".", "value", "(", ")", ":", "pair", ".", "left", ".", "getName", "(", ")", ";", "}", "</s>"]
["<s>", "private", "Pair", "<", "Field", ",", "Optional", "<", "Object", ">", ">", "FieldValuePair", "(", "Object", "object", ",", "Field", "field", ")", "{", "try", "{", "return", "Pair", ".", "pair", "(", "field", ",", "Optional", ".", "ofNullable", "(", "field", ".", "get", "(", "object", ")", ")", ")", ";", "}", "catch", "(", "IllegalAccessException", "e", ")", "{", "throw", "new", "EncodeException", "(", "\"", "<STR_LIT>", "\"", ",", "e", ")", ";", "}", "}", "</s>"]
["<s>", "public", "static", "<", "T", ",", "U", ">", "Pair", "<", "T", ",", "U", ">", "pair", "(", "T", "left", ",", "U", "right", ")", "{", "return", "new", "Pair", "<", ">", "(", "left", ",", "right", ")", ";", "}", "</s>"]
["<s>", "private", "Lookup", "readLookup", "(", "Class", "<", "?", ">", "declaringClass", ")", "throws", "IllegalAccessException", ",", "InvocationTargetException", ",", "NoSuchFieldException", "{", "try", "{", "return", "safeReadLookup", "(", "declaringClass", ")", ";", "}", "catch", "(", "NoSuchMethodException", "e", ")", "{", "return", "legacyReadLookup", "(", ")", ";", "}", "}", "</s>"]
["<s>", "private", "Lookup", "safeReadLookup", "(", "Class", "<", "?", ">", "declaringClass", ")", "throws", "IllegalAccessException", ",", "InvocationTargetException", ",", "NoSuchMethodException", "{", "Lookup", "lookup", "=", "MethodHandles", ".", "lookup", "(", ")", ";", "Object", "privateLookupIn", "=", "MethodHandles", ".", "class", ".", "getMethod", "(", "\"", "<STR_LIT>", "\"", ",", "Class", ".", "class", ",", "Lookup", ".", "class", ")", ".", "invoke", "(", "null", ",", "declaringClass", ",", "lookup", ")", ";", "return", "(", "Lookup", ")", "privateLookupIn", ";", "}", "</s>"]
["<s>", "private", "Lookup", "legacyReadLookup", "(", ")", "throws", "NoSuchFieldException", ",", "IllegalAccessException", "{", "Field", "field", "=", "Lookup", ".", "class", ".", "getDeclaredField", "(", "\"", "<STR_LIT>", "\"", ")", ";", "field", ".", "setAccessible", "(", "true", ")", ";", "Lookup", "lookup", "=", "(", "Lookup", ")", "field", ".", "get", "(", "null", ")", ";", "return", "lookup", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Object", "decode", "(", "Response", "response", ",", "Type", "type", ")", "throws", "IOException", "{", "Transformer", "transformer", "=", "findTransformer", "(", "response", ",", "type", ")", ";", "if", "(", "response", ".", "body", "(", ")", "=", "=", "null", ")", "{", "return", "null", ";", "}", "Reader", "reader", "=", "response", ".", "body", "(", ")", ".", "asReader", "(", "response", ".", "charset", "(", ")", ")", ";", "if", "(", "!", "reader", ".", "markSupported", "(", ")", ")", "{", "reader", "=", "new", "BufferedReader", "(", "reader", ",", "1", ")", ";", "}", "try", "{", "reader", ".", "mark", "(", "1", ")", ";", "if", "(", "reader", ".", "read", "(", ")", "=", "=", "-", "1", ")", "{", "return", "null", ";", "}", "reader", ".", "reset", "(", ")", ";", "return", "transformer", ".", "apply", "(", "mapper", ",", "reader", ")", ";", "}", "catch", "(", "JSONObjectException", "e", ")", "{", "if", "(", "e", ".", "getCause", "(", ")", "instanceof", "IOException", ")", "{", "throw", "(", "IOException", ")", "e", ".", "getCause", "(", ")", ";", "}", "throw", "e", ";", "}", "}", "</s>"]
["<s>", "private", "static", "Transformer", "findTransformer", "(", "Response", "response", ",", "Type", "type", ")", "{", "if", "(", "type", "instanceof", "Class", ")", "{", "return", "(", "mapper", ",", "reader", ")", "-", ">", "mapper", ".", "beanFrom", "(", "(", "Class", "<", "?", ">", ")", "type", ",", "reader", ")", ";", "}", "if", "(", "type", "instanceof", "ParameterizedType", ")", "{", "Type", "rawType", "=", "(", "(", "ParameterizedType", ")", "type", ")", ".", "getRawType", "(", ")", ";", "Type", "[", "]", "parameterType", "=", "(", "(", "ParameterizedType", ")", "type", ")", ".", "getActualTypeArguments", "(", ")", ";", "if", "(", "rawType", ".", "equals", "(", "List", ".", "class", ")", ")", "{", "return", "(", "mapper", ",", "reader", ")", "-", ">", "mapper", ".", "listOfFrom", "(", "(", "Class", "<", "?", ">", ")", "parameterType", "[", "0", "]", ",", "reader", ")", ";", "}", "if", "(", "rawType", ".", "equals", "(", "Map", ".", "class", ")", ")", "{", "return", "(", "mapper", ",", "reader", ")", "-", ">", "mapper", ".", "mapOfFrom", "(", "(", "Class", "<", "?", ">", ")", "parameterType", "[", "1", "]", ",", "reader", ")", ";", "}", "}", "throw", "new", "DecodeException", "(", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", "+", "type", ".", "getTypeName", "(", ")", ",", "response", ".", "request", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "encode", "(", "Object", "object", ",", "Type", "bodyType", ",", "RequestTemplate", "template", ")", "{", "try", "{", "if", "(", "bodyType", "=", "=", "byte", "[", "]", ".", "class", ")", "{", "template", ".", "body", "(", "mapper", ".", "asBytes", "(", "object", ")", ",", "null", ")", ";", "}", "else", "{", "template", ".", "body", "(", "mapper", ".", "asString", "(", "object", ")", ")", ";", "}", "}", "catch", "(", "IOException", "e", ")", "{", "throw", "new", "EncodeException", "(", "e", ".", "getMessage", "(", ")", ",", "e", ")", ";", "}", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "encodesMapObjectNumericalValuesAsInteger", "(", ")", "{", "Map", "<", "String", ",", "Object", ">", "map", "=", "new", "LinkedHashMap", "<", ">", "(", ")", ";", "map", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "1", ")", ";", "RequestTemplate", "template", "=", "new", "RequestTemplate", "(", ")", ";", "new", "JacksonJrEncoder", "(", ")", ".", "encode", "(", "map", ",", "map", ".", "getClass", "(", ")", ",", "template", ")", ";", "assertThat", "(", "template", ")", ".", "hasBody", "(", "\"", "<STR_LIT:{>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "encodesMapObjectNumericalValuesToByteArray", "(", ")", "{", "Map", "<", "String", ",", "Object", ">", "map", "=", "new", "LinkedHashMap", "<", ">", "(", ")", ";", "map", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "1", ")", ";", "RequestTemplate", "template", "=", "new", "RequestTemplate", "(", ")", ";", "new", "JacksonJrEncoder", "(", ")", ".", "encode", "(", "map", ",", "byte", "[", "]", ".", "class", ",", "template", ")", ";", "assertThat", "(", "template", ")", ".", "hasBody", "(", "\"", "<STR_LIT:{>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "encodesFormParams", "(", ")", "{", "Map", "<", "String", ",", "Object", ">", "form", "=", "new", "LinkedHashMap", "<", "String", ",", "Object", ">", "(", ")", ";", "form", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "1", ")", ";", "form", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "asList", "(", "<NUM_LIT:2>", ",", "<NUM_LIT:3>", ")", ")", ";", "RequestTemplate", "template", "=", "new", "RequestTemplate", "(", ")", ";", "new", "JacksonJrEncoder", "(", ")", ".", "encode", "(", "form", ",", "new", "TypeReference", "<", "Map", "<", "String", ",", "?", ">", ">", "(", ")", "{", "}", ".", "getType", "(", ")", ",", "template", ")", ";", "assertThat", "(", "template", ")", ".", "hasBody", "(", "\"", "<STR_LIT:{>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "decodes", "(", ")", "throws", "Exception", "{", "List", "<", "Zone", ">", "zones", "=", "new", "LinkedList", "<", ">", "(", ")", ";", "zones", ".", "add", "(", "new", "Zone", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "zones", ".", "add", "(", "new", "Zone", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "String", "zonesJson", "=", "\"", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "request", "(", "Request", ".", "create", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "emptyMap", "(", ")", ",", "null", ",", "Util", ".", "UTF_8", ")", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "zonesJson", ",", "UTF_8", ")", ".", "build", "(", ")", ";", "assertEquals", "(", "zones", ",", "new", "JacksonJrDecoder", "(", ")", ".", "decode", "(", "response", ",", "new", "TypeReference", "<", "List", "<", "Zone", ">", ">", "(", ")", "{", "}", ".", "getType", "(", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "nullBodyDecodesToNull", "(", ")", "throws", "Exception", "{", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "request", "(", "Request", ".", "create", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "emptyMap", "(", ")", ",", "null", ",", "Util", ".", "UTF_8", ")", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "build", "(", ")", ";", "assertNull", "(", "new", "JacksonJrDecoder", "(", ")", ".", "decode", "(", "response", ",", "String", ".", "class", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "emptyBodyDecodesToNull", "(", ")", "throws", "Exception", "{", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "request", "(", "Request", ".", "create", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "emptyMap", "(", ")", ",", "null", ",", "Util", ".", "UTF_8", ")", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "new", "byte", "[", "0", "]", ")", ".", "build", "(", ")", ";", "assertNull", "(", "new", "JacksonJrDecoder", "(", ")", ".", "decode", "(", "response", ",", "String", ".", "class", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "customDecoder", "(", ")", "throws", "Exception", "{", "JacksonJrDecoder", "decoder", "=", "new", "JacksonJrDecoder", "(", "singletonList", "(", "new", "JavaLocalDateExtension", "(", ")", ")", ")", ";", "List", "<", "LocalDate", ">", "dates", "=", "new", "LinkedList", "<", ">", "(", ")", ";", "dates", ".", "add", "(", "LocalDate", ".", "of", "(", "<NUM_LIT>", ",", "1", ",", "<NUM_LIT:2>", ")", ")", ";", "dates", ".", "add", "(", "LocalDate", ".", "of", "(", "<NUM_LIT>", ",", "<NUM_LIT:2>", ",", "<NUM_LIT:3>", ")", ")", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "request", "(", "Request", ".", "create", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "emptyMap", "(", ")", ",", "null", ",", "Util", ".", "UTF_8", ")", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "DATES_JSON", ",", "UTF_8", ")", ".", "build", "(", ")", ";", "assertEquals", "(", "dates", ",", "decoder", ".", "decode", "(", "response", ",", "new", "TypeReference", "<", "List", "<", "LocalDate", ">", ">", "(", ")", "{", "}", ".", "getType", "(", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "customDecoderExpressedAsMapper", "(", ")", "throws", "Exception", "{", "JSON", "mapper", "=", "JSON", ".", "builder", "(", ")", ".", "register", "(", "new", "JavaLocalDateExtension", "(", ")", ")", ".", "build", "(", ")", ";", "JacksonJrDecoder", "decoder", "=", "new", "JacksonJrDecoder", "(", "mapper", ")", ";", "List", "<", "LocalDate", ">", "dates", "=", "new", "LinkedList", "<", ">", "(", ")", ";", "dates", ".", "add", "(", "LocalDate", ".", "of", "(", "<NUM_LIT>", ",", "1", ",", "<NUM_LIT:2>", ")", ")", ";", "dates", ".", "add", "(", "LocalDate", ".", "of", "(", "<NUM_LIT>", ",", "<NUM_LIT:2>", ",", "<NUM_LIT:3>", ")", ")", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "request", "(", "Request", ".", "create", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "emptyMap", "(", ")", ",", "null", ",", "Util", ".", "UTF_8", ")", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "DATES_JSON", ",", "UTF_8", ")", ".", "build", "(", ")", ";", "assertEquals", "(", "dates", ",", "decoder", ".", "decode", "(", "response", ",", "new", "TypeReference", "<", "List", "<", "LocalDate", ">", ">", "(", ")", "{", "}", ".", "getType", "(", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "customEncoder", "(", ")", "{", "JacksonJrEncoder", "encoder", "=", "new", "JacksonJrEncoder", "(", "singletonList", "(", "new", "JavaLocalDateExtension", "(", ")", ")", ")", ";", "List", "<", "LocalDate", ">", "dates", "=", "new", "LinkedList", "<", ">", "(", ")", ";", "dates", ".", "add", "(", "LocalDate", ".", "of", "(", "<NUM_LIT>", ",", "1", ",", "<NUM_LIT:2>", ")", ")", ";", "dates", ".", "add", "(", "LocalDate", ".", "of", "(", "<NUM_LIT>", ",", "<NUM_LIT:2>", ",", "<NUM_LIT:3>", ")", ")", ";", "RequestTemplate", "template", "=", "new", "RequestTemplate", "(", ")", ";", "encoder", ".", "encode", "(", "dates", ",", "new", "TypeReference", "<", "List", "<", "LocalDate", ">", ">", "(", ")", "{", "}", ".", "getType", "(", ")", ",", "template", ")", ";", "assertThat", "(", "template", ")", ".", "hasBody", "(", "DATES_JSON", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "decoderCharset", "(", ")", "throws", "IOException", "{", "Zone", "zone", "=", "new", "Zone", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "headers", "=", "new", "HashMap", "<", "String", ",", "Collection", "<", "String", ">", ">", "(", ")", ";", "headers", ".", "put", "(", "\"", "<STR_LIT:Content-Type>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "request", "(", "Request", ".", "create", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "emptyMap", "(", ")", ",", "null", ",", "Util", ".", "UTF_8", ")", ")", ".", "headers", "(", "headers", ")", ".", "body", "(", "new", "String", "(", "\"", "\"", "+", "\"", "<STR_LIT:{>", "\"", "+", "System", ".", "lineSeparator", "(", ")", "+", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "\"", "+", "System", ".", "lineSeparator", "(", ")", "+", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "\"", "+", "System", ".", "lineSeparator", "(", ")", "+", "\"", "<STR_LIT:}>", "\"", ")", ".", "getBytes", "(", "StandardCharsets", ".", "ISO_8859_1", ")", ")", ".", "build", "(", ")", ";", "assertEquals", "(", "zone", ".", "getId", "(", ")", ",", "(", "(", "Zone", ")", "new", "JacksonJrDecoder", "(", ")", ".", "decode", "(", "response", ",", "Zone", ".", "class", ")", ")", ".", "getId", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "decodesToMap", "(", ")", "throws", "Exception", "{", "String", "json", "=", "\"", "<STR_LIT:{>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "request", "(", "Request", ".", "create", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "emptyMap", "(", ")", ",", "null", ",", "Util", ".", "UTF_8", ")", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "json", ",", "UTF_8", ")", ".", "build", "(", ")", ";", "Map", "<", "String", ",", "Object", ">", "map", "=", "(", "Map", "<", "String", ",", "Object", ">", ")", "new", "JacksonJrDecoder", "(", ")", ".", "decode", "(", "response", ",", "new", "TypeReference", "<", "Map", "<", "String", ",", "Object", ">", ">", "(", ")", "{", "}", ".", "getType", "(", ")", ")", ";", "assertEquals", "(", "<NUM_LIT:12>", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "</s>"]
["<s>", "public", "String", "getId", "(", ")", "{", "return", "id", ";", "}", "</s>"]
["<s>", "public", "void", "setId", "(", "String", "id", ")", "{", "this", ".", "id", "=", "id", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "boolean", "equals", "(", "Object", "o", ")", "{", "if", "(", "this", "=", "=", "o", ")", "{", "return", "true", ";", "}", "if", "(", "o", "=", "=", "null", "|", "|", "getClass", "(", ")", "!", "=", "o", ".", "getClass", "(", ")", ")", "{", "return", "false", ";", "}", "Zone", "zone", "=", "(", "Zone", ")", "o", ";", "return", "Objects", ".", "equals", "(", "name", ",", "zone", ".", "name", ")", "&", "&", "Objects", ".", "equals", "(", "id", ",", "zone", ".", "id", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "int", "hashCode", "(", ")", "{", "return", "Objects", ".", "hash", "(", "name", ",", "id", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "String", "toString", "(", ")", "{", "return", "\"", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "\"", "+", "name", "+", "<STR_LIT>", "+", "\"", "<STR_LIT>", "\"", "+", "id", "+", "<STR_LIT>", "+", "<CHAR_LIT:}>", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "notFoundDecodesToNull", "(", ")", "throws", "Exception", "{", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT>", "\"", ")", ".", "request", "(", "Request", ".", "create", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "emptyMap", "(", ")", ",", "null", ",", "Util", ".", "UTF_8", ")", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "build", "(", ")", ";", "assertThat", "(", "(", "byte", "[", "]", ")", "new", "JacksonJrDecoder", "(", ")", ".", "decode", "(", "response", ",", "byte", "[", "]", ".", "class", ")", ")", ".", "isNull", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "ValueReader", "findValueReader", "(", "JSONReader", "readContext", ",", "Class", "<", "?", ">", "type", ")", "{", "return", "type", "=", "=", "LocalDate", ".", "class", "?", "new", "LocalDateValueReader", "(", ")", ":", "null", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "ValueWriter", "findValueWriter", "(", "JSONWriter", "writeContext", ",", "Class", "<", "?", ">", "type", ")", "{", "return", "type", "=", "=", "LocalDate", ".", "class", "?", "new", "LocalDateValueWriter", "(", ")", ":", "null", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Object", "read", "(", "JSONReader", "reader", ",", "JsonParser", "p", ")", "throws", "IOException", "{", "return", "LocalDate", ".", "parse", "(", "p", ".", "getText", "(", ")", ",", "DateTimeFormatter", ".", "ISO_LOCAL_DATE", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "writeValue", "(", "JSONWriter", "context", ",", "JsonGenerator", "g", ",", "Object", "value", ")", "throws", "IOException", "{", "context", ".", "writeValue", "(", "(", "(", "LocalDate", ")", "value", ")", ".", "format", "(", "DateTimeFormatter", ".", "ISO_LOCAL_DATE", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Class", "<", "?", ">", "valueType", "(", ")", "{", "return", "LocalDate", ".", "class", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "void", "register", "(", "ExtensionContext", "ctxt", ")", "{", "ctxt", ".", "insertProvider", "(", "new", "LocalDateReaderWriterProvider", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "static", "void", "main", "(", "String", ".", ".", ".", "args", ")", "{", "GitHub", "github", "=", "Feign", ".", "builder", "(", ")", ".", "decoder", "(", "new", "JacksonJrDecoder", "(", ")", ")", ".", "target", "(", "GitHub", ".", "class", ",", "\"", "<STR_LIT>", "\"", ")", ";", "System", ".", "out", ".", "println", "(", "\"", "<STR_LIT>", "\"", ")", ";", "List", "<", "Contributor", ">", "contributors", "=", "github", ".", "contributors", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "for", "(", "Contributor", "contributor", ":", "contributors", ")", "{", "System", ".", "out", ".", "println", "(", "contributor", ".", "login", "+", "\"", "<STR_LIT>", "\"", "+", "contributor", ".", "contributions", "+", "\"", "<STR_LIT:)>", "\"", ")", ";", "}", "}", "</s>"]
["<s>", "public", "Lookup", "androidLookup", "(", "Class", "<", "?", ">", "declaringClass", ")", "throws", "InstantiationException", ",", "InvocationTargetException", ",", "NoSuchMethodException", ",", "IllegalAccessException", "{", "Lookup", "lookup", ";", "try", "{", "Class", "<", "?", ">", "classReference", "=", "Class", ".", "class", ";", "Class", "<", "?", ">", "[", "]", "classType", "=", "new", "Class", "[", "]", "{", "Class", ".", "class", "}", ";", "Method", "reflectedGetDeclaredConstructor", "=", "classReference", ".", "getDeclaredMethod", "(", "\"", "<STR_LIT>", "\"", ",", "Class", "[", "]", ".", "class", ")", ";", "reflectedGetDeclaredConstructor", ".", "setAccessible", "(", "true", ")", ";", "Constructor", "<", "?", ">", "someHiddenMethod", "=", "(", "Constructor", "<", "?", ">", ")", "reflectedGetDeclaredConstructor", ".", "invoke", "(", "Lookup", ".", "class", ",", "(", "Object", ")", "classType", ")", ";", "lookup", "=", "(", "Lookup", ")", "someHiddenMethod", ".", "newInstance", "(", "declaringClass", ")", ";", "}", "catch", "(", "IllegalAccessException", "ex0", ")", "{", "Constructor", "<", "Lookup", ">", "lookupConstructor", "=", "Lookup", ".", "class", ".", "getDeclaredConstructor", "(", "Class", ".", "class", ")", ";", "lookupConstructor", ".", "setAccessible", "(", "true", ")", ";", "lookup", "=", "lookupConstructor", ".", "newInstance", "(", "declaringClass", ")", ";", "}", "return", "(", "lookup", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Object", "decode", "(", "Response", "response", ",", "Type", "type", ")", "throws", "IOException", ",", "DecodeException", "{", "if", "(", "response", ".", "body", "(", ")", "=", "=", "null", ")", "return", "null", ";", "try", "(", "Reader", "reader", "=", "response", ".", "body", "(", ")", ".", "asReader", "(", "response", ".", "charset", "(", ")", ")", ")", "{", "Reader", "bodyReader", "=", "(", "reader", ".", "markSupported", "(", ")", ")", "?", "reader", ":", "new", "BufferedReader", "(", "reader", ")", ";", "bodyReader", ".", "mark", "(", "1", ")", ";", "if", "(", "bodyReader", ".", "read", "(", ")", "=", "=", "-", "1", ")", "{", "return", "null", ";", "}", "bodyReader", ".", "reset", "(", ")", ";", "return", "decodeJSON", "(", "response", ",", "type", ",", "bodyReader", ")", ";", "}", "catch", "(", "JSONException", "jsonException", ")", "{", "if", "(", "jsonException", ".", "getCause", "(", ")", "!", "=", "null", "&", "&", "jsonException", ".", "getCause", "(", ")", "instanceof", "IOException", ")", "{", "throw", "(", "IOException", ")", "jsonException", ".", "getCause", "(", ")", ";", "}", "throw", "new", "DecodeException", "(", "response", ".", "status", "(", ")", ",", "jsonException", ".", "getMessage", "(", ")", ",", "response", ".", "request", "(", ")", ",", "jsonException", ")", ";", "}", "}", "</s>"]
["<s>", "private", "Object", "decodeJSON", "(", "Response", "response", ",", "Type", "type", ",", "Reader", "reader", ")", "{", "JSONTokener", "tokenizer", "=", "new", "JSONTokener", "(", "reader", ")", ";", "if", "(", "JSONObject", ".", "class", ".", "isAssignableFrom", "(", "(", "Class", "<", "?", ">", ")", "type", ")", ")", "return", "new", "JSONObject", "(", "tokenizer", ")", ";", "else", "if", "(", "JSONArray", ".", "class", ".", "isAssignableFrom", "(", "(", "Class", "<", "?", ">", ")", "type", ")", ")", "return", "new", "JSONArray", "(", "tokenizer", ")", ";", "else", "throw", "new", "DecodeException", "(", "response", ".", "status", "(", ")", ",", "format", "(", "\"", "<STR_LIT>", "\"", ",", "type", ")", ",", "response", ".", "request", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "encode", "(", "Object", "object", ",", "Type", "bodyType", ",", "RequestTemplate", "template", ")", "throws", "EncodeException", "{", "if", "(", "object", "=", "=", "null", ")", "return", ";", "if", "(", "object", "instanceof", "JSONArray", "|", "|", "object", "instanceof", "JSONObject", ")", "{", "template", ".", "body", "(", "object", ".", "toString", "(", ")", ")", ";", "}", "else", "{", "throw", "new", "EncodeException", "(", "format", "(", "\"", "<STR_LIT>", "\"", ",", "bodyType", ")", ")", ";", "}", "}", "</s>"]
["<s>", "@", "Before", "public", "void", "setUp", "(", ")", "{", "mockClient", "=", "new", "MockClient", "(", ")", ";", "github", "=", "Feign", ".", "builder", "(", ")", ".", "decoder", "(", "new", "JsonDecoder", "(", ")", ")", ".", "encoder", "(", "new", "JsonEncoder", "(", ")", ")", ".", "client", "(", "mockClient", ")", ".", "target", "(", "new", "MockTarget", "<", ">", "(", "GitHub", ".", "class", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "decodes", "(", ")", "throws", "IOException", "{", "try", "(", "InputStream", "input", "=", "getClass", "(", ")", ".", "getResourceAsStream", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "byte", "[", "]", "response", "=", "toByteArray", "(", "input", ")", ";", "mockClient", ".", "ok", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "response", ")", ";", "JSONArray", "contributors", "=", "github", ".", "contributors", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "assertThat", "(", "contributors", ".", "toList", "(", ")", ",", "hasSize", "(", "<NUM_LIT:30>", ")", ")", ";", "contributors", ".", "forEach", "(", "contributor", "-", ">", "(", "(", "JSONObject", ")", "contributor", ")", ".", "getString", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "encodes", "(", ")", "{", "JSONObject", "contributor", "=", "new", "JSONObject", "(", ")", ";", "contributor", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "contributor", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "0", ")", ";", "mockClient", ".", "ok", "(", "HttpMethod", ".", "POST", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:{>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ")", ";", "JSONObject", "response", "=", "github", ".", "create", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "contributor", ")", ";", "Request", "request", "=", "mockClient", ".", "verifyOne", "(", "HttpMethod", ".", "POST", ",", "\"", "<STR_LIT>", "\"", ")", ";", "assertNotNull", "(", "request", ".", "body", "(", ")", ")", ";", "String", "json", "=", "new", "String", "(", "request", ".", "body", "(", ")", ")", ";", "assertThat", "(", "json", ",", "containsString", "(", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "\"", ")", ")", ";", "assertThat", "(", "json", ",", "containsString", "(", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "response", ".", "getString", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "0", ",", "response", ".", "getInt", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "</s>"]
["<s>", "@", "BeforeClass", "public", "static", "void", "setUpClass", "(", ")", "{", "jsonObject", "=", "new", "JSONObject", "(", ")", ";", "jsonObject", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "jsonObject", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "1", ")", ";", "jsonArray", "=", "new", "JSONArray", "(", ")", ";", "jsonArray", ".", "put", "(", "jsonObject", ")", ";", "jsonArray", ".", "put", "(", "<NUM_LIT>", ")", ";", "request", "=", "Request", ".", "create", "(", "Request", ".", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "emptyMap", "(", ")", ",", "\"", "<STR_LIT>", "\"", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ",", "StandardCharsets", ".", "UTF_8", ",", "null", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "decodesArray", "(", ")", "throws", "IOException", "{", "String", "json", "=", "\"", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "json", ",", "UTF_8", ")", ".", "request", "(", "request", ")", ".", "build", "(", ")", ";", "assertTrue", "(", "jsonArray", ".", "similar", "(", "new", "JsonDecoder", "(", ")", ".", "decode", "(", "response", ",", "JSONArray", ".", "class", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "decodesObject", "(", ")", "throws", "IOException", "{", "String", "json", "=", "\"", "<STR_LIT:{>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "json", ",", "UTF_8", ")", ".", "request", "(", "request", ")", ".", "build", "(", ")", ";", "assertTrue", "(", "jsonObject", ".", "similar", "(", "new", "JsonDecoder", "(", ")", ".", "decode", "(", "response", ",", "JSONObject", ".", "class", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "nullBodyDecodesToNull", "(", ")", "throws", "IOException", "{", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "request", "(", "request", ")", ".", "build", "(", ")", ";", "assertNull", "(", "new", "JsonDecoder", "(", ")", ".", "decode", "(", "response", ",", "JSONObject", ".", "class", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "emptyBodyDecodesToNull", "(", ")", "throws", "IOException", "{", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "\"", "\"", ",", "UTF_8", ")", ".", "request", "(", "request", ")", ".", "build", "(", ")", ";", "assertNull", "(", "new", "JsonDecoder", "(", ")", ".", "decode", "(", "response", ",", "JSONObject", ".", "class", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "unknownTypeThrowsDecodeException", "(", ")", "throws", "IOException", "{", "String", "json", "=", "\"", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "json", ",", "UTF_8", ")", ".", "request", "(", "request", ")", ".", "build", "(", ")", ";", "Exception", "exception", "=", "assertThrows", "(", "DecodeException", ".", "class", ",", "(", ")", "-", ">", "new", "JsonDecoder", "(", ")", ".", "decode", "(", "response", ",", "Date", ".", "class", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "exception", ".", "getMessage", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "badJsonThrowsWrappedJSONException", "(", ")", "throws", "IOException", "{", "String", "json", "=", "\"", "<STR_LIT:{>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "json", ",", "UTF_8", ")", ".", "request", "(", "request", ")", ".", "build", "(", ")", ";", "Exception", "exception", "=", "assertThrows", "(", "DecodeException", ".", "class", ",", "(", ")", "-", ">", "new", "JsonDecoder", "(", ")", ".", "decode", "(", "response", ",", "JSONArray", ".", "class", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "exception", ".", "getMessage", "(", ")", ")", ";", "assertTrue", "(", "exception", ".", "getCause", "(", ")", "instanceof", "JSONException", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "causedByCommonException", "(", ")", "throws", "IOException", "{", "Response", ".", "Body", "body", "=", "mock", "(", "Response", ".", "Body", ".", "class", ")", ";", "when", "(", "body", ".", "asReader", "(", "any", "(", ")", ")", ")", ".", "thenThrow", "(", "new", "JSONException", "(", "\"", "<STR_LIT>", "\"", ",", "new", "Exception", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "body", ")", ".", "request", "(", "request", ")", ".", "build", "(", ")", ";", "Exception", "exception", "=", "assertThrows", "(", "DecodeException", ".", "class", ",", "(", ")", "-", ">", "new", "JsonDecoder", "(", ")", ".", "decode", "(", "response", ",", "JSONArray", ".", "class", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "exception", ".", "getMessage", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "causedByIOException", "(", ")", "throws", "IOException", "{", "Response", ".", "Body", "body", "=", "mock", "(", "Response", ".", "Body", ".", "class", ")", ";", "when", "(", "body", ".", "asReader", "(", "any", "(", ")", ")", ")", ".", "thenThrow", "(", "new", "JSONException", "(", "\"", "<STR_LIT>", "\"", ",", "new", "IOException", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "body", ")", ".", "request", "(", "request", ")", ".", "build", "(", ")", ";", "Exception", "exception", "=", "assertThrows", "(", "IOException", ".", "class", ",", "(", ")", "-", ">", "new", "JsonDecoder", "(", ")", ".", "decode", "(", "response", ",", "JSONArray", ".", "class", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "exception", ".", "getMessage", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "checkedException", "(", ")", "throws", "IOException", "{", "Response", ".", "Body", "body", "=", "mock", "(", "Response", ".", "Body", ".", "class", ")", ";", "when", "(", "body", ".", "asReader", "(", "any", "(", ")", ")", ")", ".", "thenThrow", "(", "new", "IOException", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "body", ")", ".", "request", "(", "request", ")", ".", "build", "(", ")", ";", "Exception", "exception", "=", "assertThrows", "(", "IOException", ".", "class", ",", "(", ")", "-", ">", "new", "JsonDecoder", "(", ")", ".", "decode", "(", "response", ",", "JSONArray", ".", "class", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "exception", ".", "getMessage", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "decodesExtendedArray", "(", ")", "throws", "IOException", "{", "String", "json", "=", "\"", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "json", ",", "UTF_8", ")", ".", "request", "(", "request", ")", ".", "build", "(", ")", ";", "assertTrue", "(", "jsonArray", ".", "similar", "(", "new", "JsonDecoder", "(", ")", ".", "decode", "(", "response", ",", "ExtendedJSONArray", ".", "class", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "decodeExtendedObject", "(", ")", "throws", "IOException", "{", "String", "json", "=", "\"", "<STR_LIT:{>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "reason", "(", "\"", "<STR_LIT:OK>", "\"", ")", ".", "headers", "(", "Collections", ".", "emptyMap", "(", ")", ")", ".", "body", "(", "json", ",", "UTF_8", ")", ".", "request", "(", "request", ")", ".", "build", "(", ")", ";", "assertTrue", "(", "jsonObject", ".", "similar", "(", "new", "JsonDecoder", "(", ")", ".", "decode", "(", "response", ",", "ExtendedJSONObject", ".", "class", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Before", "public", "void", "setUp", "(", ")", "{", "jsonObject", "=", "new", "JSONObject", "(", ")", ";", "jsonObject", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "jsonObject", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "1", ")", ";", "jsonArray", "=", "new", "JSONArray", "(", ")", ";", "jsonArray", ".", "put", "(", "jsonObject", ")", ";", "jsonArray", ".", "put", "(", "<NUM_LIT>", ")", ";", "requestTemplate", "=", "new", "RequestTemplate", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "encodesArray", "(", ")", "{", "new", "JsonEncoder", "(", ")", ".", "encode", "(", "jsonArray", ",", "JSONArray", ".", "class", ",", "requestTemplate", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ",", "new", "String", "(", "requestTemplate", ".", "body", "(", ")", ",", "UTF_8", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "encodesObject", "(", ")", "{", "new", "JsonEncoder", "(", ")", ".", "encode", "(", "jsonObject", ",", "JSONObject", ".", "class", ",", "requestTemplate", ")", ";", "assertEquals", "(", "\"", "<STR_LIT:{>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "\"", ",", "new", "String", "(", "requestTemplate", ".", "body", "(", ")", ",", "UTF_8", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "encodesNull", "(", ")", "{", "new", "JsonEncoder", "(", ")", ".", "encode", "(", "null", ",", "JSONObject", ".", "class", ",", "new", "RequestTemplate", "(", ")", ")", ";", "assertNull", "(", "requestTemplate", ".", "body", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "unknownTypeThrowsEncodeException", "(", ")", "{", "Exception", "exception", "=", "assertThrows", "(", "EncodeException", ".", "class", ",", "(", ")", "-", ">", "new", "JsonEncoder", "(", ")", ".", "encode", "(", "\"", "<STR_LIT>", "\"", ",", "Date", ".", "class", ",", "new", "RequestTemplate", "(", ")", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "exception", ".", "getMessage", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "static", "void", "main", "(", "String", ".", ".", ".", "args", ")", "{", "GitHub", "github", "=", "Feign", ".", "builder", "(", ")", ".", "decoder", "(", "new", "JsonDecoder", "(", ")", ")", ".", "target", "(", "GitHub", ".", "class", ",", "\"", "<STR_LIT>", "\"", ")", ";", "System", ".", "out", ".", "println", "(", "\"", "<STR_LIT>", "\"", ")", ";", "JSONArray", "contributors", "=", "github", ".", "contributors", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "contributors", ".", "forEach", "(", "contributor", "-", ">", "{", "System", ".", "out", ".", "println", "(", "(", "(", "JSONObject", ")", "contributor", ")", ".", "getString", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Exception", "decode", "(", "String", "methodKey", ",", "Response", "response", ")", "{", "if", "(", "errorHandlerMap", ".", "containsKey", "(", "methodKey", ")", ")", "{", "return", "errorHandlerMap", ".", "get", "(", "methodKey", ")", ".", "decode", "(", "response", ")", ";", "}", "return", "defaultDecoder", ".", "decode", "(", "methodKey", ",", "response", ")", ";", "}", "</s>"]
["<s>", "public", "static", "AnnotationErrorDecoder", ".", "Builder", "builderFor", "(", "Class", "<", "?", ">", "apiType", ")", "{", "return", "new", "Builder", "(", "apiType", ")", ";", "}", "</s>"]
["<s>", "public", "Builder", "withDefaultDecoder", "(", "ErrorDecoder", "defaultDecoder", ")", "{", "this", ".", "defaultDecoder", "=", "defaultDecoder", ";", "return", "this", ";", "}", "</s>"]
["<s>", "public", "Builder", "withResponseBodyDecoder", "(", "Decoder", "responseBodyDecoder", ")", "{", "this", ".", "responseBodyDecoder", "=", "responseBodyDecoder", ";", "return", "this", ";", "}", "</s>"]
["<s>", "public", "AnnotationErrorDecoder", "build", "(", ")", "{", "Map", "<", "String", ",", "MethodErrorHandler", ">", "errorHandlerMap", "=", "generateErrorHandlerMapFromApi", "(", "apiType", ")", ";", "return", "new", "AnnotationErrorDecoder", "(", "errorHandlerMap", ",", "defaultDecoder", ")", ";", "}", "</s>"]
["<s>", "Map", "<", "String", ",", "MethodErrorHandler", ">", "generateErrorHandlerMapFromApi", "(", "Class", "<", "?", ">", "apiType", ")", "{", "ExceptionGenerator", "classLevelDefault", "=", "new", "ExceptionGenerator", ".", "Builder", "(", ")", ".", "withResponseBodyDecoder", "(", "responseBodyDecoder", ")", ".", "withExceptionType", "(", "ErrorHandling", ".", "NO_DEFAULT", ".", "class", ")", ".", "build", "(", ")", ";", "Map", "<", "Integer", ",", "ExceptionGenerator", ">", "classLevelStatusCodeDefinitions", "=", "new", "HashMap", "<", "Integer", ",", "ExceptionGenerator", ">", "(", ")", ";", "Optional", "<", "ErrorHandling", ">", "classLevelErrorHandling", "=", "readErrorHandlingIncludingInherited", "(", "apiType", ")", ";", "if", "(", "classLevelErrorHandling", ".", "isPresent", "(", ")", ")", "{", "ErrorHandlingDefinition", "classErrorHandlingDefinition", "=", "readAnnotation", "(", "classLevelErrorHandling", ".", "get", "(", ")", ",", "responseBodyDecoder", ")", ";", "classLevelDefault", "=", "classErrorHandlingDefinition", ".", "defaultThrow", ";", "classLevelStatusCodeDefinitions", "=", "classErrorHandlingDefinition", ".", "statusCodesMap", ";", "}", "Map", "<", "String", ",", "MethodErrorHandler", ">", "methodErrorHandlerMap", "=", "new", "HashMap", "<", "String", ",", "MethodErrorHandler", ">", "(", ")", ";", "for", "(", "Method", "method", ":", "apiType", ".", "getMethods", "(", ")", ")", "{", "if", "(", "method", ".", "isAnnotationPresent", "(", "ErrorHandling", ".", "class", ")", ")", "{", "ErrorHandlingDefinition", "methodErrorHandling", "=", "readAnnotation", "(", "method", ".", "getAnnotation", "(", "ErrorHandling", ".", "class", ")", ",", "responseBodyDecoder", ")", ";", "ExceptionGenerator", "methodDefault", "=", "methodErrorHandling", ".", "defaultThrow", ";", "if", "(", "methodDefault", ".", "getExceptionType", "(", ")", ".", "equals", "(", "ErrorHandling", ".", "NO_DEFAULT", ".", "class", ")", ")", "{", "methodDefault", "=", "classLevelDefault", ";", "}", "MethodErrorHandler", "methodErrorHandler", "=", "new", "MethodErrorHandler", "(", "methodErrorHandling", ".", "statusCodesMap", ",", "classLevelStatusCodeDefinitions", ",", "methodDefault", ")", ";", "methodErrorHandlerMap", ".", "put", "(", "configKey", "(", "apiType", ",", "method", ")", ",", "methodErrorHandler", ")", ";", "}", "}", "return", "methodErrorHandlerMap", ";", "}", "</s>"]
["<s>", "Optional", "<", "ErrorHandling", ">", "readErrorHandlingIncludingInherited", "(", "Class", "<", "?", ">", "apiType", ")", "{", "if", "(", "apiType", ".", "isAnnotationPresent", "(", "ErrorHandling", ".", "class", ")", ")", "{", "return", "Optional", ".", "of", "(", "apiType", ".", "getAnnotation", "(", "ErrorHandling", ".", "class", ")", ")", ";", "}", "for", "(", "Class", "<", "?", ">", "parentInterface", ":", "apiType", ".", "getInterfaces", "(", ")", ")", "{", "Optional", "<", "ErrorHandling", ">", "errorHandling", "=", "readErrorHandlingIncludingInherited", "(", "parentInterface", ")", ";", "if", "(", "errorHandling", ".", "isPresent", "(", ")", ")", "{", "return", "errorHandling", ";", "}", "}", "if", "(", "!", "apiType", ".", "isInterface", "(", ")", "&", "&", "!", "apiType", ".", "getSuperclass", "(", ")", ".", "equals", "(", "Object", ".", "class", ")", ")", "{", "return", "readErrorHandlingIncludingInherited", "(", "apiType", ".", "getSuperclass", "(", ")", ")", ";", "}", "return", "Optional", ".", "empty", "(", ")", ";", "}", "</s>"]
["<s>", "static", "ErrorHandlingDefinition", "readAnnotation", "(", "ErrorHandling", "errorHandling", ",", "Decoder", "responseBodyDecoder", ")", "{", "ExceptionGenerator", "defaultException", "=", "new", "ExceptionGenerator", ".", "Builder", "(", ")", ".", "withResponseBodyDecoder", "(", "responseBodyDecoder", ")", ".", "withExceptionType", "(", "errorHandling", ".", "defaultException", "(", ")", ")", ".", "build", "(", ")", ";", "Map", "<", "Integer", ",", "ExceptionGenerator", ">", "statusCodesDefinition", "=", "new", "HashMap", "<", "Integer", ",", "ExceptionGenerator", ">", "(", ")", ";", "for", "(", "ErrorCodes", "statusCodeDefinition", ":", "errorHandling", ".", "codeSpecific", "(", ")", ")", "{", "for", "(", "int", "statusCode", ":", "statusCodeDefinition", ".", "codes", "(", ")", ")", "{", "if", "(", "statusCodesDefinition", ".", "containsKey", "(", "statusCode", ")", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "<STR_LIT>", "\"", "+", "statusCode", "+", "\"", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "\"", "+", "statusCodesDefinition", ".", "get", "(", "statusCode", ")", ".", "getExceptionType", "(", ")", ".", "getName", "(", ")", "+", "\"", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "\"", "+", "statusCodeDefinition", ".", "generate", "(", ")", "+", "\"", "<STR_LIT>", "\"", ")", ";", "}", "statusCodesDefinition", ".", "put", "(", "statusCode", ",", "new", "ExceptionGenerator", ".", "Builder", "(", ")", ".", "withResponseBodyDecoder", "(", "responseBodyDecoder", ")", ".", "withExceptionType", "(", "statusCodeDefinition", ".", "generate", "(", ")", ")", ".", "build", "(", ")", ")", ";", "}", "}", "return", "new", "ErrorHandlingDefinition", "(", "defaultException", ",", "statusCodesDefinition", ")", ";", "}", "</s>"]
["<s>", "Exception", "createException", "(", "Response", "response", ")", "throws", "InvocationTargetException", ",", "NoSuchMethodException", ",", "InstantiationException", ",", "IllegalAccessException", "{", "Class", "<", "?", ">", "[", "]", "paramClasses", "=", "new", "Class", "[", "numOfParams", "]", ";", "Object", "[", "]", "paramValues", "=", "new", "Object", "[", "numOfParams", "]", ";", "if", "(", "bodyIndex", ">", "=", "0", ")", "{", "paramClasses", "[", "bodyIndex", "]", "=", "Types", ".", "getRawType", "(", "bodyType", ")", ";", "paramValues", "[", "bodyIndex", "]", "=", "resolveBody", "(", "response", ")", ";", "}", "if", "(", "requestIndex", ">", "=", "0", ")", "{", "paramClasses", "[", "requestIndex", "]", "=", "Request", ".", "class", ";", "paramValues", "[", "requestIndex", "]", "=", "response", ".", "request", "(", ")", ";", "}", "if", "(", "headerMapIndex", ">", "=", "0", ")", "{", "paramValues", "[", "headerMapIndex", "]", "=", "response", ".", "headers", "(", ")", ";", "paramClasses", "[", "headerMapIndex", "]", "=", "Map", ".", "class", ";", "}", "return", "exceptionType", ".", "getConstructor", "(", "paramClasses", ")", ".", "newInstance", "(", "paramValues", ")", ";", "}", "</s>"]
["<s>", "Class", "<", "?", "extends", "Exception", ">", "getExceptionType", "(", ")", "{", "return", "exceptionType", ";", "}", "</s>"]
["<s>", "private", "Object", "resolveBody", "(", "Response", "response", ")", "{", "if", "(", "bodyType", "instanceof", "Class", "<", "?", ">", "&", "&", "(", "(", "Class", "<", "?", ">", ")", "bodyType", ")", ".", "isInstance", "(", "response", ")", ")", "{", "return", "response", ";", "}", "try", "{", "return", "bodyDecoder", ".", "decode", "(", "response", ",", "bodyType", ")", ";", "}", "catch", "(", "IOException", "e", ")", "{", "return", "null", ";", "}", "catch", "(", "DecodeException", "e", ")", "{", "return", "null", ";", "}", "}", "</s>"]
["<s>", "public", "Builder", "withExceptionType", "(", "Class", "<", "?", "extends", "Exception", ">", "exceptionType", ")", "{", "this", ".", "exceptionType", "=", "exceptionType", ";", "return", "this", ";", "}", "</s>"]
["<s>", "public", "Builder", "withResponseBodyDecoder", "(", "Decoder", "bodyDecoder", ")", "{", "this", ".", "responseBodyDecoder", "=", "bodyDecoder", ";", "return", "this", ";", "}", "</s>"]
["<s>", "public", "ExceptionGenerator", "build", "(", ")", "{", "Constructor", "<", "?", "extends", "Exception", ">", "constructor", "=", "getConstructor", "(", "exceptionType", ")", ";", "Type", "[", "]", "parameterTypes", "=", "constructor", ".", "getGenericParameterTypes", "(", ")", ";", "Annotation", "[", "]", "[", "]", "parametersAnnotations", "=", "constructor", ".", "getParameterAnnotations", "(", ")", ";", "Integer", "bodyIndex", "=", "-", "1", ";", "Integer", "requestIndex", "=", "-", "1", ";", "Integer", "headerMapIndex", "=", "-", "1", ";", "Integer", "numOfParams", "=", "parameterTypes", ".", "length", ";", "Type", "bodyType", "=", "null", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "parameterTypes", ".", "length", ";", "i", "+", "+", ")", "{", "Annotation", "[", "]", "paramAnnotations", "=", "parametersAnnotations", "[", "i", "]", ";", "boolean", "foundAnnotation", "=", "false", ";", "for", "(", "Annotation", "annotation", ":", "paramAnnotations", ")", "{", "if", "(", "annotation", ".", "annotationType", "(", ")", ".", "equals", "(", "ResponseHeaders", ".", "class", ")", ")", "{", "checkState", "(", "headerMapIndex", "=", "=", "-", "1", ",", "\"", "<STR_LIT>", "\"", ")", ";", "checkState", "(", "Types", ".", "getRawType", "(", "parameterTypes", "[", "i", "]", ")", ".", "equals", "(", "Map", ".", "class", ")", ",", "\"", "<STR_LIT>", "\"", ",", "parameterTypes", "[", "i", "]", ")", ";", "headerMapIndex", "=", "i", ";", "foundAnnotation", "=", "true", ";", "break", ";", "}", "}", "if", "(", "!", "foundAnnotation", ")", "{", "if", "(", "parameterTypes", "[", "i", "]", ".", "equals", "(", "Request", ".", "class", ")", ")", "{", "checkState", "(", "requestIndex", "=", "=", "-", "1", ",", "\"", "<STR_LIT>", "\"", ")", ";", "requestIndex", "=", "i", ";", "}", "else", "{", "checkState", "(", "bodyIndex", "=", "=", "-", "1", ",", "\"", "<STR_LIT>", "\"", ")", ";", "bodyIndex", "=", "i", ";", "bodyType", "=", "parameterTypes", "[", "i", "]", ";", "}", "}", "}", "ExceptionGenerator", "generator", "=", "new", "ExceptionGenerator", "(", "bodyIndex", ",", "requestIndex", ",", "headerMapIndex", ",", "numOfParams", ",", "bodyType", ",", "exceptionType", ",", "responseBodyDecoder", ")", ";", "validateGeneratorCanBeUsedToGenerateExceptions", "(", "generator", ")", ";", "return", "generator", ";", "}", "</s>"]
["<s>", "private", "void", "validateGeneratorCanBeUsedToGenerateExceptions", "(", "ExceptionGenerator", "generator", ")", "{", "try", "{", "generator", ".", "createException", "(", "TEST_RESPONSE", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "<STR_LIT>", "\"", ",", "e", ")", ";", "}", "}", "</s>"]
["<s>", "private", "Constructor", "<", "?", "extends", "Exception", ">", "getConstructor", "(", "Class", "<", "?", "extends", "Exception", ">", "exceptionClass", ")", "{", "Constructor", "<", "?", "extends", "Exception", ">", "preferredConstructor", "=", "null", ";", "for", "(", "Constructor", "<", "?", ">", "constructor", ":", "exceptionClass", ".", "getConstructors", "(", ")", ")", "{", "FeignExceptionConstructor", "exceptionConstructor", "=", "constructor", ".", "getAnnotation", "(", "FeignExceptionConstructor", ".", "class", ")", ";", "if", "(", "exceptionConstructor", "=", "=", "null", ")", "{", "continue", ";", "}", "Class", "<", "?", ">", "[", "]", "parameterTypes", "=", "constructor", ".", "getParameterTypes", "(", ")", ";", "if", "(", "parameterTypes", ".", "length", "=", "=", "0", ")", "{", "continue", ";", "}", "if", "(", "preferredConstructor", "=", "=", "null", ")", "{", "preferredConstructor", "=", "(", "Constructor", "<", "?", "extends", "Exception", ">", ")", "constructor", ";", "}", "else", "{", "throw", "new", "IllegalStateException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "}", "if", "(", "preferredConstructor", "=", "=", "null", ")", "{", "try", "{", "return", "exceptionClass", ".", "getConstructor", "(", ")", ";", "}", "catch", "(", "NoSuchMethodException", "e", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "<STR_LIT>", "\"", "+", "exceptionClass", ".", "getName", "(", ")", "+", "\"", "<STR_LIT>", "\"", ",", "e", ")", ";", "}", "}", "return", "preferredConstructor", ";", "}", "</s>"]
["<s>", "public", "Exception", "decode", "(", "Response", "response", ")", "{", "ExceptionGenerator", "constructorDefinition", "=", "getConstructorDefinition", "(", "response", ")", ";", "return", "createException", "(", "constructorDefinition", ",", "response", ")", ";", "}", "</s>"]
["<s>", "private", "ExceptionGenerator", "getConstructorDefinition", "(", "Response", "response", ")", "{", "if", "(", "methodLevelExceptionsByCode", ".", "containsKey", "(", "response", ".", "status", "(", ")", ")", ")", "{", "return", "methodLevelExceptionsByCode", ".", "get", "(", "response", ".", "status", "(", ")", ")", ";", "}", "if", "(", "classLevelExceptionsByCode", ".", "containsKey", "(", "response", ".", "status", "(", ")", ")", ")", "{", "return", "classLevelExceptionsByCode", ".", "get", "(", "response", ".", "status", "(", ")", ")", ";", "}", "return", "defaultException", ";", "}", "</s>"]
["<s>", "protected", "Exception", "createException", "(", "ExceptionGenerator", "constructorDefinition", ",", "Response", "response", ")", "{", "try", "{", "return", "constructorDefinition", ".", "createException", "(", "response", ")", ";", "}", "catch", "(", "IllegalAccessException", "e", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "<STR_LIT>", "\"", ",", "e", ")", ";", "}", "catch", "(", "InstantiationException", "e", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "<STR_LIT>", "\"", ",", "e", ")", ";", "}", "catch", "(", "InvocationTargetException", "e", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "<STR_LIT>", "\"", ",", "e", ")", ";", "}", "catch", "(", "NoSuchMethodException", "e", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "<STR_LIT>", "\"", ",", "e", ")", ";", "}", "}", "</s>"]
["<s>", "String", "feignConfigKey", "(", "String", "methodName", ")", "throws", "NoSuchMethodException", "{", "return", "configKey", "(", "interfaceAtTest", "(", ")", ",", "interfaceAtTest", "(", ")", ".", "getMethod", "(", "methodName", ")", ")", ";", "}", "</s>"]
["<s>", "Response", "testResponse", "(", "int", "status", ")", "{", "return", "testResponse", "(", "status", ",", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "Response", "testResponse", "(", "int", "status", ",", "String", "body", ")", "{", "return", "testResponse", "(", "status", ",", "body", ",", "new", "HashMap", "<", "String", ",", "Collection", "<", "String", ">", ">", "(", ")", ")", ";", "}", "</s>"]
["<s>", "Response", "testResponse", "(", "int", "status", ",", "String", "body", ",", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "headers", ")", "{", "return", "Response", ".", "builder", "(", ")", ".", "status", "(", "status", ")", ".", "body", "(", "body", ",", "StandardCharsets", ".", "UTF_8", ")", ".", "headers", "(", "headers", ")", ".", "request", "(", "Request", ".", "create", "(", "Request", ".", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "headers", ",", "Request", ".", "Body", ".", "empty", "(", ")", ",", "null", ")", ")", ".", "build", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Class", "<", "GrandChild", ">", "interfaceAtTest", "(", ")", "{", "return", "GrandChild", ".", "class", ";", "}", "</s>"]
["<s>", "@", "Parameters", "(", "name", "=", "\"", "<STR_LIT>", "\"", ")", "public", "static", "Iterable", "<", "Object", "[", "]", ">", "data", "(", ")", "{", "return", "Arrays", ".", "asList", "(", "new", "Object", "[", "]", "[", "]", "{", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "Method1NotFoundException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "UnauthenticatedOrUnauthorizedException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "Method2NotFoundException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "ServeErrorException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "ServeErrorException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "UnauthenticatedOrUnauthorizedException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "UnauthenticatedOrUnauthorizedException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "ClassLevelNotFoundException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "UnauthenticatedOrUnauthorizedException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "Method1DefaultException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "Method3DefaultException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "ClassLevelDefaultException", ".", "class", "}", ",", "}", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "test", "(", ")", "throws", "Exception", "{", "AnnotationErrorDecoder", "decoder", "=", "AnnotationErrorDecoder", ".", "builderFor", "(", "GrandChild", ".", "class", ")", ".", "build", "(", ")", ";", "assertThat", "(", "decoder", ".", "decode", "(", "feignConfigKey", "(", "method", ")", ",", "testResponse", "(", "errorCode", ")", ")", ".", "getClass", "(", ")", ")", ".", "isEqualTo", "(", "expectedExceptionClass", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Class", "<", "TestClientInterfaceWithDifferentExceptionConstructors", ">", "interfaceAtTest", "(", ")", "{", "return", "TestClientInterfaceWithDifferentExceptionConstructors", ".", "class", ";", "}", "</s>"]
["<s>", "@", "Parameters", "(", "name", "=", "\"", "<STR_LIT>", "\"", ")", "public", "static", "Iterable", "<", "Object", "[", "]", ">", "data", "(", ")", "{", "return", "Arrays", ".", "asList", "(", "new", "Object", "[", "]", "[", "]", "{", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DefaultConstructorException", ".", "class", ",", "NO_REQUEST", ",", "NO_BODY", ",", "NO_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DeclaredDefaultConstructorException", ".", "class", ",", "NO_REQUEST", ",", "NO_BODY", ",", "NO_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DeclaredDefaultConstructorWithOtherConstructorsException", ".", "class", ",", "NO_REQUEST", ",", "NO_BODY", ",", "NO_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DefinedConstructorWithNoAnnotationForBody", ".", "class", ",", "NO_REQUEST", ",", "NON_NULL_BODY", ",", "NO_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DefinedConstructorWithAnnotationForBody", ".", "class", ",", "NO_REQUEST", ",", "NON_NULL_BODY", ",", "NO_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DefinedConstructorWithAnnotationForBodyAndHeaders", ".", "class", ",", "NO_REQUEST", ",", "NON_NULL_BODY", ",", "NON_NULL_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DefinedConstructorWithAnnotationForBodyAndHeadersSecondOrder", ".", "class", ",", "NO_REQUEST", ",", "NON_NULL_BODY", ",", "NON_NULL_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DefinedConstructorWithAnnotationForHeaders", ".", "class", ",", "NO_REQUEST", ",", "NO_BODY", ",", "NON_NULL_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DefinedConstructorWithAnnotationForHeadersButNotForBody", ".", "class", ",", "NO_REQUEST", ",", "NON_NULL_BODY", ",", "NON_NULL_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DefinedConstructorWithAnnotationForNonSupportedBody", ".", "class", ",", "NO_REQUEST", ",", "NULL_BODY", ",", "NO_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DefinedConstructorWithAnnotationForOptionalBody", ".", "class", ",", "NO_REQUEST", ",", "Optional", ".", "of", "(", "NON_NULL_BODY", ")", ",", "NO_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DefinedConstructorWithRequest", ".", "class", ",", "REQUEST", ",", "NO_BODY", ",", "NO_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DefinedConstructorWithRequestAndResponseBody", ".", "class", ",", "REQUEST", ",", "NON_NULL_BODY", ",", "NO_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DefinedConstructorWithRequestAndAnnotationForResponseBody", ".", "class", ",", "REQUEST", ",", "NON_NULL_BODY", ",", "NO_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DefinedConstructorWithRequestAndResponseHeadersAndResponseBody", ".", "class", ",", "REQUEST", ",", "NON_NULL_BODY", ",", "NON_NULL_HEADERS", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "DefinedConstructorWithRequestAndResponseHeadersAndOptionalResponseBody", ".", "class", ",", "REQUEST", ",", "Optional", ".", "of", "(", "NON_NULL_BODY", ")", ",", "NON_NULL_HEADERS", "}", "}", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "test", "(", ")", "throws", "Exception", "{", "AnnotationErrorDecoder", "decoder", "=", "AnnotationErrorDecoder", ".", "builderFor", "(", "TestClientInterfaceWithDifferentExceptionConstructors", ".", "class", ")", ".", "withResponseBodyDecoder", "(", "new", "OptionalDecoder", "(", "new", "Decoder", ".", "Default", "(", ")", ")", ")", ".", "build", "(", ")", ";", "Exception", "genericException", "=", "decoder", ".", "decode", "(", "feignConfigKey", "(", "\"", "<STR_LIT>", "\"", ")", ",", "testResponse", "(", "errorCode", ",", "NON_NULL_BODY", ",", "NON_NULL_HEADERS", ")", ")", ";", "assertThat", "(", "genericException", ")", ".", "isInstanceOf", "(", "expectedExceptionClass", ")", ";", "ParametersException", "exception", "=", "(", "ParametersException", ")", "genericException", ";", "assertThat", "(", "exception", ".", "body", "(", ")", ")", ".", "isEqualTo", "(", "expectedBody", ")", ";", "assertThat", "(", "exception", ".", "headers", "(", ")", ")", ".", "isEqualTo", "(", "expectedHeaders", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "testIfExceptionIsNotInTheList", "(", ")", "throws", "Exception", "{", "AnnotationErrorDecoder", "decoder", "=", "AnnotationErrorDecoder", ".", "builderFor", "(", "TestClientInterfaceWithDifferentExceptionConstructors", ".", "class", ")", ".", "withResponseBodyDecoder", "(", "new", "OptionalDecoder", "(", "new", "Decoder", ".", "Default", "(", ")", ")", ")", ".", "build", "(", ")", ";", "Exception", "genericException", "=", "decoder", ".", "decode", "(", "feignConfigKey", "(", "\"", "<STR_LIT>", "\"", ")", ",", "testResponse", "(", "-", "1", ",", "NON_NULL_BODY", ",", "NON_NULL_HEADERS", ")", ")", ";", "assertThat", "(", "genericException", ")", ".", "isInstanceOf", "(", "ErrorHandling", ".", "NO_DEFAULT", ".", "class", ")", ".", "hasMessage", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "public", "Object", "body", "(", ")", "{", "return", "NO_BODY", ";", "}", "</s>"]
["<s>", "public", "feign", ".", "Request", "request", "(", ")", "{", "return", "null", ";", "}", "</s>"]
["<s>", "public", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "headers", "(", ")", "{", "return", "null", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Object", "body", "(", ")", "{", "return", "body", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "feign", ".", "Request", "request", "(", ")", "{", "return", "request", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "String", "body", "(", ")", "{", "return", "body", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Map", "headers", "(", ")", "{", "return", "headers", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "headers", "(", ")", "{", "return", "headers", ";", "}", "</s>"]
["<s>", "@", "Parameters", "(", "name", "=", "\"", "<STR_LIT>", "\"", ")", "public", "static", "Iterable", "<", "Object", "[", "]", ">", "data", "(", ")", "{", "return", "Arrays", ".", "asList", "(", "new", "Object", "[", "]", "[", "]", "{", "{", "IllegalTestClientInterfaceWithTooManyMappingsToSingleCode", ".", "class", ",", "IllegalStateException", ".", "class", ",", "\"", "<STR_LIT>", "\"", "}", ",", "{", "IllegalTestClientInterfaceWithExceptionWithTooManyConstructors", ".", "class", ",", "IllegalStateException", ".", "class", ",", "\"", "<STR_LIT>", "\"", "}", ",", "{", "IllegalTestClientInterfaceWithExceptionWithTooManyBodyParams", ".", "class", ",", "IllegalStateException", ".", "class", ",", "\"", "<STR_LIT>", "\"", "}", ",", "{", "IllegalTestClientInterfaceWithExceptionWithTooManyHeaderParams", ".", "class", ",", "IllegalStateException", ".", "class", ",", "\"", "<STR_LIT>", "\"", "}", ",", "{", "IllegalTestClientInterfaceWithExceptionWithBadHeaderParams", ".", "class", ",", "IllegalStateException", ".", "class", ",", "\"", "<STR_LIT>", "\"", "}", ",", "{", "IllegalTestClientInterfaceWithExceptionWithBadHeaderObjectParam", ".", "class", ",", "IllegalStateException", ".", "class", ",", "\"", "<STR_LIT>", "\"", "}", ",", "{", "IllegalTestClientInterfaceWithExceptionWithTooManyRequestParams", ".", "class", ",", "IllegalStateException", ".", "class", ",", "\"", "<STR_LIT>", "\"", "}", "}", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "test", "(", ")", "throws", "Exception", "{", "try", "{", "AnnotationErrorDecoder", ".", "builderFor", "(", "testInterface", ")", ".", "build", "(", ")", ";", "fail", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "assertThat", "(", "e", ".", "getClass", "(", ")", ")", ".", "isEqualTo", "(", "expectedExceptionClass", ")", ";", "assertThat", "(", "e", ".", "getMessage", "(", ")", ")", ".", "startsWith", "(", "messageStart", ")", ";", "}", "}", "</s>"]
["<s>", "@", "Override", "public", "Class", "<", "TestClientInterfaceWithExceptionPriority", ">", "interfaceAtTest", "(", ")", "{", "return", "TestClientInterfaceWithExceptionPriority", ".", "class", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "test", "(", ")", "throws", "Exception", "{", "AnnotationErrorDecoder", "decoder", "=", "AnnotationErrorDecoder", ".", "builderFor", "(", "TestClientInterfaceWithExceptionPriority", ".", "class", ")", ".", "build", "(", ")", ";", "assertThat", "(", "decoder", ".", "decode", "(", "feignConfigKey", "(", "method", ")", ",", "testResponse", "(", "errorCode", ")", ")", ".", "getClass", "(", ")", ")", ".", "isEqualTo", "(", "expectedExceptionClass", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Class", "<", "TestClientInterfaceWithNoAnnotations", ">", "interfaceAtTest", "(", ")", "{", "return", "TestClientInterfaceWithNoAnnotations", ".", "class", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "delegatesToDefaultErrorDecoder", "(", ")", "throws", "Exception", "{", "ErrorDecoder", "defaultErrorDecoder", "=", "new", "ErrorDecoder", "(", ")", "{", "@", "Override", "public", "Exception", "decode", "(", "String", "methodKey", ",", "Response", "response", ")", "{", "return", "new", "DefaultErrorDecoderException", "(", ")", ";", "}", "}", ";", "AnnotationErrorDecoder", "decoder", "=", "AnnotationErrorDecoder", ".", "builderFor", "(", "TestClientInterfaceWithNoAnnotations", ".", "class", ")", ".", "withDefaultDecoder", "(", "defaultErrorDecoder", ")", ".", "build", "(", ")", ";", "assertThat", "(", "decoder", ".", "decode", "(", "feignConfigKey", "(", "\"", "<STR_LIT>", "\"", ")", ",", "testResponse", "(", "<NUM_LIT>", ")", ")", ".", "getClass", "(", ")", ")", ".", "isEqualTo", "(", "DefaultErrorDecoderException", ".", "class", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Exception", "decode", "(", "String", "methodKey", ",", "Response", "response", ")", "{", "return", "new", "DefaultErrorDecoderException", "(", ")", ";", "}", "</s>"]
["<s>", "public", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "responseHeaders", "(", ")", "{", "if", "(", "this", ".", "responseHeaders", "=", "=", "null", ")", "{", "return", "Collections", ".", "emptyMap", "(", ")", ";", "}", "return", "responseHeaders", ";", "}", "</s>"]
["<s>", "private", "static", "FeignException", "errorStatus", "(", "int", "status", ",", "String", "message", ",", "Request", "request", ",", "byte", "[", "]", "body", ",", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "headers", ")", "{", "if", "(", "isClientError", "(", "status", ")", ")", "{", "return", "clientErrorStatus", "(", "status", ",", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "}", "if", "(", "isServerError", "(", "status", ")", ")", "{", "return", "serverErrorStatus", "(", "status", ",", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "}", "return", "new", "FeignException", "(", "status", ",", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "}", "</s>"]
["<s>", "private", "static", "FeignClientException", "clientErrorStatus", "(", "int", "status", ",", "String", "message", ",", "Request", "request", ",", "byte", "[", "]", "body", ",", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "headers", ")", "{", "switch", "(", "status", ")", "{", "case", "<NUM_LIT>", ":", "return", "new", "BadRequest", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "case", "<NUM_LIT>", ":", "return", "new", "Unauthorized", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "case", "<NUM_LIT>", ":", "return", "new", "Forbidden", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "case", "<NUM_LIT>", ":", "return", "new", "NotFound", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "case", "<NUM_LIT>", ":", "return", "new", "MethodNotAllowed", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "case", "<NUM_LIT>", ":", "return", "new", "NotAcceptable", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "case", "<NUM_LIT>", ":", "return", "new", "Conflict", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "case", "<NUM_LIT>", ":", "return", "new", "Gone", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "case", "<NUM_LIT>", ":", "return", "new", "UnsupportedMediaType", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "case", "<NUM_LIT>", ":", "return", "new", "TooManyRequests", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "case", "<NUM_LIT>", ":", "return", "new", "UnprocessableEntity", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "default", ":", "return", "new", "FeignClientException", "(", "status", ",", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "}", "}", "</s>"]
["<s>", "private", "static", "FeignServerException", "serverErrorStatus", "(", "int", "status", ",", "String", "message", ",", "Request", "request", ",", "byte", "[", "]", "body", ",", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "headers", ")", "{", "switch", "(", "status", ")", "{", "case", "<NUM_LIT>", ":", "return", "new", "InternalServerError", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "case", "<NUM_LIT>", ":", "return", "new", "NotImplemented", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "case", "<NUM_LIT>", ":", "return", "new", "BadGateway", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "case", "<NUM_LIT>", ":", "return", "new", "ServiceUnavailable", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "case", "<NUM_LIT>", ":", "return", "new", "GatewayTimeout", "(", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "default", ":", "return", "new", "FeignServerException", "(", "status", ",", "message", ",", "request", ",", "body", ",", "headers", ")", ";", "}", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "canGetResponseHeadersFromException", "(", ")", "{", "Request", "request", "=", "Request", ".", "create", "(", "Request", ".", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "emptyMap", "(", ")", ",", "\"", "<STR_LIT>", "\"", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ",", "StandardCharsets", ".", "UTF_8", ",", "null", ")", ";", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "responseHeaders", "=", "new", "HashMap", "<", ">", "(", ")", ";", "responseHeaders", ".", "put", "(", "\"", "<STR_LIT:Content-Type>", "\"", ",", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "responseHeaders", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT:1>", "\"", ",", "\"", "<STR_LIT:2>", "\"", ")", ")", ";", "Response", "response", "=", "Response", ".", "builder", "(", ")", ".", "request", "(", "request", ")", ".", "body", "(", "\"", "<STR_LIT>", "\"", ",", "StandardCharsets", ".", "UTF_8", ")", ".", "headers", "(", "responseHeaders", ")", ".", "build", "(", ")", ";", "FeignException", "exception", "=", "FeignException", ".", "errorStatus", "(", "\"", "<STR_LIT>", "\"", ",", "response", ")", ";", "assertThat", "(", "exception", ".", "responseHeaders", "(", ")", ")", ".", "hasEntrySatisfying", "(", "\"", "<STR_LIT:Content-Type>", "\"", ",", "value", "-", ">", "{", "assertThat", "(", "value", ")", ".", "contains", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", ")", ".", "hasEntrySatisfying", "(", "\"", "<STR_LIT>", "\"", ",", "value", "-", ">", "{", "assertThat", "(", "value", ")", ".", "contains", "(", "\"", "<STR_LIT:1>", "\"", ",", "\"", "<STR_LIT:2>", "\"", ")", ";", "}", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "caseInsensitiveCopyOfMap", "(", ")", "{", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "sourceMap", "=", "new", "HashMap", "<", ">", "(", ")", ";", "sourceMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "sourceMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "singleton", "(", "\"", "<STR_LIT:123>", "\"", ")", ")", ";", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "actualMap", "=", "caseInsensitiveCopyOf", "(", "sourceMap", ")", ";", "assertThat", "(", "actualMap", ")", ".", "hasEntrySatisfying", "(", "\"", "<STR_LIT>", "\"", ",", "value", "-", ">", "{", "assertThat", "(", "value", ")", ".", "contains", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "}", ")", ".", "hasEntrySatisfying", "(", "\"", "<STR_LIT>", "\"", ",", "value", "-", ">", "{", "assertThat", "(", "value", ")", ".", "contains", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "}", ")", ".", "hasEntrySatisfying", "(", "\"", "<STR_LIT>", "\"", ",", "value", "-", ">", "{", "assertThat", "(", "value", ")", ".", "contains", "(", "\"", "<STR_LIT:123>", "\"", ")", ";", "}", ")", ".", "hasEntrySatisfying", "(", "\"", "<STR_LIT>", "\"", ",", "value", "-", ">", "{", "assertThat", "(", "value", ")", ".", "contains", "(", "\"", "<STR_LIT:123>", "\"", ")", ";", "}", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "copyIsUnmodifiable", "(", ")", "{", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "sourceMap", "=", "new", "HashMap", "<", ">", "(", ")", ";", "sourceMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "sourceMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "singleton", "(", "\"", "<STR_LIT:123>", "\"", ")", ")", ";", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "unmodifiableMap", "=", "caseInsensitiveCopyOf", "(", "sourceMap", ")", ";", "assertThatThrownBy", "(", "(", ")", "-", ">", "unmodifiableMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "singleton", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ".", "isInstanceOf", "(", "UnsupportedOperationException", ".", "class", ")", ";", "assertThatThrownBy", "(", "(", ")", "-", ">", "unmodifiableMap", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ".", "clear", "(", ")", ")", ".", "isInstanceOf", "(", "UnsupportedOperationException", ".", "class", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "nullMap", "(", ")", "{", "Map", "<", "String", ",", "Collection", "<", "String", ">", ">", "actualMap", "=", "caseInsensitiveCopyOf", "(", "null", ")", ";", "assertThat", "(", "actualMap", ")", ".", "isNotNull", "(", ")", ".", "isEmpty", "(", ")", ";", "}", "</s>"]
["<s>", "private", "static", "ErrorHandling", "getErrorHandlingAnnotation", "(", "AnnotatedElement", "element", ")", "{", "ErrorHandling", "annotation", "=", "element", ".", "getAnnotation", "(", "ErrorHandling", ".", "class", ")", ";", "if", "(", "annotation", "=", "=", "null", ")", "{", "for", "(", "Annotation", "metaAnnotation", ":", "element", ".", "getAnnotations", "(", ")", ")", "{", "annotation", "=", "metaAnnotation", ".", "annotationType", "(", ")", ".", "getAnnotation", "(", "ErrorHandling", ".", "class", ")", ";", "if", "(", "annotation", "!", "=", "null", ")", "{", "break", ";", "}", "}", "}", "return", "annotation", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Class", "<", "TestClientInterfaceWithWithMetaAnnotation", ">", "interfaceAtTest", "(", ")", "{", "return", "TestClientInterfaceWithWithMetaAnnotation", ".", "class", ";", "}", "</s>"]
["<s>", "@", "Parameters", "(", "name", "=", "\"", "<STR_LIT>", "\"", ")", "public", "static", "Iterable", "<", "Object", "[", "]", ">", "data", "(", ")", "{", "return", "Arrays", ".", "asList", "(", "new", "Object", "[", "]", "[", "]", "{", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "MethodLevelDefaultException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "MethodLevelNotFoundException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "MethodLevelNotFoundException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "ClassLevelDefaultException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "MethodLevelNotFoundException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "ClassLevelNotFoundException", ".", "class", "}", ",", "}", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "test", "(", ")", "throws", "Exception", "{", "AnnotationErrorDecoder", "decoder", "=", "AnnotationErrorDecoder", ".", "builderFor", "(", "TestClientInterfaceWithWithMetaAnnotation", ".", "class", ")", ".", "build", "(", ")", ";", "assertThat", "(", "decoder", ".", "decode", "(", "feignConfigKey", "(", "method", ")", ",", "testResponse", "(", "errorCode", ")", ")", ".", "getClass", "(", ")", ")", ".", "isEqualTo", "(", "expectedExceptionClass", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Class", "<", "SecondLevelInterface", ">", "interfaceAtTest", "(", ")", "{", "return", "SecondLevelInterface", ".", "class", ";", "}", "</s>"]
["<s>", "@", "Parameters", "(", "name", "=", "\"", "<STR_LIT>", "\"", ")", "public", "static", "Iterable", "<", "Object", "[", "]", ">", "data", "(", ")", "{", "return", "Arrays", ".", "asList", "(", "new", "Object", "[", "]", "[", "]", "{", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "SecondLevelClassDefaultException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "SecondLevelMethodDefaultException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "SecondLevelClassAnnotationException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "SecondLevelMethodErrorHandlingException", ".", "class", "}", ",", "}", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "test", "(", ")", "throws", "Exception", "{", "AnnotationErrorDecoder", "decoder", "=", "AnnotationErrorDecoder", ".", "builderFor", "(", "SecondLevelInterface", ".", "class", ")", ".", "build", "(", ")", ";", "assertThat", "(", "decoder", ".", "decode", "(", "feignConfigKey", "(", "method", ")", ",", "testResponse", "(", "errorCode", ")", ")", ".", "getClass", "(", ")", ")", ".", "isEqualTo", "(", "expectedExceptionClass", ")", ";", "}", "</s>"]
["<s>", "@", "Parameters", "(", "name", "=", "\"", "<STR_LIT>", "\"", ")", "public", "static", "Iterable", "<", "Object", "[", "]", ">", "data", "(", ")", "{", "return", "Arrays", ".", "asList", "(", "new", "Object", "[", "]", "[", "]", "{", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "MethodTopLevelDefaultException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "MethodTopLevelAnnotationException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "MethodSecondLevelDefaultException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "MethodSecondLevelAnnotationException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "MethodSecondLevelDefaultException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "MethodSecondLevelErrorHandlingException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "MethodSecondLevelDefaultException", ".", "class", "}", ",", "{", "\"", "<STR_LIT>", "\"", ",", "<NUM_LIT>", ",", "\"", "<STR_LIT>", "\"", ",", "MethodSecondLevelAnnotationException", ".", "class", "}", ",", "}", ")", ";", "}", "</s>"]
["<s>", "public", "static", "Type", "resolveReturnType", "(", "Type", "baseType", ",", "Type", "overridingType", ")", "{", "if", "(", "baseType", "instanceof", "Class", "&", "&", "overridingType", "instanceof", "Class", "&", "&", "(", "(", "Class", "<", "?", ">", ")", "baseType", ")", ".", "isAssignableFrom", "(", "(", "Class", "<", "?", ">", ")", "overridingType", ")", ")", "{", "return", "overridingType", ";", "}", "if", "(", "baseType", "instanceof", "Class", "&", "&", "overridingType", "instanceof", "ParameterizedType", ")", "{", "return", "overridingType", ";", "}", "if", "(", "baseType", "instanceof", "Class", "&", "&", "overridingType", "instanceof", "TypeVariable", ")", "{", "return", "overridingType", ";", "}", "return", "baseType", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "overrideParameterizedApiSupported", "(", ")", "{", "contract", ".", "parseAndValidateMetadata", "(", "OverrideParameterizedApi", ".", "class", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "overrideSimpleApiSupported", "(", ")", "{", "contract", ".", "parseAndValidateMetadata", "(", "OverrideSimpleApi", ".", "class", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "singleInheritance", "(", ")", "{", "contract", ".", "parseAndValidateMetadata", "(", "SingleInheritanceChild", ".", "class", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "multipleInheritanceDoneCorrectly", "(", ")", "{", "contract", ".", "parseAndValidateMetadata", "(", "MultipleInheritanceDoneCorrectly", ".", "class", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "multipleInheritanceDoneCorrectly2", "(", ")", "{", "contract", ".", "parseAndValidateMetadata", "(", "MultipleInheritanceApi", ".", "class", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "multipleInheritanceSupported", "(", ")", "{", "contract", ".", "parseAndValidateMetadata", "(", "GrandChild", ".", "class", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "simple", "(", ")", "{", "Method", "[", "]", "methods", "=", "Simple", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "Simple", ".", "class", ",", "Simple", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "String", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "Object", ".", "class", ",", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "concreteSimple", "(", ")", "{", "Method", "[", "]", "methods", "=", "ConcreteSimple", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "ConcreteSimple", ".", "class", ",", "ConcreteSimple", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "String", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "Object", ".", "class", ",", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "overridingConcreteSimple", "(", ")", "{", "Method", "[", "]", "methods", "=", "OverridingConcreteSimple", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "OverridingConcreteSimple", ".", "class", ",", "OverridingConcreteSimple", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "String", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "Object", ".", "class", ",", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "simplePrimitive", "(", ")", "{", "Method", "[", "]", "methods", "=", "SimplePrimitive", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "SimplePrimitive", ".", "class", ",", "SimplePrimitive", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "long", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "long", ".", "class", ",", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "concreteSimplePrimitive", "(", ")", "{", "Method", "[", "]", "methods", "=", "ConcreteSimplePrimitive", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "ConcreteSimplePrimitive", ".", "class", ",", "ConcreteSimplePrimitive", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "long", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "long", ".", "class", ",", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "overridingConcreteSimplePrimitive", "(", ")", "{", "Method", "[", "]", "methods", "=", "OverridingConcreteSimplePrimitive", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "OverridingConcreteSimplePrimitive", ".", "class", ",", "OverridingConcreteSimplePrimitive", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "long", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "long", ".", "class", ",", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "generic", "(", ")", "{", "Method", "[", "]", "methods", "=", "Generic", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "Generic", ".", "class", ",", "Generic", ".", "class", ",", "Generic", ".", "class", ".", "getMethods", "(", ")", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", "instanceof", "TypeVariable", ")", ".", "isTrue", "(", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "Object", ".", "class", ",", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "concreteSimpleClassGenericSecondLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "ConcreteSimpleClassGenericSecondLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "ConcreteSimpleClassGenericSecondLevel", ".", "class", ",", "ConcreteSimpleClassGenericSecondLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "Long", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "Object", ".", "class", ",", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "overridingConcreteSimpleClassGenericSecondLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "OverridingConcreteSimpleClassGenericSecondLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "<NUM_LIT:2>", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "OverridingConcreteSimpleClassGenericSecondLevel", ".", "class", ",", "OverridingConcreteSimpleClassGenericSecondLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "Long", ".", "class", ")", ";", "Type", "resolved2", "=", "Types", ".", "resolve", "(", "OverridingConcreteSimpleClassGenericSecondLevel", ".", "class", ",", "OverridingConcreteSimpleClassGenericSecondLevel", ".", "class", ",", "methods", "[", "1", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved2", ")", ".", "isEqualTo", "(", "Object", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "resolved", ",", "resolved2", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "concreteSimpleClassMultipleGenericSecondLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "ConcreteSimpleClassMultipleGenericSecondLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "<NUM_LIT:2>", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "ConcreteSimpleClassMultipleGenericSecondLevel", ".", "class", ",", "ConcreteSimpleClassMultipleGenericSecondLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "Long", ".", "class", ")", ";", "Type", "resolved2", "=", "Types", ".", "resolve", "(", "ConcreteSimpleClassMultipleGenericSecondLevel", ".", "class", ",", "ConcreteSimpleClassMultipleGenericSecondLevel", ".", "class", ",", "methods", "[", "1", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "Long", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "resolved", ",", "resolved2", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "overridingConcreteSimpleClassMultipleGenericSecondLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "OverridingConcreteSimpleClassMultipleGenericSecondLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "<NUM_LIT:2>", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "OverridingConcreteSimpleClassMultipleGenericSecondLevel", ".", "class", ",", "OverridingConcreteSimpleClassMultipleGenericSecondLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "Long", ".", "class", ")", ";", "Type", "resolved2", "=", "Types", ".", "resolve", "(", "OverridingConcreteSimpleClassMultipleGenericSecondLevel", ".", "class", ",", "OverridingConcreteSimpleClassMultipleGenericSecondLevel", ".", "class", ",", "methods", "[", "1", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved2", ")", ".", "isEqualTo", "(", "Object", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "resolved", ",", "resolved2", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "realizingSimpleClassGenericThirdLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "RealizingSimpleClassGenericThirdLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "<NUM_LIT:2>", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "RealizingSimpleClassGenericThirdLevel", ".", "class", ",", "RealizingSimpleClassGenericThirdLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "Long", ".", "class", ")", ";", "Type", "resolved2", "=", "Types", ".", "resolve", "(", "RealizingSimpleClassGenericThirdLevel", ".", "class", ",", "RealizingSimpleClassGenericThirdLevel", ".", "class", ",", "methods", "[", "1", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved2", ")", ".", "isEqualTo", "(", "Long", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "resolved", ",", "resolved2", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "realizingSimpleClassMultipleGenericThirdLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "RealizingSimpleClassMultipleGenericThirdLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "<NUM_LIT:2>", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "RealizingSimpleClassMultipleGenericThirdLevel", ".", "class", ",", "RealizingSimpleClassMultipleGenericThirdLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "Long", ".", "class", ")", ";", "Type", "resolved2", "=", "Types", ".", "resolve", "(", "RealizingSimpleClassMultipleGenericThirdLevel", ".", "class", ",", "RealizingSimpleClassMultipleGenericThirdLevel", ".", "class", ",", "methods", "[", "1", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved2", ")", ".", "isEqualTo", "(", "Object", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "resolved", ",", "resolved2", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "realizingOverridingSimpleClassGenericThirdLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "RealizingOverridingSimpleClassGenericThirdLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "<NUM_LIT:2>", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "RealizingOverridingSimpleClassGenericThirdLevel", ".", "class", ",", "RealizingOverridingSimpleClassGenericThirdLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "Long", ".", "class", ")", ";", "Type", "resolved2", "=", "Types", ".", "resolve", "(", "RealizingOverridingSimpleClassGenericThirdLevel", ".", "class", ",", "RealizingOverridingSimpleClassGenericThirdLevel", ".", "class", ",", "methods", "[", "1", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved2", ")", ".", "isEqualTo", "(", "Object", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "resolved", ",", "resolved2", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "realizingOverridingSimpleClassMultipleGenericThirdLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "RealizingOverridingSimpleClassMultipleGenericThirdLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "<NUM_LIT:2>", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "RealizingOverridingSimpleClassMultipleGenericThirdLevel", ".", "class", ",", "RealizingOverridingSimpleClassMultipleGenericThirdLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "Long", ".", "class", ")", ";", "Type", "resolved2", "=", "Types", ".", "resolve", "(", "RealizingOverridingSimpleClassMultipleGenericThirdLevel", ".", "class", ",", "RealizingOverridingSimpleClassMultipleGenericThirdLevel", ".", "class", ",", "methods", "[", "1", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved2", ")", ".", "isEqualTo", "(", "Object", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "resolved", ",", "resolved2", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isNotEqualTo", "(", "resolved2", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "multipleInheritedGeneric", "(", ")", "{", "Method", "[", "]", "methods", "=", "MultipleInheritedGeneric", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "<NUM_LIT:2>", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "MultipleInheritedGeneric", ".", "class", ",", "MultipleInheritedGeneric", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", "instanceof", "TypeVariable", ")", ".", "isTrue", "(", ")", ";", "Type", "resolved2", "=", "Types", ".", "resolve", "(", "MultipleInheritedGeneric", ".", "class", ",", "MultipleInheritedGeneric", ".", "class", ",", "methods", "[", "1", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved2", "instanceof", "TypeVariable", ")", ".", "isTrue", "(", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "resolved", ",", "resolved2", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved2", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "secondLevelSimpleClassGeneric", "(", ")", "{", "Method", "[", "]", "methods", "=", "SecondLevelSimpleClassGeneric", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "SecondLevelSimpleClassGeneric", ".", "class", ",", "SecondLevelSimpleClassGeneric", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", "instanceof", "TypeVariable", ")", ".", "isTrue", "(", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "Object", ".", "class", ",", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "concreteSimpleClassGenericThirdLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "ConcreteSimpleClassGenericThirdLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "ConcreteSimpleClassGenericThirdLevel", ".", "class", ",", "ConcreteSimpleClassGenericThirdLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "Long", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "Object", ".", "class", ",", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "OverridingConcreteSimpleClassGenericThirdLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "OverridingConcreteSimpleClassGenericThirdLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "<NUM_LIT:2>", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "OverridingConcreteSimpleClassGenericThirdLevel", ".", "class", ",", "OverridingConcreteSimpleClassGenericThirdLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", ")", ".", "isEqualTo", "(", "Long", ".", "class", ")", ";", "Type", "resolved2", "=", "Types", ".", "resolve", "(", "OverridingConcreteSimpleClassGenericThirdLevel", ".", "class", ",", "OverridingConcreteSimpleClassGenericThirdLevel", ".", "class", ",", "methods", "[", "1", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved2", ")", ".", "isEqualTo", "(", "Object", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "resolved", ",", "resolved2", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "secondLevelCollectionGeneric", "(", ")", "{", "Method", "[", "]", "methods", "=", "SecondLevelCollectionGeneric", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "SecondLevelCollectionGeneric", ".", "class", ",", "SecondLevelCollectionGeneric", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", "instanceof", "TypeVariable", ")", ".", "isTrue", "(", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "Object", ".", "class", ",", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "thirdLevelCollectionGeneric", "(", ")", "{", "Method", "[", "]", "methods", "=", "ThirdLevelCollectionGeneric", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "ThirdLevelCollectionGeneric", ".", "class", ",", "ThirdLevelCollectionGeneric", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", "instanceof", "TypeVariable", ")", ".", "isTrue", "(", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "Object", ".", "class", ",", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "concreteCollectionGenericFourthLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "ConcreteCollectionGenericFourthLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "ConcreteCollectionGenericFourthLevel", ".", "class", ",", "ConcreteCollectionGenericFourthLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", "instanceof", "ParameterizedType", ")", ".", "isTrue", "(", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "Object", ".", "class", ",", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "overridingConcreteCollectionGenericFourthLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "OverridingConcreteCollectionGenericFourthLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "<NUM_LIT:2>", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "OverridingConcreteCollectionGenericFourthLevel", ".", "class", ",", "OverridingConcreteCollectionGenericFourthLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", "instanceof", "ParameterizedType", ")", ".", "isTrue", "(", ")", ";", "Type", "resolved2", "=", "Types", ".", "resolve", "(", "OverridingConcreteCollectionGenericFourthLevel", ".", "class", ",", "OverridingConcreteCollectionGenericFourthLevel", ".", "class", ",", "methods", "[", "1", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved2", ")", ".", "isEqualTo", "(", "Object", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "resolved", ",", "resolved2", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "overrideOverridingConcreteCollectionGenericFourthLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "OverrideOverridingConcreteCollectionGenericFourthLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "<NUM_LIT:2>", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "OverrideOverridingConcreteCollectionGenericFourthLevel", ".", "class", ",", "OverrideOverridingConcreteCollectionGenericFourthLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", "instanceof", "ParameterizedType", ")", ".", "isTrue", "(", ")", ";", "Type", "resolved2", "=", "Types", ".", "resolve", "(", "OverrideOverridingConcreteCollectionGenericFourthLevel", ".", "class", ",", "OverrideOverridingConcreteCollectionGenericFourthLevel", ".", "class", ",", "methods", "[", "1", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved2", ")", ".", "isEqualTo", "(", "Object", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "resolved", ",", "resolved2", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "genericFourthLevelCollectionGeneric", "(", ")", "{", "Method", "[", "]", "methods", "=", "GenericFourthLevelCollectionGeneric", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "GenericFourthLevelCollectionGeneric", ".", "class", ",", "GenericFourthLevelCollectionGeneric", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", "instanceof", "ParameterizedType", ")", ".", "isTrue", "(", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "Object", ".", "class", ",", "resolved", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "concreteGenericCollectionGenericFifthLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "ConcreteGenericCollectionGenericFifthLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "1", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "ConcreteGenericCollectionGenericFifthLevel", ".", "class", ",", "ConcreteGenericCollectionGenericFifthLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", "instanceof", "ParameterizedType", ")", ".", "isTrue", "(", ")", ";", "ParameterizedType", "parameterizedType", "=", "(", "ParameterizedType", ")", "resolved", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "overridingConcreteGenericCollectionGenericFifthLevel", "(", ")", "{", "Method", "[", "]", "methods", "=", "OverridingConcreteGenericCollectionGenericFifthLevel", ".", "class", ".", "getMethods", "(", ")", ";", "Assertions", ".", "assertThat", "(", "methods", ".", "length", ")", ".", "isEqualTo", "(", "<NUM_LIT:2>", ")", ";", "Type", "resolved", "=", "Types", ".", "resolve", "(", "OverridingConcreteGenericCollectionGenericFifthLevel", ".", "class", ",", "OverridingConcreteGenericCollectionGenericFifthLevel", ".", "class", ",", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved", "instanceof", "ParameterizedType", ")", ".", "isTrue", "(", ")", ";", "Type", "resolved2", "=", "Types", ".", "resolve", "(", "OverridingConcreteGenericCollectionGenericFifthLevel", ".", "class", ",", "OverridingConcreteGenericCollectionGenericFifthLevel", ".", "class", ",", "methods", "[", "1", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolved2", ")", ".", "isEqualTo", "(", "Object", ".", "class", ")", ";", "Type", "resolvedType", "=", "Types", ".", "resolveReturnType", "(", "methods", "[", "0", "]", ".", "getGenericReturnType", "(", ")", ",", "methods", "[", "1", "]", ".", "getGenericReturnType", "(", ")", ")", ";", "Assertions", ".", "assertThat", "(", "resolvedType", ")", ".", "isEqualTo", "(", "resolved", ")", ";", "}", "</s>"]
["<s>", "@", "Experimental", "public", "boolean", "alwaysEncodeBody", "(", ")", "{", "return", "alwaysEncodeBody", ";", "}", "</s>"]
["<s>", "@", "Experimental", "MethodMetadata", "alwaysEncodeBody", "(", "boolean", "alwaysEncodeBody", ")", "{", "this", ".", "alwaysEncodeBody", "=", "alwaysEncodeBody", ";", "return", "this", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "encode", "(", "Object", "object", ",", "Type", "bodyType", ",", "RequestTemplate", "template", ")", "throws", "EncodeException", "{", "Object", "[", "]", "methodParameters", "=", "(", "Object", "[", "]", ")", "object", ";", "String", "body", "=", "Arrays", ".", "stream", "(", "methodParameters", ")", ".", "map", "(", "String", ":", ":", "valueOf", ")", ".", "collect", "(", "Collectors", ".", "joining", "(", ")", ")", ";", "template", ".", "body", "(", "body", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "encode", "(", "Object", "object", ",", "Type", "bodyType", ",", "RequestTemplate", "template", ")", "throws", "EncodeException", "{", "template", ".", "body", "(", "String", ".", "valueOf", "(", "object", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Response", "execute", "(", "Request", "request", ",", "Request", ".", "Options", "options", ")", "throws", "IOException", "{", "return", "Response", ".", "builder", "(", ")", ".", "status", "(", "<NUM_LIT>", ")", ".", "request", "(", "request", ")", ".", "body", "(", "request", ".", "body", "(", ")", ")", ".", "build", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "alwaysEncodeBodyTrueTest", "(", ")", "{", "SampleTargetMultipleNonAnnotatedParameters", "sampleClient1", "=", "Feign", ".", "builder", "(", ")", ".", "contract", "(", "new", "SampleContract", "(", ")", ")", ".", "encoder", "(", "new", "AllParametersSampleEncoder", "(", ")", ")", ".", "client", "(", "new", "SampleClient", "(", ")", ")", ".", "target", "(", "SampleTargetMultipleNonAnnotatedParameters", ".", "class", ",", "\"", "<STR_LIT>", "\"", ")", ";", "Assert", ".", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "sampleClient1", ".", "concatenate", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "SampleTargetNoParameters", "sampleClient2", "=", "Feign", ".", "builder", "(", ")", ".", "contract", "(", "new", "SampleContract", "(", ")", ")", ".", "encoder", "(", "new", "AllParametersSampleEncoder", "(", ")", ")", ".", "client", "(", "new", "SampleClient", "(", ")", ")", ".", "target", "(", "SampleTargetNoParameters", ".", "class", ",", "\"", "<STR_LIT>", "\"", ")", ";", "Assert", ".", "assertEquals", "(", "\"", "\"", ",", "sampleClient2", ".", "concatenate", "(", ")", ")", ";", "SampleTargetOneParameter", "sampleClient3", "=", "Feign", ".", "builder", "(", ")", ".", "contract", "(", "new", "SampleContract", "(", ")", ")", ".", "encoder", "(", "new", "AllParametersSampleEncoder", "(", ")", ")", ".", "client", "(", "new", "SampleClient", "(", ")", ")", ".", "target", "(", "SampleTargetOneParameter", ".", "class", ",", "\"", "<STR_LIT>", "\"", ")", ";", "Assert", ".", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "sampleClient3", ".", "concatenate", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "String", "name", "(", "Throwable", "e", ")", "{", "if", "(", "e", "=", "=", "null", ")", "{", "return", "name", "(", ")", ";", "}", "return", "name", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "protected", "List", "<", "Tag", ">", "defaultTags", "(", ")", "{", "return", "Collections", ".", "emptyList", "(", ")", ";", "}", "</s>"]
["<s>", "protected", "void", "countResponseCode", "(", "Request", "request", ",", "Response", "response", ",", "Options", "options", ",", "int", "responseStatus", ",", "Exception", "e", ")", "{", "final", "Tag", "[", "]", "extraTags", "=", "extraTags", "(", "request", ",", "response", ",", "options", ",", "e", ")", ";", "final", "RequestTemplate", "template", "=", "request", ".", "requestTemplate", "(", ")", ";", "final", "Tags", "allTags", "=", "metricTagResolver", ".", "tag", "(", "template", ".", "methodMetadata", "(", ")", ",", "template", ".", "feignTarget", "(", ")", ",", "e", ",", "new", "Tag", "[", "]", "{", "Tag", ".", "of", "(", "\"", "<STR_LIT>", "\"", ",", "String", ".", "valueOf", "(", "responseStatus", ")", ")", ",", "Tag", ".", "of", "(", "\"", "<STR_LIT>", "\"", ",", "responseStatus", "/", "<NUM_LIT:100>", "+", "\"", "<STR_LIT>", "\"", ")", ",", "Tag", ".", "of", "(", "\"", "<STR_LIT>", "\"", ",", "template", ".", "path", "(", ")", ")", "}", ")", ".", "and", "(", "extraTags", ")", ";", "meterRegistry", ".", "counter", "(", "metricName", ".", "name", "(", "\"", "<STR_LIT>", "\"", ")", ",", "allTags", ")", ".", "increment", "(", ")", ";", "}", "</s>"]
["<s>", "protected", "Timer", "createTimer", "(", "Request", "request", ",", "Response", "response", ",", "Options", "options", ",", "Exception", "e", ")", "{", "final", "RequestTemplate", "template", "=", "request", ".", "requestTemplate", "(", ")", ";", "final", "Tags", "allTags", "=", "metricTagResolver", ".", "tag", "(", "template", ".", "methodMetadata", "(", ")", ",", "template", ".", "feignTarget", "(", ")", ",", "e", ",", "Tag", ".", "of", "(", "\"", "<STR_LIT>", "\"", ",", "template", ".", "path", "(", ")", ")", ")", ".", "and", "(", "extraTags", "(", "request", ",", "response", ",", "options", ",", "e", ")", ")", ";", "return", "meterRegistry", ".", "timer", "(", "metricName", ".", "name", "(", "e", ")", ",", "allTags", ")", ";", "}", "</s>"]
["<s>", "protected", "Tag", "[", "]", "extraTags", "(", "Request", "request", ",", "Response", "response", ",", "Options", "options", ",", "Exception", "e", ")", "{", "return", "EMPTY_TAGS_ARRAY", ";", "}", "</s>"]
["<s>", "protected", "Timer", "createTimer", "(", "Response", "response", ",", "Type", "type", ",", "Exception", "e", ")", "{", "final", "Tag", "[", "]", "extraTags", "=", "extraTags", "(", "response", ",", "type", ",", "e", ")", ";", "final", "RequestTemplate", "template", "=", "response", ".", "request", "(", ")", ".", "requestTemplate", "(", ")", ";", "final", "Tags", "allTags", "=", "metricTagResolver", ".", "tag", "(", "template", ".", "methodMetadata", "(", ")", ",", "template", ".", "feignTarget", "(", ")", ",", "e", ",", "extraTags", ")", ";", "return", "meterRegistry", ".", "timer", "(", "metricName", ".", "name", "(", "e", ")", ",", "allTags", ")", ";", "}", "</s>"]
["<s>", "protected", "Counter", "createExceptionCounter", "(", "Response", "response", ",", "Type", "type", ",", "Exception", "e", ")", "{", "final", "Tag", "[", "]", "extraTags", "=", "extraTags", "(", "response", ",", "type", ",", "e", ")", ";", "final", "RequestTemplate", "template", "=", "response", ".", "request", "(", ")", ".", "requestTemplate", "(", ")", ";", "final", "Tags", "allTags", "=", "metricTagResolver", ".", "tag", "(", "template", ".", "methodMetadata", "(", ")", ",", "template", ".", "feignTarget", "(", ")", ",", "Tag", ".", "of", "(", "\"", "<STR_LIT>", "\"", ",", "template", ".", "path", "(", ")", ")", ",", "Tag", ".", "of", "(", "\"", "<STR_LIT>", "\"", ",", "e", ".", "getClass", "(", ")", ".", "getSimpleName", "(", ")", ")", ")", ".", "and", "(", "extraTags", ")", ";", "return", "meterRegistry", ".", "counter", "(", "metricName", ".", "name", "(", "\"", "<STR_LIT>", "\"", ")", ",", "allTags", ")", ";", "}", "</s>"]
["<s>", "protected", "DistributionSummary", "createSummary", "(", "Response", "response", ",", "Type", "type", ")", "{", "final", "Tag", "[", "]", "tags", "=", "extraTags", "(", "response", ",", "type", ",", "null", ")", ";", "final", "RequestTemplate", "template", "=", "response", ".", "request", "(", ")", ".", "requestTemplate", "(", ")", ";", "final", "Tags", "allTags", "=", "metricTagResolver", ".", "tag", "(", "template", ".", "methodMetadata", "(", ")", ",", "template", ".", "feignTarget", "(", ")", ",", "tags", ")", ";", "return", "meterRegistry", ".", "summary", "(", "metricName", ".", "name", "(", "\"", "<STR_LIT>", "\"", ")", ",", "allTags", ")", ";", "}", "</s>"]
["<s>", "protected", "Tag", "[", "]", "extraTags", "(", "Response", "response", ",", "Type", "type", ",", "Exception", "e", ")", "{", "return", "EMPTY_TAGS_ARRAY", ";", "}", "</s>"]
["<s>", "protected", "Timer", "createTimer", "(", "Object", "object", ",", "Type", "bodyType", ",", "RequestTemplate", "template", ")", "{", "final", "Tags", "allTags", "=", "metricTagResolver", ".", "tag", "(", "template", ".", "methodMetadata", "(", ")", ",", "template", ".", "feignTarget", "(", ")", ",", "extraTags", "(", "object", ",", "bodyType", ",", "template", ")", ")", ";", "return", "meterRegistry", ".", "timer", "(", "metricName", ".", "name", "(", ")", ",", "allTags", ")", ";", "}", "</s>"]
["<s>", "protected", "DistributionSummary", "createSummary", "(", "Object", "object", ",", "Type", "bodyType", ",", "RequestTemplate", "template", ")", "{", "final", "Tags", "allTags", "=", "metricTagResolver", ".", "tag", "(", "template", ".", "methodMetadata", "(", ")", ",", "template", ".", "feignTarget", "(", ")", ",", "extraTags", "(", "object", ",", "bodyType", ",", "template", ")", ")", ";", "return", "meterRegistry", ".", "summary", "(", "metricName", ".", "name", "(", "\"", "<STR_LIT>", "\"", ")", ",", "allTags", ")", ";", "}", "</s>"]
["<s>", "protected", "Tag", "[", "]", "extraTags", "(", "Object", "object", ",", "Type", "bodyType", ",", "RequestTemplate", "template", ")", "{", "return", "EMPTY_TAGS_ARRAY", ";", "}", "</s>"]
["<s>", "protected", "Timer", "createTimer", "(", "Target", "target", ",", "Method", "method", ",", "Object", "[", "]", "args", ",", "Throwable", "e", ")", "{", "final", "Tag", "[", "]", "extraTags", "=", "extraTags", "(", "target", ",", "method", ",", "args", ",", "e", ")", ";", "final", "Tags", "allTags", "=", "metricTagResolver", ".", "tag", "(", "target", ".", "type", "(", ")", ",", "method", ",", "target", ".", "url", "(", ")", ",", "e", ",", "extraTags", ")", ";", "return", "meterRegistry", ".", "timer", "(", "metricName", ".", "name", "(", "e", ")", ",", "allTags", ")", ";", "}", "</s>"]
["<s>", "protected", "Counter", "createExceptionCounter", "(", "Target", "target", ",", "Method", "method", ",", "Object", "[", "]", "args", ",", "Throwable", "e", ")", "{", "final", "Tag", "[", "]", "extraTags", "=", "extraTags", "(", "target", ",", "method", ",", "args", ",", "e", ")", ";", "final", "Tags", "allTags", "=", "metricTagResolver", ".", "tag", "(", "target", ".", "type", "(", ")", ",", "method", ",", "target", ".", "url", "(", ")", ",", "e", ",", "extraTags", ")", ";", "return", "meterRegistry", ".", "counter", "(", "metricName", ".", "name", "(", "e", ")", ",", "allTags", ")", ";", "}", "</s>"]
["<s>", "protected", "Counter", "createFeignExceptionCounter", "(", "Target", "target", ",", "Method", "method", ",", "Object", "[", "]", "args", ",", "FeignException", "e", ")", "{", "final", "Tag", "[", "]", "extraTags", "=", "extraTags", "(", "target", ",", "method", ",", "args", ",", "e", ")", ";", "final", "Tags", "allTags", "=", "metricTagResolver", ".", "tag", "(", "target", ".", "type", "(", ")", ",", "method", ",", "target", ".", "url", "(", ")", ",", "e", ",", "extraTags", ")", ".", "and", "(", "Tag", ".", "of", "(", "\"", "<STR_LIT>", "\"", ",", "String", ".", "valueOf", "(", "e", ".", "status", "(", ")", ")", ")", ",", "Tag", ".", "of", "(", "\"", "<STR_LIT>", "\"", ",", "e", ".", "status", "(", ")", "/", "<NUM_LIT:100>", "+", "\"", "<STR_LIT>", "\"", ")", ")", ";", "return", "meterRegistry", ".", "counter", "(", "metricName", ".", "name", "(", "\"", "<STR_LIT>", "\"", ")", ",", "allTags", ")", ";", "}", "</s>"]
["<s>", "protected", "Tag", "[", "]", "extraTags", "(", "Target", "target", ",", "Method", "method", ",", "Object", "[", "]", "args", ",", "Throwable", "throwable", ")", "{", "return", "EMPTY_TAGS_ARRAY", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "shouldMetricCollectionWithCustomException", "(", ")", "{", "final", "SimpleSource", "source", "=", "Feign", ".", "builder", "(", ")", ".", "client", "(", "(", "request", ",", "options", ")", "-", ">", "{", "throw", "new", "RuntimeException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", ")", ".", "addCapability", "(", "createMetricCapability", "(", ")", ")", ".", "target", "(", "new", "MockTarget", "<", ">", "(", "MicrometerCapabilityTest", ".", "SimpleSource", ".", "class", ")", ")", ";", "RuntimeException", "thrown", "=", "assertThrows", "(", "RuntimeException", ".", "class", ",", "(", ")", "-", ">", "source", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertThat", "(", "thrown", ".", "getMessage", "(", ")", ",", "equalTo", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertThat", "(", "getMetric", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ",", "notNullValue", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "isClientMetric", "(", "String", "metricId", ")", "{", "return", "metricId", ".", "startsWith", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "isDecoderMetric", "(", "String", "metricId", ")", "{", "return", "metricId", ".", "startsWith", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "doesMetricIncludeUri", "(", "String", "metricId", ",", "String", "uri", ")", "{", "return", "metricId", ".", "contains", "(", "uri", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "isClientMetric", "(", "MetricName", "metricId", ")", "{", "return", "metricId", ".", "getKey", "(", ")", ".", "startsWith", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "isDecoderMetric", "(", "MetricName", "metricId", ")", "{", "return", "metricId", ".", "getKey", "(", ")", ".", "startsWith", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "doesMetricIncludeUri", "(", "MetricName", "metricId", ",", "String", "uri", ")", "{", "return", "uri", ".", "equals", "(", "metricId", ".", "getTags", "(", ")", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "clientMetricsHaveUriLabel", "(", ")", "{", "final", "SimpleSource", "source", "=", "Feign", ".", "builder", "(", ")", ".", "client", "(", "new", "MockClient", "(", ")", ".", "ok", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ".", "addCapability", "(", "createMetricCapability", "(", ")", ")", ".", "target", "(", "new", "MockTarget", "<", ">", "(", "SimpleSource", ".", "class", ")", ")", ";", "source", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ";", "final", "Map", "<", "METRIC_ID", ",", "METRIC", ">", "clientMetrics", "=", "getFeignMetrics", "(", ")", ".", "entrySet", "(", ")", ".", "stream", "(", ")", ".", "filter", "(", "entry", "-", ">", "isClientMetric", "(", "entry", ".", "getKey", "(", ")", ")", ")", ".", "collect", "(", "Collectors", ".", "toMap", "(", "Map", ".", "Entry", ":", ":", "getKey", ",", "Map", ".", "Entry", ":", ":", "getValue", ")", ")", ";", "clientMetrics", ".", "keySet", "(", ")", ".", "forEach", "(", "metricId", "-", ">", "assertThat", "(", "\"", "<STR_LIT>", "\"", "+", "metricId", ",", "doesMetricIncludeUri", "(", "metricId", ",", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "clientMetricsHaveUriLabelWithPathExpression", "(", ")", "{", "final", "SourceWithPathExpressions", "source", "=", "Feign", ".", "builder", "(", ")", ".", "client", "(", "new", "MockClient", "(", ")", ".", "ok", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ".", "addCapability", "(", "createMetricCapability", "(", ")", ")", ".", "target", "(", "new", "MockTarget", "<", ">", "(", "SourceWithPathExpressions", ".", "class", ")", ")", ";", "source", ".", "get", "(", "\"", "<STR_LIT:123>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "final", "Map", "<", "METRIC_ID", ",", "METRIC", ">", "clientMetrics", "=", "getFeignMetrics", "(", ")", ".", "entrySet", "(", ")", ".", "stream", "(", ")", ".", "filter", "(", "entry", "-", ">", "isClientMetric", "(", "entry", ".", "getKey", "(", ")", ")", ")", ".", "collect", "(", "Collectors", ".", "toMap", "(", "Map", ".", "Entry", ":", ":", "getKey", ",", "Map", ".", "Entry", ":", ":", "getValue", ")", ")", ";", "clientMetrics", ".", "keySet", "(", ")", ".", "forEach", "(", "metricId", "-", ">", "assertThat", "(", "\"", "<STR_LIT>", "\"", "+", "metricId", ",", "doesMetricIncludeUri", "(", "metricId", ",", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "decoderExceptionCounterHasUriLabelWithPathExpression", "(", ")", "{", "final", "AtomicReference", "<", "FeignException", ".", "NotFound", ">", "notFound", "=", "new", "AtomicReference", "<", ">", "(", ")", ";", "final", "SourceWithPathExpressions", "source", "=", "Feign", ".", "builder", "(", ")", ".", "client", "(", "new", "MockClient", "(", ")", ".", "ok", "(", "HttpMethod", ".", "GET", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ".", "decoder", "(", "(", "response", ",", "type", ")", "-", ">", "{", "notFound", ".", "set", "(", "new", "FeignException", ".", "NotFound", "(", "\"", "<STR_LIT>", "\"", ",", "response", ".", "request", "(", ")", ",", "null", ",", "null", ")", ")", ";", "throw", "notFound", ".", "get", "(", ")", ";", "}", ")", ".", "addCapability", "(", "createMetricCapability", "(", ")", ")", ".", "target", "(", "new", "MockTarget", "<", ">", "(", "MicrometerCapabilityTest", ".", "SourceWithPathExpressions", ".", "class", ")", ")", ";", "FeignException", ".", "NotFound", "thrown", "=", "assertThrows", "(", "FeignException", ".", "NotFound", ".", "class", ",", "(", ")", "-", ">", "source", ".", "get", "(", "\"", "<STR_LIT:123>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertSame", "(", "notFound", ".", "get", "(", ")", ",", "thrown", ")", ";", "final", "Map", "<", "METRIC_ID", ",", "METRIC", ">", "decoderMetrics", "=", "getFeignMetrics", "(", ")", ".", "entrySet", "(", ")", ".", "stream", "(", ")", ".", "filter", "(", "entry", "-", ">", "isDecoderMetric", "(", "entry", ".", "getKey", "(", ")", ")", ")", ".", "collect", "(", "Collectors", ".", "toMap", "(", "Map", ".", "Entry", ":", ":", "getKey", ",", "Map", ".", "Entry", ":", ":", "getValue", ")", ")", ";", "decoderMetrics", ".", "keySet", "(", ")", ".", "forEach", "(", "metricId", "-", ">", "assertThat", "(", "\"", "<STR_LIT>", "\"", "+", "metricId", ",", "doesMetricIncludeUri", "(", "metricId", ",", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "isClientMetric", "(", "Id", "metricId", ")", "{", "return", "metricId", ".", "getName", "(", ")", ".", "startsWith", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "isDecoderMetric", "(", "Id", "metricId", ")", "{", "return", "metricId", ".", "getName", "(", ")", ".", "startsWith", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "boolean", "doesMetricIncludeUri", "(", "Id", "metricId", ",", "String", "uri", ")", "{", "return", "uri", ".", "equals", "(", "metricId", ".", "getTag", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "</s>"]
["<s>", "protected", "SOAPMessage", "modifySOAPMessage", "(", "SOAPMessage", "soapMessage", ")", "throws", "SOAPException", "{", "return", "soapMessage", ";", "}", "</s>"]
["<s>", "public", "Request", "verifyOne", "(", "RequestKey", "requestKey", ")", "{", "return", "verifyTimes", "(", "requestKey", ",", "1", ")", ".", "get", "(", "0", ")", ";", "}", "</s>"]
["<s>", "public", "List", "<", "Request", ">", "verifyTimes", "(", "RequestKey", "requestKey", ",", "final", "int", "times", ")", "{", "if", "(", "times", "<", "0", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "if", "(", "times", "=", "=", "0", ")", "{", "verifyNever", "(", "requestKey", ")", ";", "return", "Collections", ".", "emptyList", "(", ")", ";", "}", "List", "<", "Request", ">", "result", "=", "null", ";", "for", "(", "Map", ".", "Entry", "<", "RequestKey", ",", "List", "<", "Request", ">", ">", "request", ":", "requests", ".", "entrySet", "(", ")", ")", "{", "if", "(", "request", ".", "getKey", "(", ")", ".", "equalsExtended", "(", "requestKey", ")", ")", "{", "result", "=", "request", ".", "getValue", "(", ")", ";", "}", "}", "if", "(", "result", "=", "=", "null", ")", "{", "throw", "new", "VerificationAssertionError", "(", "\"", "<STR_LIT>", "\"", ",", "requestKey", ",", "requests", ".", "keySet", "(", ")", ")", ";", "}", "if", "(", "result", ".", "size", "(", ")", "!", "=", "times", ")", "{", "throw", "new", "VerificationAssertionError", "(", "\"", "<STR_LIT>", "\"", ",", "requestKey", ",", "times", ",", "result", ".", "size", "(", ")", ")", ";", "}", "return", "result", ";", "}", "</s>"]
["<s>", "public", "void", "verifyNever", "(", "RequestKey", "requestKey", ")", "{", "for", "(", "RequestKey", "recorderRequestKey", ":", "requests", ".", "keySet", "(", ")", ")", "{", "if", "(", "recorderRequestKey", ".", "equalsExtended", "(", "requestKey", ")", ")", "{", "throw", "new", "VerificationAssertionError", "(", "\"", "<STR_LIT>", "\"", ",", "requestKey", ")", ";", "}", "}", "}", "</s>"]
["<s>", "@", "Override", "public", "CompletableFuture", "<", "Response", ">", "execute", "(", "Request", "request", ",", "Options", "options", ",", "Optional", "<", "Object", ">", "requestContext", ")", "{", "HttpRequest", "httpRequest", ";", "try", "{", "httpRequest", "=", "newRequestBuilder", "(", "request", ",", "options", ")", ".", "build", "(", ")", ";", "}", "catch", "(", "URISyntaxException", "e", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "<STR_LIT>", "\"", "+", "request", ".", "url", "(", ")", ",", "e", ")", ";", "}", "HttpClient", "clientForRequest", "=", "getOrCreateClient", "(", "options", ")", ";", "CompletableFuture", "<", "HttpResponse", "<", "byte", "[", "]", ">", ">", "future", "=", "clientForRequest", ".", "sendAsync", "(", "httpRequest", ",", "HttpResponse", ".", "BodyHandlers", ".", "ofByteArray", "(", ")", ")", ";", "return", "future", ".", "thenApply", "(", "httpResponse", "-", ">", "toFeignResponse", "(", "request", ",", "httpResponse", ")", ")", ";", "}", "</s>"]
["<s>", "protected", "Response", "toFeignResponse", "(", "Request", "request", ",", "HttpResponse", "<", "byte", "[", "]", ">", "httpResponse", ")", "{", "final", "OptionalLong", "length", "=", "httpResponse", ".", "headers", "(", ")", ".", "firstValueAsLong", "(", "\"", "<STR_LIT>", "\"", ")", ";", "return", "Response", ".", "builder", "(", ")", ".", "body", "(", "new", "ByteArrayInputStream", "(", "httpResponse", ".", "body", "(", ")", ")", ",", "length", ".", "isPresent", "(", ")", "?", "(", "int", ")", "length", ".", "getAsLong", "(", ")", ":", "null", ")", ".", "reason", "(", "httpResponse", ".", "headers", "(", ")", ".", "firstValue", "(", "\"", "<STR_LIT>", "\"", ")", ".", "orElse", "(", "\"", "<STR_LIT:OK>", "\"", ")", ")", ".", "request", "(", "request", ")", ".", "status", "(", "httpResponse", ".", "statusCode", "(", ")", ")", ".", "headers", "(", "castMapCollectType", "(", "httpResponse", ".", "headers", "(", ")", ".", "map", "(", ")", ")", ")", ".", "build", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "iterableQueryParams", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "api", ".", "queryParams", "(", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "postTemplateParamsResolve", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "api", ".", "login", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasBody", "(", "\"", "<STR_LIT:{>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:}>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "responseCoercesToStringBody", "(", ")", "throws", "Throwable", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "Response", "response", "=", "unwrap", "(", "api", ".", "response", "(", ")", ")", ";", "assertTrue", "(", "response", ".", "body", "(", ")", ".", "isRepeatable", "(", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "Util", ".", "toString", "(", "response", ".", "body", "(", ")", ".", "asReader", "(", "StandardCharsets", ".", "UTF_8", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "postFormParams", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "form", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasBody", "(", "\"", "<STR_LIT:{>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:U+002C>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT::>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:}>", "\"", ")", ";", "checkCFCompletedSoon", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "postBodyParam", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "body", "(", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasHeaders", "(", "entry", "(", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ".", "hasBody", "(", "\"", "<STR_LIT>", "\"", ")", ";", "checkCFCompletedSoon", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "bodyTypeCorrespondsWithParameterType", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "final", "AtomicReference", "<", "Type", ">", "encodedType", "=", "new", "AtomicReference", "<", "Type", ">", "(", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "encoder", "(", "new", "Encoder", ".", "Default", "(", ")", "{", "@", "Override", "public", "void", "encode", "(", "Object", "object", ",", "Type", "bodyType", ",", "RequestTemplate", "template", ")", "{", "encodedType", ".", "set", "(", "bodyType", ")", ";", "}", "}", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "body", "(", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "server", ".", "takeRequest", "(", ")", ";", "Assertions", ".", "assertThat", "(", "encodedType", ".", "get", "(", ")", ")", ".", "isEqualTo", "(", "new", "TypeToken", "<", "List", "<", "String", ">", ">", "(", ")", "{", "}", ".", "getType", "(", ")", ")", ";", "checkCFCompletedSoon", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "singleInterceptor", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "requestInterceptor", "(", "new", "ForwardedForInterceptor", "(", ")", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "post", "(", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasHeaders", "(", "entry", "(", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "checkCFCompletedSoon", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "multipleInterceptor", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "requestInterceptor", "(", "new", "ForwardedForInterceptor", "(", ")", ")", ".", "requestInterceptor", "(", "new", "UserAgentInterceptor", "(", ")", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "post", "(", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasHeaders", "(", "entry", "(", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ",", "entry", "(", "\"", "<STR_LIT>", "\"", ",", "Collections", ".", "singletonList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "checkCFCompletedSoon", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "customExpander", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "expand", "(", "new", "Date", "(", "<NUM_LIT>", ")", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "checkCFCompletedSoon", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "customExpanderListParam", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "expandList", "(", "Arrays", ".", "asList", "(", "new", "Date", "(", "<NUM_LIT>", ")", ",", "new", "Date", "(", "<NUM_LIT>", ")", ")", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "checkCFCompletedSoon", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "customExpanderNullParam", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "expandList", "(", "Arrays", ".", "asList", "(", "new", "Date", "(", "<NUM_LIT>", ")", ",", "null", ")", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "checkCFCompletedSoon", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "headerMap", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "Map", "<", "String", ",", "Object", ">", "headerMap", "=", "new", "LinkedHashMap", "<", "String", ",", "Object", ">", "(", ")", ";", "headerMap", ".", "put", "(", "\"", "<STR_LIT:Content-Type>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "headerMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "headerMap", "(", "headerMap", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasHeaders", "(", "entry", "(", "\"", "<STR_LIT:Content-Type>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ",", "entry", "(", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "checkCFCompletedSoon", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "headerMapWithHeaderAnnotations", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "Map", "<", "String", ",", "Object", ">", "headerMap", "=", "new", "LinkedHashMap", "<", "String", ",", "Object", ">", "(", ")", ";", "headerMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "api", ".", "headerMapWithHeaderAnnotations", "(", "headerMap", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasHeaders", "(", "entry", "(", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ",", "entry", "(", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "headerMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "headerMapWithHeaderAnnotations", "(", "headerMap", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasHeaders", "(", "entry", "(", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ",", "entry", "(", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "checkCFCompletedSoon", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "queryMap", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "Map", "<", "String", ",", "Object", ">", "queryMap", "=", "new", "LinkedHashMap", "<", "String", ",", "Object", ">", "(", ")", ";", "queryMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "queryMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "queryMap", "(", "queryMap", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "checkCFCompletedSoon", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "queryMapIterableValuesExpanded", "(", ")", "throws", "Exception", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "Map", "<", "String", ",", "Object", ">", "queryMap", "=", "new", "LinkedHashMap", "<", "String", ",", "Object", ">", "(", ")", ";", "queryMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "queryMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "queryMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "new", "ArrayList", "<", "String", ">", "(", ")", ")", ";", "queryMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "\"", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "queryMap", "(", "queryMap", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "checkCFCompletedSoon", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "queryMapWithQueryParams", "(", ")", "throws", "Exception", "{", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "Map", "<", "String", ",", "Object", ">", "queryMap", "=", "new", "LinkedHashMap", "<", "String", ",", "Object", ">", "(", ")", ";", "queryMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "api", ".", "queryMapWithQueryParams", "(", "\"", "<STR_LIT>", "\"", ",", "queryMap", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "queryMap", "=", "new", "LinkedHashMap", "<", "String", ",", "Object", ">", "(", ")", ";", "queryMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "api", ".", "queryMapWithQueryParams", "(", "\"", "<STR_LIT>", "\"", ",", "queryMap", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "queryMap", "=", "new", "LinkedHashMap", "<", "String", ",", "Object", ">", "(", ")", ";", "queryMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "null", ")", ";", "api", ".", "queryMapWithQueryParams", "(", "\"", "<STR_LIT>", "\"", ",", "queryMap", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "queryMapValueStartingWithBrace", "(", ")", "throws", "Exception", "{", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "Map", "<", "String", ",", "Object", ">", "queryMap", "=", "new", "LinkedHashMap", "<", "String", ",", "Object", ">", "(", ")", ";", "queryMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "api", ".", "queryMap", "(", "queryMap", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "queryMap", "=", "new", "LinkedHashMap", "<", "String", ",", "Object", ">", "(", ")", ";", "queryMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "api", ".", "queryMap", "(", "queryMap", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "queryMap", "=", "new", "LinkedHashMap", "<", "String", ",", "Object", ">", "(", ")", ";", "queryMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "api", ".", "queryMapEncoded", "(", "queryMap", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "queryMap", "=", "new", "LinkedHashMap", "<", "String", ",", "Object", ">", "(", ")", ";", "queryMap", ".", "put", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "api", ".", "queryMapEncoded", "(", "queryMap", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "queryMapPojoWithFullParams", "(", ")", "throws", "Exception", "{", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "CustomPojo", "customPojo", "=", "new", "CustomPojo", "(", "\"", "<STR_LIT:Name>", "\"", ",", "<NUM_LIT:3>", ")", ";", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "queryMapPojo", "(", "customPojo", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasQueryParams", "(", "Arrays", ".", "asList", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "checkCFCompletedSoon", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "queryMapPojoWithPartialParams", "(", ")", "throws", "Exception", "{", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "CustomPojo", "customPojo", "=", "new", "CustomPojo", "(", "\"", "<STR_LIT:Name>", "\"", ",", "null", ")", ";", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "queryMapPojo", "(", "customPojo", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT>", "\"", ")", ";", "checkCFCompletedSoon", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "queryMapPojoWithEmptyParams", "(", ")", "throws", "Exception", "{", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "CustomPojo", "customPojo", "=", "new", "CustomPojo", "(", "null", ",", "null", ")", ";", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ")", ";", "api", ".", "queryMapPojo", "(", "customPojo", ")", ";", "assertThat", "(", "server", ".", "takeRequest", "(", ")", ")", ".", "hasPath", "(", "\"", "<STR_LIT:/>", "\"", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "canOverrideErrorDecoder", "(", ")", "throws", "Throwable", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setResponseCode", "(", "<NUM_LIT>", ")", ".", "setBody", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "thrown", ".", "expect", "(", "IllegalArgumentException", ".", "class", ")", ";", "thrown", ".", "expectMessage", "(", "\"", "<STR_LIT>", "\"", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "errorDecoder", "(", "new", "IllegalArgumentExceptionOn400", "(", ")", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "unwrap", "(", "api", ".", "post", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "overrideTypeSpecificDecoder", "(", ")", "throws", "Throwable", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT:!>", "\"", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "decoder", "(", "(", "response", ",", "type", ")", "-", ">", "\"", "<STR_LIT>", "\"", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "unwrap", "(", "api", ".", "post", "(", ")", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "doesntRetryAfterResponseIsSent", "(", ")", "throws", "Throwable", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT:!>", "\"", ")", ")", ";", "thrown", ".", "expect", "(", "FeignException", ".", "class", ")", ";", "thrown", ".", "expectMessage", "(", "\"", "<STR_LIT>", "\"", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "decoder", "(", "(", "response", ",", "type", ")", "-", ">", "{", "throw", "new", "IOException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "post", "(", ")", ";", "server", ".", "takeRequest", "(", ")", ";", "unwrap", "(", "cf", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "throwsFeignExceptionIncludingBody", "(", ")", "throws", "Throwable", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT:!>", "\"", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "decoder", "(", "(", "response", ",", "type", ")", "-", ">", "{", "throw", "new", "IOException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "final", "CompletableFuture", "<", "?", ">", "cf", "=", "api", ".", "body", "(", "\"", "<STR_LIT>", "\"", ")", ";", "server", ".", "takeRequest", "(", ")", ";", "try", "{", "unwrap", "(", "cf", ")", ";", "}", "catch", "(", "final", "FeignException", "e", ")", "{", "Assertions", ".", "assertThat", "(", "e", ".", "getMessage", "(", ")", ")", ".", "isEqualTo", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", "+", "\"", "<STR_LIT:/>", "\"", ")", ";", "Assertions", ".", "assertThat", "(", "e", ".", "contentUTF8", "(", ")", ")", ".", "isEqualTo", "(", "\"", "<STR_LIT>", "\"", ")", ";", "return", ";", "}", "fail", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "throwsFeignExceptionWithoutBody", "(", ")", "{", "server", ".", "enqueue", "(", "new", "MockResponse", "(", ")", ".", "setBody", "(", "\"", "<STR_LIT:!>", "\"", ")", ")", ";", "final", "TestInterfaceAsync", "api", "=", "newAsyncBuilder", "(", ")", ".", "decoder", "(", "(", "response", ",", "type", ")", "-", ">", "{", "throw", "new", "IOException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", ")", ".", "target", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", ")", ";", "try", "{", "api", ".", "noContent", "(", ")", ";", "}", "catch", "(", "final", "FeignException", "e", ")", "{", "Assertions", ".", "assertThat", "(", "e", ".", "getMessage", "(", ")", ")", ".", "isEqualTo", "(", "\"", "<STR_LIT>", "\"", "+", "server", ".", "getPort", "(", ")", "+", "\"", "<STR_LIT:/>", "\"", ")", ";", "Assertions", ".", "assertThat", "(", "e", ".", "contentUTF8", "(", ")", ")", ".", "isEqualTo", "(", "\"", "\"", ")", ";", "}", "}", "</s>"]
