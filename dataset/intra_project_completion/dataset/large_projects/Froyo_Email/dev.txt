["<s>", "@", "Override", "protected", "void", "setUp", "(", ")", "throws", "Exception", "{", "super", ".", "setUp", "(", ")", ";", "mContext", "=", "getInstrumentation", "(", ")", ".", "getTargetContext", "(", ")", ";", "Email", ".", "setServicesEnabled", "(", "mContext", ")", ";", "Intent", "i", "=", "new", "Intent", "(", ")", ".", "putExtra", "(", "EXTRA_ACCOUNT_ID", ",", "Long", ".", "MIN_VALUE", ")", ".", "putExtra", "(", "EXTRA_MAILBOX_TYPE", ",", "Long", ".", "MIN_VALUE", ")", ".", "putExtra", "(", "EXTRA_MAILBOX_ID", ",", "Long", ".", "MIN_VALUE", ")", ";", "this", ".", "setActivityIntent", "(", "i", ")", ";", "mMessageList", "=", "getActivity", "(", ")", ";", "}", "</s>"]
["<s>", "private", "void", "addElement", "(", "long", "id", ",", "long", "mailboxKey", ",", "long", "accountKey", ",", "String", "displayName", ",", "String", "subject", ",", "long", "timestamp", ",", "int", "flagRead", ",", "int", "flagFavorite", ",", "int", "flagAttachment", ")", "{", "HashMap", "<", "String", ",", "Object", ">", "emap", "=", "new", "HashMap", "<", "String", ",", "Object", ">", "(", ")", ";", "emap", ".", "put", "(", "EmailContent", ".", "RECORD_ID", ",", "id", ")", ";", "emap", ".", "put", "(", "MessageColumns", ".", "MAILBOX_KEY", ",", "mailboxKey", ")", ";", "emap", ".", "put", "(", "MessageColumns", ".", "ACCOUNT_KEY", ",", "accountKey", ")", ";", "emap", ".", "put", "(", "MessageColumns", ".", "DISPLAY_NAME", ",", "displayName", ")", ";", "emap", ".", "put", "(", "MessageColumns", ".", "SUBJECT", ",", "subject", ")", ";", "emap", ".", "put", "(", "MessageColumns", ".", "TIMESTAMP", ",", "timestamp", ")", ";", "emap", ".", "put", "(", "MessageColumns", ".", "FLAG_READ", ",", "flagRead", ")", ";", "emap", ".", "put", "(", "MessageColumns", ".", "FLAG_FAVORITE", ",", "flagFavorite", ")", ";", "emap", ".", "put", "(", "MessageColumns", ".", "FLAG_ATTACHMENT", ",", "flagAttachment", ")", ";", "mRowsMap", ".", "put", "(", "id", ",", "emap", ")", ";", "mIDarray", ".", "add", "(", "id", ")", ";", "}", "</s>"]
["<s>", "private", "void", "setUpCustomCursor", "(", ")", "throws", "Throwable", "{", "runTestOnUiThread", "(", "new", "Runnable", "(", ")", "{", "public", "void", "run", "(", ")", "{", "mListAdapter", "=", "(", "CursorAdapter", ")", "mMessageList", ".", "getListAdapter", "(", ")", ";", "mRowsMap", "=", "new", "HashMap", "<", "Long", ",", "Map", "<", "String", ",", "Object", ">", ">", "(", "0", ")", ";", "mIDarray", "=", "new", "ArrayList", "<", "Long", ">", "(", "0", ")", ";", "addElement", "(", "0", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:A>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "1", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:B>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:2>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:C>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:3>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:D>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:4>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:E>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:5>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:F>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:6>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:7>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:8>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:I>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:9>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "CustomCursor", "cc", "=", "new", "CustomCursor", "(", "mIDarray", ",", "PROJECTION", ",", "mRowsMap", ")", ";", "mListAdapter", ".", "changeCursor", "(", "cc", ")", ";", "}", "}", ")", ";", "}", "</s>"]
["<s>", "public", "void", "run", "(", ")", "{", "mListAdapter", "=", "(", "CursorAdapter", ")", "mMessageList", ".", "getListAdapter", "(", ")", ";", "mRowsMap", "=", "new", "HashMap", "<", "Long", ",", "Map", "<", "String", ",", "Object", ">", ">", "(", "0", ")", ";", "mIDarray", "=", "new", "ArrayList", "<", "Long", ">", "(", "0", ")", ";", "addElement", "(", "0", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:A>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "1", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:B>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:2>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:C>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:3>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:D>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:4>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:E>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:5>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:F>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:6>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:7>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:8>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:I>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "addElement", "(", "<NUM_LIT:9>", ",", "Long", ".", "MIN_VALUE", ",", "Long", ".", "MIN_VALUE", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "CustomCursor", "cc", "=", "new", "CustomCursor", "(", "mIDarray", ",", "PROJECTION", ",", "mRowsMap", ")", ";", "mListAdapter", ".", "changeCursor", "(", "cc", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testRestoreAndSaveInstanceState", "(", ")", "throws", "Throwable", "{", "setUpCustomCursor", "(", ")", ";", "Bundle", "bundle", "=", "new", "Bundle", "(", ")", ";", "mMessageList", ".", "onSaveInstanceState", "(", "bundle", ")", ";", "long", "[", "]", "checkedarray", "=", "bundle", ".", "getLongArray", "(", "STATE_CHECKED_ITEMS", ")", ";", "assertEquals", "(", "0", ",", "checkedarray", ".", "length", ")", ";", "Set", "<", "Long", ">", "checkedset", "=", "(", "(", "MessageList", ".", "MessageListAdapter", ")", "mListAdapter", ")", ".", "getSelectedSet", "(", ")", ";", "checkedset", ".", "add", "(", "<NUM_LIT>", ")", ";", "checkedset", ".", "add", "(", "<NUM_LIT>", ")", ";", "checkedset", ".", "add", "(", "<NUM_LIT>", ")", ";", "mMessageList", ".", "onSaveInstanceState", "(", "bundle", ")", ";", "checkedarray", "=", "bundle", ".", "getLongArray", "(", "STATE_CHECKED_ITEMS", ")", ";", "java", ".", "util", ".", "Arrays", ".", "sort", "(", "checkedarray", ")", ";", "assertEquals", "(", "<NUM_LIT:3>", ",", "checkedarray", ".", "length", ")", ";", "assertEquals", "(", "1", ",", "checkedarray", "[", "0", "]", ")", ";", "assertEquals", "(", "<NUM_LIT:3>", ",", "checkedarray", "[", "1", "]", ")", ";", "assertEquals", "(", "<NUM_LIT:5>", ",", "checkedarray", "[", "<NUM_LIT:2>", "]", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testRestoreInstanceState", "(", ")", "throws", "Throwable", "{", "setUpCustomCursor", "(", ")", ";", "Bundle", "bundle", "=", "new", "Bundle", "(", ")", ";", "long", "[", "]", "checkedarray", "=", "new", "long", "[", "<NUM_LIT:3>", "]", ";", "checkedarray", "[", "0", "]", "=", "1", ";", "checkedarray", "[", "1", "]", "=", "<NUM_LIT:3>", ";", "checkedarray", "[", "<NUM_LIT:2>", "]", "=", "<NUM_LIT:5>", ";", "Set", "<", "Long", ">", "checkedset", "=", "(", "(", "MessageList", ".", "MessageListAdapter", ")", "mListAdapter", ")", ".", "getSelectedSet", "(", ")", ";", "assertEquals", "(", "0", ",", "checkedset", ".", "size", "(", ")", ")", ";", "bundle", ".", "putLongArray", "(", "STATE_CHECKED_ITEMS", ",", "checkedarray", ")", ";", "mMessageList", ".", "onRestoreInstanceState", "(", "bundle", ")", ";", "checkedset", "=", "(", "(", "MessageList", ".", "MessageListAdapter", ")", "mListAdapter", ")", ".", "getSelectedSet", "(", ")", ";", "assertEquals", "(", "<NUM_LIT:3>", ",", "checkedset", ".", "size", "(", ")", ")", ";", "assertTrue", "(", "checkedset", ".", "contains", "(", "<NUM_LIT>", ")", ")", ";", "assertTrue", "(", "checkedset", ".", "contains", "(", "<NUM_LIT>", ")", ")", ";", "assertTrue", "(", "checkedset", ".", "contains", "(", "<NUM_LIT>", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "close", "(", ")", "{", "super", ".", "close", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "String", "[", "]", "getColumnNames", "(", ")", "{", "return", "mColumnNames", ";", "}", "</s>"]
["<s>", "private", "Object", "getObject", "(", "int", "columnIndex", ")", "{", "if", "(", "isClosed", "(", ")", ")", "{", "throw", "new", "SQLException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "int", "size", "=", "mSortedIdList", ".", "size", "(", ")", ";", "if", "(", "mPos", "<", "0", "|", "|", "mPos", ">", "=", "size", ")", "{", "throw", "new", "CursorIndexOutOfBoundsException", "(", "mPos", ",", "size", ")", ";", "}", "if", "(", "columnIndex", "<", "0", "|", "|", "columnIndex", ">", "=", "getColumnCount", "(", ")", ")", "{", "return", "null", ";", "}", "return", "mUpdatedRows", ".", "get", "(", "mSortedIdList", ".", "get", "(", "mPos", ")", ")", ".", "get", "(", "mColumnNames", "[", "columnIndex", "]", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "float", "getFloat", "(", "int", "columnIndex", ")", "{", "return", "Float", ".", "valueOf", "(", "getObject", "(", "columnIndex", ")", ".", "toString", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "double", "getDouble", "(", "int", "columnIndex", ")", "{", "return", "Double", ".", "valueOf", "(", "getObject", "(", "columnIndex", ")", ".", "toString", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "int", "getInt", "(", "int", "columnIndex", ")", "{", "return", "Integer", ".", "valueOf", "(", "getObject", "(", "columnIndex", ")", ".", "toString", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "long", "getLong", "(", "int", "columnIndex", ")", "{", "return", "Long", ".", "valueOf", "(", "getObject", "(", "columnIndex", ")", ".", "toString", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "short", "getShort", "(", "int", "columnIndex", ")", "{", "return", "Short", ".", "valueOf", "(", "getObject", "(", "columnIndex", ")", ".", "toString", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "String", "getString", "(", "int", "columnIndex", ")", "{", "return", "String", ".", "valueOf", "(", "getObject", "(", "columnIndex", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "boolean", "isNull", "(", "int", "columnIndex", ")", "{", "return", "getObject", "(", "columnIndex", ")", "=", "=", "null", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "int", "getCount", "(", ")", "{", "return", "mSortedIdList", ".", "size", "(", ")", ";", "}", "</s>"]
["<s>", "public", "void", "checkDatabases", "(", ")", "{", "if", "(", "mDatabase", "!", "=", "null", ")", "{", "mDatabase", "=", "null", ";", "}", "if", "(", "mBodyDatabase", "!", "=", "null", ")", "{", "mBodyDatabase", "=", "null", ";", "}", "File", "databaseFile", "=", "getContext", "(", ")", ".", "getDatabasePath", "(", "DATABASE_NAME", ")", ";", "File", "bodyFile", "=", "getContext", "(", ")", ".", "getDatabasePath", "(", "BODY_DATABASE_NAME", ")", ";", "if", "(", "databaseFile", ".", "exists", "(", ")", "&", "&", "!", "bodyFile", ".", "exists", "(", ")", ")", "{", "Log", ".", "w", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", ")", ";", "databaseFile", ".", "delete", "(", ")", ";", "}", "else", "if", "(", "bodyFile", ".", "exists", "(", ")", "&", "&", "!", "databaseFile", ".", "exists", "(", ")", ")", "{", "Log", ".", "w", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", ")", ";", "bodyFile", ".", "delete", "(", ")", ";", "}", "}", "</s>"]
["<s>", "public", "void", "testDatabaseCorruptionRecovery", "(", ")", "{", "final", "ContentResolver", "resolver", "=", "mMockContext", ".", "getContentResolver", "(", ")", ";", "final", "Context", "context", "=", "mMockContext", ";", "Account", "acct", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT:1>", "\"", ",", "true", ",", "context", ")", ";", "Mailbox", "box1", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT:1>", "\"", ",", "acct", ".", "mId", ",", "true", ",", "context", ")", ";", "ProviderTestUtils", ".", "setupMessage", "(", "\"", "<STR_LIT:1>", "\"", ",", "acct", ".", "mId", ",", "box1", ".", "mId", ",", "true", ",", "true", ",", "context", ")", ";", "ProviderTestUtils", ".", "setupMessage", "(", "\"", "<STR_LIT:2>", "\"", ",", "acct", ".", "mId", ",", "box1", ".", "mId", ",", "true", ",", "true", ",", "context", ")", ";", "ProviderTestUtils", ".", "setupMessage", "(", "\"", "<STR_LIT:3>", "\"", ",", "acct", ".", "mId", ",", "box1", ".", "mId", ",", "true", ",", "true", ",", "context", ")", ";", "ProviderTestUtils", ".", "setupMessage", "(", "\"", "<STR_LIT:4>", "\"", ",", "acct", ".", "mId", ",", "box1", ".", "mId", ",", "true", ",", "true", ",", "context", ")", ";", "int", "count", "=", "EmailContent", ".", "count", "(", "mMockContext", ",", "Message", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ";", "assertEquals", "(", "<NUM_LIT:4>", ",", "count", ")", ";", "count", "=", "EmailContent", ".", "count", "(", "mMockContext", ",", "Body", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ";", "assertEquals", "(", "<NUM_LIT:4>", ",", "count", ")", ";", "File", "dbFile", "=", "mMockContext", ".", "getDatabasePath", "(", "EmailProvider", ".", "DATABASE_NAME", ")", ";", "assertTrue", "(", "dbFile", "!", "=", "null", ")", ";", "assertTrue", "(", "dbFile", ".", "exists", "(", ")", ")", ";", "assertTrue", "(", "dbFile", ".", "delete", "(", ")", ")", ";", "assertFalse", "(", "dbFile", ".", "exists", "(", ")", ")", ";", "dbFile", "=", "mMockContext", ".", "getDatabasePath", "(", "EmailProvider", ".", "BODY_DATABASE_NAME", ")", ";", "assertTrue", "(", "dbFile", "!", "=", "null", ")", ";", "assertTrue", "(", "dbFile", ".", "exists", "(", ")", ")", ";", "resolver", ".", "update", "(", "EmailProvider", ".", "INTEGRITY_CHECK_URI", ",", "null", ",", "null", ",", "null", ")", ";", "count", "=", "EmailContent", ".", "count", "(", "mMockContext", ",", "Body", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ";", "assertEquals", "(", "0", ",", "count", ")", ";", "count", "=", "EmailContent", ".", "count", "(", "mMockContext", ",", "Message", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ";", "assertEquals", "(", "0", ",", "count", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testBodyDatabaseCorruptionRecovery", "(", ")", "{", "final", "ContentResolver", "resolver", "=", "mMockContext", ".", "getContentResolver", "(", ")", ";", "final", "Context", "context", "=", "mMockContext", ";", "Account", "acct", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT:1>", "\"", ",", "true", ",", "context", ")", ";", "Mailbox", "box1", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT:1>", "\"", ",", "acct", ".", "mId", ",", "true", ",", "context", ")", ";", "ProviderTestUtils", ".", "setupMessage", "(", "\"", "<STR_LIT:1>", "\"", ",", "acct", ".", "mId", ",", "box1", ".", "mId", ",", "true", ",", "true", ",", "context", ")", ";", "ProviderTestUtils", ".", "setupMessage", "(", "\"", "<STR_LIT:2>", "\"", ",", "acct", ".", "mId", ",", "box1", ".", "mId", ",", "true", ",", "true", ",", "context", ")", ";", "ProviderTestUtils", ".", "setupMessage", "(", "\"", "<STR_LIT:3>", "\"", ",", "acct", ".", "mId", ",", "box1", ".", "mId", ",", "true", ",", "true", ",", "context", ")", ";", "ProviderTestUtils", ".", "setupMessage", "(", "\"", "<STR_LIT:4>", "\"", ",", "acct", ".", "mId", ",", "box1", ".", "mId", ",", "true", ",", "true", ",", "context", ")", ";", "int", "count", "=", "EmailContent", ".", "count", "(", "mMockContext", ",", "Message", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ";", "assertEquals", "(", "<NUM_LIT:4>", ",", "count", ")", ";", "count", "=", "EmailContent", ".", "count", "(", "mMockContext", ",", "Body", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ";", "assertEquals", "(", "<NUM_LIT:4>", ",", "count", ")", ";", "File", "dbFile", "=", "mMockContext", ".", "getDatabasePath", "(", "EmailProvider", ".", "BODY_DATABASE_NAME", ")", ";", "assertTrue", "(", "dbFile", "!", "=", "null", ")", ";", "assertTrue", "(", "dbFile", ".", "exists", "(", ")", ")", ";", "assertTrue", "(", "dbFile", ".", "delete", "(", ")", ")", ";", "assertFalse", "(", "dbFile", ".", "exists", "(", ")", ")", ";", "dbFile", "=", "mMockContext", ".", "getDatabasePath", "(", "EmailProvider", ".", "DATABASE_NAME", ")", ";", "assertTrue", "(", "dbFile", "!", "=", "null", ")", ";", "assertTrue", "(", "dbFile", ".", "exists", "(", ")", ")", ";", "resolver", ".", "update", "(", "EmailProvider", ".", "INTEGRITY_CHECK_URI", ",", "null", ",", "null", ",", "null", ")", ";", "count", "=", "EmailContent", ".", "count", "(", "mMockContext", ",", "Message", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ";", "assertEquals", "(", "0", ",", "count", ")", ";", "count", "=", "EmailContent", ".", "count", "(", "mMockContext", ",", "Body", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ";", "assertEquals", "(", "0", ",", "count", ")", ";", "}", "</s>"]
["<s>", "private", "boolean", "messageReferenced", "(", "ContentResolver", "cr", ",", "long", "id", ")", "{", "mBindArgument", "[", "0", "]", "=", "Long", ".", "toString", "(", "id", ")", ";", "Cursor", "c", "=", "cr", ".", "query", "(", "Body", ".", "CONTENT_URI", ",", "Body", ".", "ID_PROJECTION", ",", "WHERE_BODY_SOURCE_MESSAGE_KEY", ",", "mBindArgument", ",", "null", ")", ";", "try", "{", "return", "c", ".", "moveToFirst", "(", ")", ";", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "}", "</s>"]
["<s>", "boolean", "sendDeletedItems", "(", "Serializer", "s", ",", "ArrayList", "<", "Long", ">", "deletedIds", ",", "boolean", "first", ")", "throws", "IOException", "{", "ContentResolver", "cr", "=", "mContext", ".", "getContentResolver", "(", ")", ";", "Cursor", "c", "=", "cr", ".", "query", "(", "Message", ".", "DELETED_CONTENT_URI", ",", "Message", ".", "LIST_PROJECTION", ",", "MessageColumns", ".", "MAILBOX_KEY", "+", "<CHAR_LIT:=>", "+", "mMailbox", ".", "mId", ",", "null", ",", "null", ")", ";", "deletedIds", ".", "clear", "(", ")", ";", "try", "{", "while", "(", "c", ".", "moveToNext", "(", ")", ")", "{", "String", "serverId", "=", "c", ".", "getString", "(", "Message", ".", "LIST_SERVER_ID_COLUMN", ")", ";", "if", "(", "serverId", "=", "=", "null", ")", "{", "continue", ";", "}", "else", "if", "(", "messageReferenced", "(", "cr", ",", "c", ".", "getLong", "(", "Message", ".", "CONTENT_ID_COLUMN", ")", ")", ")", "{", "userLog", "(", "\"", "<STR_LIT>", "\"", ",", "serverId", ")", ";", "continue", ";", "}", "else", "if", "(", "first", ")", "{", "s", ".", "start", "(", "Tags", ".", "SYNC_COMMANDS", ")", ";", "first", "=", "false", ";", "}", "s", ".", "start", "(", "Tags", ".", "SYNC_DELETE", ")", ".", "data", "(", "Tags", ".", "SYNC_SERVER_ID", ",", "serverId", ")", ".", "end", "(", ")", ";", "deletedIds", ".", "add", "(", "c", ".", "getLong", "(", "Message", ".", "LIST_ID_COLUMN", ")", ")", ";", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "return", "first", ";", "}", "</s>"]
["<s>", "public", "void", "testSendDeletedItems", "(", ")", "throws", "IOException", "{", "EasSyncService", "service", "=", "getTestService", "(", ")", ";", "EmailSyncAdapter", "adapter", "=", "new", "EmailSyncAdapter", "(", "service", ".", "mMailbox", ",", "service", ")", ";", "Serializer", "s", "=", "new", "Serializer", "(", ")", ";", "ArrayList", "<", "Long", ">", "ids", "=", "new", "ArrayList", "<", "Long", ">", "(", ")", ";", "ArrayList", "<", "Long", ">", "deletedIds", "=", "new", "ArrayList", "<", "Long", ">", "(", ")", ";", "Context", "context", "=", "mMockContext", ";", "adapter", ".", "mContext", "=", "context", ";", "final", "ContentResolver", "resolver", "=", "context", ".", "getContentResolver", "(", ")", ";", "Account", "acct", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "true", ",", "context", ")", ";", "adapter", ".", "mAccount", "=", "acct", ";", "Mailbox", "box1", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT:1>", "\"", ",", "acct", ".", "mId", ",", "true", ",", "context", ")", ";", "adapter", ".", "mMailbox", "=", "box1", ";", "Message", "msg1", "=", "ProviderTestUtils", ".", "setupMessage", "(", "\"", "<STR_LIT:1>", "\"", ",", "acct", ".", "mId", ",", "box1", ".", "mId", ",", "true", ",", "true", ",", "context", ")", ";", "ids", ".", "add", "(", "msg1", ".", "mId", ")", ";", "Message", "msg2", "=", "ProviderTestUtils", ".", "setupMessage", "(", "\"", "<STR_LIT:2>", "\"", ",", "acct", ".", "mId", ",", "box1", ".", "mId", ",", "true", ",", "true", ",", "context", ")", ";", "ids", ".", "add", "(", "msg2", ".", "mId", ")", ";", "Message", "msg3", "=", "ProviderTestUtils", ".", "setupMessage", "(", "\"", "<STR_LIT:3>", "\"", ",", "acct", ".", "mId", ",", "box1", ".", "mId", ",", "true", ",", "true", ",", "context", ")", ";", "ids", ".", "add", "(", "msg3", ".", "mId", ")", ";", "assertEquals", "(", "<NUM_LIT:3>", ",", "EmailContent", ".", "count", "(", "context", ",", "Message", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ")", ";", "for", "(", "long", "id", ":", "ids", ")", "{", "resolver", ".", "delete", "(", "ContentUris", ".", "withAppendedId", "(", "Message", ".", "SYNCED_CONTENT_URI", ",", "id", ")", ",", "null", ",", "null", ")", ";", "}", "assertEquals", "(", "0", ",", "EmailContent", ".", "count", "(", "context", ",", "Message", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ")", ";", "assertEquals", "(", "<NUM_LIT:3>", ",", "EmailContent", ".", "count", "(", "context", ",", "Message", ".", "DELETED_CONTENT_URI", ",", "null", ",", "null", ")", ")", ";", "adapter", ".", "sendDeletedItems", "(", "s", ",", "deletedIds", ",", "true", ")", ";", "assertEquals", "(", "<NUM_LIT:3>", ",", "deletedIds", ".", "size", "(", ")", ")", ";", "deletedIds", ".", "clear", "(", ")", ";", "Message", "msg4", "=", "ProviderTestUtils", ".", "setupMessage", "(", "\"", "<STR_LIT:3>", "\"", ",", "acct", ".", "mId", ",", "box1", ".", "mId", ",", "true", ",", "true", ",", "context", ")", ";", "assertEquals", "(", "1", ",", "EmailContent", ".", "count", "(", "context", ",", "Message", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ")", ";", "Body", "body", "=", "Body", ".", "restoreBodyWithMessageId", "(", "context", ",", "msg4", ".", "mId", ")", ";", "ContentValues", "values", "=", "new", "ContentValues", "(", ")", ";", "values", ".", "put", "(", "Body", ".", "SOURCE_MESSAGE_KEY", ",", "msg2", ".", "mId", ")", ";", "body", ".", "update", "(", "context", ",", "values", ")", ";", "adapter", ".", "sendDeletedItems", "(", "s", ",", "deletedIds", ",", "true", ")", ";", "assertEquals", "(", "<NUM_LIT:2>", ",", "deletedIds", ".", "size", "(", ")", ")", ";", "assertFalse", "(", "deletedIds", ".", "contains", "(", "msg2", ".", "mId", ")", ")", ";", "}", "</s>"]
["<s>", "void", "reconcileAccountsWithAccountManager", "(", "Context", "context", ",", "List", "<", "Account", ">", "cachedEasAccounts", ",", "android", ".", "accounts", ".", "Account", "[", "]", "accountManagerAccounts", ")", "{", "for", "(", "Account", "providerAccount", ":", "cachedEasAccounts", ")", "{", "String", "providerAccountName", "=", "providerAccount", ".", "mEmailAddress", ";", "boolean", "found", "=", "false", ";", "for", "(", "android", ".", "accounts", ".", "Account", "accountManagerAccount", ":", "accountManagerAccounts", ")", "{", "if", "(", "accountManagerAccount", ".", "name", ".", "equalsIgnoreCase", "(", "providerAccountName", ")", ")", "{", "found", "=", "true", ";", "break", ";", "}", "}", "if", "(", "!", "found", ")", "{", "log", "(", "\"", "<STR_LIT>", "\"", "+", "providerAccountName", ")", ";", "mResolver", ".", "delete", "(", "ContentUris", ".", "withAppendedId", "(", "Account", ".", "CONTENT_URI", ",", "providerAccount", ".", "mId", ")", ",", "null", ",", "null", ")", ";", "}", "}", "for", "(", "android", ".", "accounts", ".", "Account", "accountManagerAccount", ":", "accountManagerAccounts", ")", "{", "String", "accountManagerAccountName", "=", "accountManagerAccount", ".", "name", ";", "boolean", "found", "=", "false", ";", "for", "(", "Account", "cachedEasAccount", ":", "cachedEasAccounts", ")", "{", "if", "(", "cachedEasAccount", ".", "mEmailAddress", ".", "equalsIgnoreCase", "(", "accountManagerAccountName", ")", ")", "{", "found", "=", "true", ";", "}", "}", "if", "(", "!", "found", ")", "{", "log", "(", "\"", "<STR_LIT>", "\"", "+", "accountManagerAccountName", ")", ";", "AccountManager", ".", "get", "(", "context", ")", ".", "removeAccount", "(", "accountManagerAccount", ",", "null", ",", "null", ")", ";", "}", "}", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "super", ".", "setUp", "(", ")", ";", "mMockContext", "=", "getMockContext", "(", ")", ";", "deleteTemporaryAccountManagerAccounts", "(", "getContext", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "tearDown", "(", ")", "throws", "Exception", "{", "super", ".", "tearDown", "(", ")", ";", "deleteTemporaryAccountManagerAccounts", "(", "getContext", "(", ")", ")", ";", "}", "</s>"]
["<s>", "private", "android", ".", "accounts", ".", "Account", "makeAccountManagerAccount", "(", "String", "username", ")", "{", "return", "new", "android", ".", "accounts", ".", "Account", "(", "username", ",", "Eas", ".", "ACCOUNT_MANAGER_TYPE", ")", ";", "}", "</s>"]
["<s>", "private", "void", "createAccountManagerAccount", "(", "String", "username", ")", "{", "final", "android", ".", "accounts", ".", "Account", "account", "=", "makeAccountManagerAccount", "(", "username", ")", ";", "AccountManager", ".", "get", "(", "getContext", "(", ")", ")", ".", "addAccountExplicitly", "(", "account", ",", "\"", "<STR_LIT>", "\"", ",", "null", ")", ";", "}", "</s>"]
["<s>", "private", "Account", "setupProviderAndAccountManagerAccount", "(", "String", "username", ")", "{", "createAccountManagerAccount", "(", "username", "+", "\"", "<STR_LIT>", "\"", ")", ";", "return", "ProviderTestUtils", ".", "setupAccount", "(", "username", ",", "true", ",", "mMockContext", ")", ";", "}", "</s>"]
["<s>", "private", "AccountList", "makeSyncManagerAccountList", "(", ")", "{", "AccountList", "accountList", "=", "new", "AccountList", "(", ")", ";", "Cursor", "c", "=", "mMockContext", ".", "getContentResolver", "(", ")", ".", "query", "(", "Account", ".", "CONTENT_URI", ",", "Account", ".", "CONTENT_PROJECTION", ",", "null", ",", "null", ",", "null", ")", ";", "try", "{", "while", "(", "c", ".", "moveToNext", "(", ")", ")", "{", "accountList", ".", "add", "(", "new", "Account", "(", ")", ".", "restore", "(", "c", ")", ")", ";", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "return", "accountList", ";", "}", "</s>"]
["<s>", "private", "void", "deleteAccountManagerAccount", "(", "Context", "context", ",", "android", ".", "accounts", ".", "Account", "account", ")", "{", "AccountManagerFuture", "<", "Boolean", ">", "future", "=", "AccountManager", ".", "get", "(", "context", ")", ".", "removeAccount", "(", "account", ",", "null", ",", "null", ")", ";", "try", "{", "future", ".", "getResult", "(", ")", ";", "}", "catch", "(", "OperationCanceledException", "e", ")", "{", "}", "catch", "(", "AuthenticatorException", "e", ")", "{", "}", "catch", "(", "IOException", "e", ")", "{", "}", "}", "</s>"]
["<s>", "private", "void", "deleteTemporaryAccountManagerAccounts", "(", "Context", "context", ")", "{", "android", ".", "accounts", ".", "Account", "[", "]", "accountManagerAccounts", "=", "AccountManager", ".", "get", "(", "context", ")", ".", "getAccountsByType", "(", "Eas", ".", "ACCOUNT_MANAGER_TYPE", ")", ";", "for", "(", "android", ".", "accounts", ".", "Account", "accountManagerAccount", ":", "accountManagerAccounts", ")", "{", "if", "(", "accountManagerAccount", ".", "name", ".", "startsWith", "(", "TEST_ACCOUNT_PREFIX", ")", "&", "&", "accountManagerAccount", ".", "name", ".", "endsWith", "(", "TEST_ACCOUNT_SUFFIX", ")", ")", "{", "deleteAccountManagerAccount", "(", "context", ",", "accountManagerAccount", ")", ";", "}", "}", "}", "</s>"]
["<s>", "private", "String", "getTestAccountName", "(", "String", "name", ")", "{", "return", "TEST_ACCOUNT_PREFIX", "+", "name", ";", "}", "</s>"]
["<s>", "private", "String", "getTestAccountEmailAddress", "(", "String", "name", ")", "{", "return", "TEST_ACCOUNT_PREFIX", "+", "name", "+", "TEST_ACCOUNT_SUFFIX", ";", "}", "</s>"]
["<s>", "public", "void", "testReconcileAccounts", "(", ")", "{", "Context", "context", "=", "getContext", "(", ")", ";", "Account", "firstAccount", "=", "setupProviderAndAccountManagerAccount", "(", "getTestAccountName", "(", "\"", "<STR_LIT:1>", "\"", ")", ")", ";", "setupProviderAndAccountManagerAccount", "(", "getTestAccountName", "(", "\"", "<STR_LIT:2>", "\"", ")", ")", ";", "setupProviderAndAccountManagerAccount", "(", "getTestAccountName", "(", "\"", "<STR_LIT:3>", "\"", ")", ")", ";", "assertEquals", "(", "<NUM_LIT:3>", ",", "EmailContent", ".", "count", "(", "mMockContext", ",", "Account", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ")", ";", "android", ".", "accounts", ".", "Account", "[", "]", "accountManagerAccounts", "=", "AccountManager", ".", "get", "(", "context", ")", ".", "getAccountsByType", "(", "Eas", ".", "ACCOUNT_MANAGER_TYPE", ")", ";", "assertEquals", "(", "<NUM_LIT:3>", ",", "accountManagerAccounts", ".", "length", ")", ";", "android", ".", "accounts", ".", "Account", "removedAccount", "=", "makeAccountManagerAccount", "(", "getTestAccountEmailAddress", "(", "\"", "<STR_LIT:2>", "\"", ")", ")", ";", "deleteAccountManagerAccount", "(", "context", ",", "removedAccount", ")", ";", "accountManagerAccounts", "=", "AccountManager", ".", "get", "(", "context", ")", ".", "getAccountsByType", "(", "Eas", ".", "ACCOUNT_MANAGER_TYPE", ")", ";", "assertEquals", "(", "<NUM_LIT:2>", ",", "accountManagerAccounts", ".", "length", ")", ";", "SyncManager", "syncManager", "=", "new", "SyncManager", "(", ")", ";", "ContentResolver", "resolver", "=", "mMockContext", ".", "getContentResolver", "(", ")", ";", "syncManager", ".", "mResolver", "=", "resolver", ";", "syncManager", ".", "reconcileAccountsWithAccountManager", "(", "context", ",", "makeSyncManagerAccountList", "(", ")", ",", "accountManagerAccounts", ")", ";", "assertEquals", "(", "<NUM_LIT:2>", ",", "EmailContent", ".", "count", "(", "mMockContext", ",", "Account", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ")", ";", "resolver", ".", "delete", "(", "ContentUris", ".", "withAppendedId", "(", "Account", ".", "CONTENT_URI", ",", "firstAccount", ".", "mId", ")", ",", "null", ",", "null", ")", ";", "assertEquals", "(", "1", ",", "EmailContent", ".", "count", "(", "mMockContext", ",", "Account", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ")", ";", "syncManager", ".", "reconcileAccountsWithAccountManager", "(", "context", ",", "makeSyncManagerAccountList", "(", ")", ",", "accountManagerAccounts", ")", ";", "accountManagerAccounts", "=", "AccountManager", ".", "get", "(", "getContext", "(", ")", ")", ".", "getAccountsByType", "(", "Eas", ".", "ACCOUNT_MANAGER_TYPE", ")", ";", "assertEquals", "(", "1", ",", "accountManagerAccounts", ".", "length", ")", ";", "assertEquals", "(", "getTestAccountEmailAddress", "(", "\"", "<STR_LIT:3>", "\"", ")", ",", "accountManagerAccounts", "[", "0", "]", ".", "name", ")", ";", "}", "</s>"]
["<s>", "public", "void", "run", "(", ")", "{", "handleReceive", "(", "context", ")", ";", "}", "</s>"]
["<s>", "private", "void", "handleReceive", "(", "Context", "context", ")", "{", "ArrayList", "<", "Long", ">", "mailboxesToNotify", "=", "new", "ArrayList", "<", "Long", ">", "(", ")", ";", "ContentResolver", "cr", "=", "context", ".", "getContentResolver", "(", ")", ";", "int", "messageCount", "=", "0", ";", "String", "selector", "=", "SyncManager", ".", "getEasAccountSelector", "(", ")", ";", "Cursor", "c", "=", "cr", ".", "query", "(", "Message", ".", "DELETED_CONTENT_URI", ",", "MAILBOX_DATA_PROJECTION", ",", "selector", ",", "null", ",", "null", ")", ";", "try", "{", "while", "(", "c", ".", "moveToNext", "(", ")", ")", "{", "messageCount", "+", "+", ";", "long", "mailboxId", "=", "c", ".", "getLong", "(", "0", ")", ";", "if", "(", "!", "mailboxesToNotify", ".", "contains", "(", "mailboxId", ")", ")", "{", "mailboxesToNotify", ".", "add", "(", "mailboxId", ")", ";", "}", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "c", "=", "cr", ".", "query", "(", "Message", ".", "UPDATED_CONTENT_URI", ",", "MAILBOX_DATA_PROJECTION", ",", "selector", ",", "null", ",", "null", ")", ";", "try", "{", "while", "(", "c", ".", "moveToNext", "(", ")", ")", "{", "messageCount", "+", "+", ";", "long", "mailboxId", "=", "c", ".", "getLong", "(", "0", ")", ";", "if", "(", "!", "mailboxesToNotify", ".", "contains", "(", "mailboxId", ")", ")", "{", "mailboxesToNotify", ".", "add", "(", "mailboxId", ")", ";", "}", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "for", "(", "Long", "mailboxId", ":", "mailboxesToNotify", ")", "{", "SyncManager", ".", "serviceRequest", "(", "mailboxId", ",", "SyncManager", ".", "SYNC_UPSYNC", ")", ";", "}", "Log", ".", "v", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", "+", "messageCount", "+", "\"", "<STR_LIT>", "\"", "+", "mailboxesToNotify", ".", "size", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "boolean", "isDebugEnabled", "(", ")", "{", "return", "false", ";", "}", "</s>"]
["<s>", "public", "boolean", "isErrorEnabled", "(", ")", "{", "return", "false", ";", "}", "</s>"]
["<s>", "public", "boolean", "isFatalEnabled", "(", ")", "{", "return", "false", ";", "}", "</s>"]
["<s>", "public", "boolean", "isInfoEnabled", "(", ")", "{", "return", "false", ";", "}", "</s>"]
["<s>", "public", "boolean", "isTraceEnabled", "(", ")", "{", "return", "false", ";", "}", "</s>"]
["<s>", "public", "boolean", "isWarnEnabled", "(", ")", "{", "return", "false", ";", "}", "</s>"]
["<s>", "public", "static", "Log", "getLog", "(", "Class", "clazz", ")", "{", "return", "new", "Log", "(", "clazz", ")", ";", "}", "</s>"]
["<s>", "public", "static", "void", "actionStart", "(", "Activity", "fromActivity", ")", "{", "Intent", "i", "=", "new", "Intent", "(", "fromActivity", ",", "Welcome", ".", "class", ")", ";", "fromActivity", ".", "startActivity", "(", "i", ")", ";", "}", "</s>"]
["<s>", "public", "static", "void", "actionAccountCreateFinishedEas", "(", "Activity", "fromActivity", ")", "{", "Intent", "i", "=", "new", "Intent", "(", "fromActivity", ",", "AccountSetupBasics", ".", "class", ")", ";", "i", ".", "putExtra", "(", "AccountSetupBasics", ".", "ACTION_RETURN_TO_CALLER", ",", "true", ")", ";", "i", ".", "setFlags", "(", "Intent", ".", "FLAG_ACTIVITY_CLEAR_TOP", ")", ";", "fromActivity", ".", "startActivity", "(", "i", ")", ";", "}", "</s>"]
["<s>", "public", "static", "void", "actionAccountCreateFinished", "(", "Activity", "fromActivity", ",", "long", "accountId", ")", "{", "Intent", "i", "=", "new", "Intent", "(", "fromActivity", ",", "AccountSetupBasics", ".", "class", ")", ";", "i", ".", "putExtra", "(", "AccountSetupBasics", ".", "ACTION_START_AT_MESSAGE_LIST", ",", "accountId", ")", ";", "i", ".", "setFlags", "(", "Intent", ".", "FLAG_ACTIVITY_CLEAR_TOP", ")", ";", "fromActivity", ".", "startActivity", "(", "i", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "onBackPressed", "(", ")", "{", "boolean", "easFlowMode", "=", "getIntent", "(", ")", ".", "getBooleanExtra", "(", "EXTRA_EAS_FLOW", ",", "false", ")", ";", "if", "(", "easFlowMode", ")", "{", "AccountSetupBasics", ".", "actionAccountCreateFinishedEas", "(", "this", ")", ";", "}", "else", "{", "AccountSetupBasics", ".", "actionAccountCreateFinished", "(", "this", ",", "mAccount", ".", "mId", ")", ";", "}", "finish", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "onChange", "(", "boolean", "selfChange", ")", "{", "if", "(", "mLoadMessageListTask", "=", "=", "null", "&", "&", "mMessageListCursor", "!", "=", "null", ")", "{", "mLoadMessageListTask", "=", "new", "LoadMessageListTask", "(", "mMailboxId", ")", ";", "mLoadMessageListTask", ".", "execute", "(", ")", ";", "}", "}", "</s>"]
["<s>", "private", "boolean", "moveToNewer", "(", ")", "{", "if", "(", "mMessageListCursor", "!", "=", "null", "&", "&", "!", "mMessageListCursor", ".", "isFirst", "(", ")", "&", "&", "mMessageListCursor", ".", "moveToPrevious", "(", ")", ")", "{", "mMessageId", "=", "mMessageListCursor", ".", "getLong", "(", "0", ")", ";", "messageChanged", "(", ")", ";", "return", "true", ";", "}", "return", "false", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "void", "onPostExecute", "(", "Cursor", "cursor", ")", "{", "if", "(", "cursor", "=", "=", "null", ")", "{", "return", ";", "}", "MessageView", ".", "this", ".", "mLoadMessageListTask", "=", "null", ";", "if", "(", "cursor", ".", "isClosed", "(", ")", ")", "{", "return", ";", "}", "closeMessageListCursor", "(", ")", ";", "mMessageListCursor", "=", "cursor", ";", "mMessageListCursor", ".", "registerContentObserver", "(", "MessageView", ".", "this", ".", "mCursorObserver", ")", ";", "repositionMessageListCursor", "(", ")", ";", "}", "</s>"]
["<s>", "public", "static", "SSLSocketFactory", "getSocketFactory", "(", ")", "{", "return", "DEFAULT_FACTORY", ";", "}", "</s>"]
["<s>", "private", "static", "KeyManager", "[", "]", "createKeyManagers", "(", "final", "KeyStore", "keystore", ",", "final", "String", "password", ")", "throws", "KeyStoreException", ",", "NoSuchAlgorithmException", ",", "UnrecoverableKeyException", "{", "if", "(", "keystore", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "KeyManagerFactory", "kmfactory", "=", "KeyManagerFactory", ".", "getInstance", "(", "KeyManagerFactory", ".", "getDefaultAlgorithm", "(", ")", ")", ";", "kmfactory", ".", "init", "(", "keystore", ",", "password", "!", "=", "null", "?", "password", ".", "toCharArray", "(", ")", ":", "null", ")", ";", "return", "kmfactory", ".", "getKeyManagers", "(", ")", ";", "}", "</s>"]
["<s>", "private", "static", "TrustManager", "[", "]", "createTrustManagers", "(", "final", "KeyStore", "keystore", ")", "throws", "KeyStoreException", ",", "NoSuchAlgorithmException", "{", "if", "(", "keystore", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "TrustManagerFactory", "tmfactory", "=", "TrustManagerFactory", ".", "getInstance", "(", "TrustManagerFactory", ".", "getDefaultAlgorithm", "(", ")", ")", ";", "tmfactory", ".", "init", "(", "keystore", ")", ";", "return", "tmfactory", ".", "getTrustManagers", "(", ")", ";", "}", "</s>"]
["<s>", "public", "Socket", "createSocket", "(", ")", "throws", "IOException", "{", "return", "(", "SSLSocket", ")", "this", ".", "socketfactory", ".", "createSocket", "(", ")", ";", "}", "</s>"]
["<s>", "public", "Socket", "connectSocket", "(", "final", "Socket", "sock", ",", "final", "String", "host", ",", "final", "int", "port", ",", "final", "InetAddress", "localAddress", ",", "int", "localPort", ",", "final", "HttpParams", "params", ")", "throws", "IOException", "{", "if", "(", "host", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "if", "(", "params", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "SSLSocket", "sslsock", "=", "(", "SSLSocket", ")", "(", "(", "sock", "!", "=", "null", ")", "?", "sock", ":", "createSocket", "(", ")", ")", ";", "if", "(", "(", "localAddress", "!", "=", "null", ")", "|", "|", "(", "localPort", ">", "0", ")", ")", "{", "if", "(", "localPort", "<", "0", ")", "localPort", "=", "0", ";", "InetSocketAddress", "isa", "=", "new", "InetSocketAddress", "(", "localAddress", ",", "localPort", ")", ";", "sslsock", ".", "bind", "(", "isa", ")", ";", "}", "int", "connTimeout", "=", "HttpConnectionParams", ".", "getConnectionTimeout", "(", "params", ")", ";", "int", "soTimeout", "=", "HttpConnectionParams", ".", "getSoTimeout", "(", "params", ")", ";", "InetSocketAddress", "remoteAddress", ";", "if", "(", "this", ".", "nameResolver", "!", "=", "null", ")", "{", "remoteAddress", "=", "new", "InetSocketAddress", "(", "this", ".", "nameResolver", ".", "resolve", "(", "host", ")", ",", "port", ")", ";", "}", "else", "{", "remoteAddress", "=", "new", "InetSocketAddress", "(", "host", ",", "port", ")", ";", "}", "sslsock", ".", "connect", "(", "remoteAddress", ",", "connTimeout", ")", ";", "sslsock", ".", "setSoTimeout", "(", "soTimeout", ")", ";", "try", "{", "hostnameVerifier", ".", "verify", "(", "host", ",", "sslsock", ")", ";", "}", "catch", "(", "IOException", "iox", ")", "{", "try", "{", "sslsock", ".", "close", "(", ")", ";", "}", "catch", "(", "Exception", "x", ")", "{", "}", "throw", "iox", ";", "}", "return", "sslsock", ";", "}", "</s>"]
["<s>", "public", "boolean", "isSecure", "(", "Socket", "sock", ")", "throws", "IllegalArgumentException", "{", "if", "(", "sock", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "if", "(", "!", "(", "sock", "instanceof", "SSLSocket", ")", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "if", "(", "sock", ".", "isClosed", "(", ")", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "return", "true", ";", "}", "</s>"]
["<s>", "public", "Socket", "createSocket", "(", "final", "Socket", "socket", ",", "final", "String", "host", ",", "final", "int", "port", ",", "final", "boolean", "autoClose", ")", "throws", "IOException", ",", "UnknownHostException", "{", "SSLSocket", "sslSocket", "=", "(", "SSLSocket", ")", "this", ".", "socketfactory", ".", "createSocket", "(", "socket", ",", "host", ",", "port", ",", "autoClose", ")", ";", "hostnameVerifier", ".", "verify", "(", "host", ",", "sslSocket", ")", ";", "return", "sslSocket", ";", "}", "</s>"]
["<s>", "public", "void", "setHostnameVerifier", "(", "X509HostnameVerifier", "hostnameVerifier", ")", "{", "if", "(", "hostnameVerifier", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "this", ".", "hostnameVerifier", "=", "hostnameVerifier", ";", "}", "</s>"]
["<s>", "public", "X509HostnameVerifier", "getHostnameVerifier", "(", ")", "{", "return", "hostnameVerifier", ";", "}", "</s>"]
["<s>", "void", "resetInput", "(", "InputStream", "in", ")", "{", "this", ".", "in", "=", "in", ";", "}", "</s>"]
["<s>", "EasSyncService", "getTestService", "(", "Account", "account", ",", "Mailbox", "mailbox", ")", "{", "EasSyncService", "service", "=", "new", "EasSyncService", "(", ")", ";", "service", ".", "mContext", "=", "mMockContext", ";", "service", ".", "mMailbox", "=", "mailbox", ";", "service", ".", "mAccount", "=", "account", ";", "return", "service", ";", "}", "</s>"]
["<s>", "void", "setupSyncParserAndAdapter", "(", "Account", "account", ",", "Mailbox", "mailbox", ")", "throws", "IOException", "{", "EasSyncService", "service", "=", "getTestService", "(", "account", ",", "mailbox", ")", ";", "mSyncAdapter", "=", "new", "EmailSyncAdapter", "(", "mailbox", ",", "service", ")", ";", "mSyncParser", "=", "mSyncAdapter", ".", "new", "EasEmailSyncParser", "(", "getTestInputStream", "(", ")", ",", "mSyncAdapter", ")", ";", "}", "</s>"]
["<s>", "ArrayList", "<", "Long", ">", "setupAccountMailboxAndMessages", "(", "int", "numMessages", ")", "{", "ArrayList", "<", "Long", ">", "ids", "=", "new", "ArrayList", "<", "Long", ">", "(", ")", ";", "mAccount", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "true", ",", "mMockContext", ")", ";", "mMailbox", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT:1>", "\"", ",", "mAccount", ".", "mId", ",", "true", ",", "mMockContext", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "numMessages", ";", "i", "+", "+", ")", "{", "Message", "msg", "=", "ProviderTestUtils", ".", "setupMessage", "(", "\"", "<STR_LIT>", "\"", "+", "i", ",", "mAccount", ".", "mId", ",", "mMailbox", ".", "mId", ",", "true", ",", "true", ",", "mMockContext", ")", ";", "ids", ".", "add", "(", "msg", ".", "mId", ")", ";", "}", "assertEquals", "(", "numMessages", ",", "EmailContent", ".", "count", "(", "mMockContext", ",", "Message", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ")", ";", "return", "ids", ";", "}", "</s>"]
["<s>", "public", "void", "testDeleteParser", "(", ")", "throws", "IOException", "{", "ArrayList", "<", "Long", ">", "messageIds", "=", "setupAccountMailboxAndMessages", "(", "<NUM_LIT:3>", ")", ";", "ContentValues", "cv", "=", "new", "ContentValues", "(", ")", ";", "cv", ".", "put", "(", "SyncColumns", ".", "SERVER_ID", ",", "\"", "<STR_LIT>", "\"", ")", ";", "long", "deleteMessageId", "=", "messageIds", ".", "get", "(", "1", ")", ";", "mMockResolver", ".", "update", "(", "ContentUris", ".", "withAppendedId", "(", "Message", ".", "CONTENT_URI", ",", "deleteMessageId", ")", ",", "cv", ",", "null", ",", "null", ")", ";", "setupSyncParserAndAdapter", "(", "mAccount", ",", "mMailbox", ")", ";", "Serializer", "s", "=", "new", "Serializer", "(", "false", ")", ";", "s", ".", "start", "(", "Tags", ".", "SYNC_DELETE", ")", ".", "data", "(", "Tags", ".", "SYNC_SERVER_ID", ",", "\"", "<STR_LIT>", "\"", ")", ".", "end", "(", ")", ".", "done", "(", ")", ";", "byte", "[", "]", "bytes", "=", "s", ".", "toByteArray", "(", ")", ";", "mSyncParser", ".", "resetInput", "(", "new", "ByteArrayInputStream", "(", "bytes", ")", ")", ";", "mSyncParser", ".", "nextTag", "(", "0", ")", ";", "ArrayList", "<", "Long", ">", "deleteList", "=", "new", "ArrayList", "<", "Long", ">", "(", ")", ";", "mSyncParser", ".", "deleteParser", "(", "deleteList", ",", "Tags", ".", "SYNC_DELETE", ")", ";", "assertEquals", "(", "1", ",", "deleteList", ".", "size", "(", ")", ")", ";", "long", "id", "=", "deleteList", ".", "get", "(", "0", ")", ";", "assertEquals", "(", "deleteMessageId", ",", "id", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testChangeParser", "(", ")", "throws", "IOException", "{", "ArrayList", "<", "Long", ">", "messageIds", "=", "setupAccountMailboxAndMessages", "(", "<NUM_LIT:3>", ")", ";", "ContentValues", "cv", "=", "new", "ContentValues", "(", ")", ";", "cv", ".", "put", "(", "SyncColumns", ".", "SERVER_ID", ",", "\"", "<STR_LIT>", "\"", ")", ";", "long", "changeMessageId", "=", "messageIds", ".", "get", "(", "1", ")", ";", "mMockResolver", ".", "update", "(", "ContentUris", ".", "withAppendedId", "(", "Message", ".", "CONTENT_URI", ",", "changeMessageId", ")", ",", "cv", ",", "null", ",", "null", ")", ";", "setupSyncParserAndAdapter", "(", "mAccount", ",", "mMailbox", ")", ";", "Serializer", "s", "=", "new", "Serializer", "(", "false", ")", ";", "s", ".", "start", "(", "Tags", ".", "SYNC_CHANGE", ")", ".", "data", "(", "Tags", ".", "SYNC_SERVER_ID", ",", "\"", "<STR_LIT>", "\"", ")", ";", "s", ".", "start", "(", "Tags", ".", "SYNC_APPLICATION_DATA", ")", ".", "data", "(", "Tags", ".", "EMAIL_READ", ",", "\"", "<STR_LIT:0>", "\"", ")", ".", "end", "(", ")", ";", "s", ".", "end", "(", ")", ".", "done", "(", ")", ";", "byte", "[", "]", "bytes", "=", "s", ".", "toByteArray", "(", ")", ";", "mSyncParser", ".", "resetInput", "(", "new", "ByteArrayInputStream", "(", "bytes", ")", ")", ";", "mSyncParser", ".", "nextTag", "(", "0", ")", ";", "ArrayList", "<", "ServerChange", ">", "changeList", "=", "new", "ArrayList", "<", "ServerChange", ">", "(", ")", ";", "mSyncParser", ".", "changeParser", "(", "changeList", ")", ";", "assertEquals", "(", "1", ",", "changeList", ".", "size", "(", ")", ")", ";", "ServerChange", "change", "=", "changeList", ".", "get", "(", "0", ")", ";", "assertEquals", "(", "changeMessageId", ",", "change", ".", "id", ")", ";", "assertNotNull", "(", "change", ".", "read", ")", ";", "assertFalse", "(", "change", ".", "read", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testCleanup", "(", ")", "throws", "IOException", "{", "ArrayList", "<", "Long", ">", "messageIds", "=", "setupAccountMailboxAndMessages", "(", "<NUM_LIT:3>", ")", ";", "setupSyncParserAndAdapter", "(", "mAccount", ",", "mMailbox", ")", ";", "long", "id", "=", "messageIds", ".", "get", "(", "0", ")", ";", "mMockResolver", ".", "delete", "(", "ContentUris", ".", "withAppendedId", "(", "Message", ".", "SYNCED_CONTENT_URI", ",", "id", ")", ",", "null", ",", "null", ")", ";", "mSyncAdapter", ".", "mDeletedIdList", ".", "add", "(", "id", ")", ";", "id", "=", "messageIds", ".", "get", "(", "1", ")", ";", "mMockResolver", ".", "delete", "(", "ContentUris", ".", "withAppendedId", "(", "Message", ".", "SYNCED_CONTENT_URI", ",", "id", ")", ",", "null", ",", "null", ")", ";", "mSyncAdapter", ".", "mDeletedIdList", ".", "add", "(", "id", ")", ";", "id", "=", "messageIds", ".", "get", "(", "<NUM_LIT:2>", ")", ";", "ContentValues", "cv", "=", "new", "ContentValues", "(", ")", ";", "cv", ".", "put", "(", "Message", ".", "FLAG_READ", ",", "0", ")", ";", "mMockResolver", ".", "update", "(", "ContentUris", ".", "withAppendedId", "(", "Message", ".", "SYNCED_CONTENT_URI", ",", "id", ")", ",", "cv", ",", "null", ",", "null", ")", ";", "mSyncAdapter", ".", "mUpdatedIdList", ".", "add", "(", "id", ")", ";", "assertEquals", "(", "1", ",", "EmailContent", ".", "count", "(", "mMockContext", ",", "Message", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ")", ";", "assertEquals", "(", "<NUM_LIT:2>", ",", "EmailContent", ".", "count", "(", "mMockContext", ",", "Message", ".", "DELETED_CONTENT_URI", ",", "null", ",", "null", ")", ")", ";", "assertEquals", "(", "1", ",", "EmailContent", ".", "count", "(", "mMockContext", ",", "Message", ".", "UPDATED_CONTENT_URI", ",", "null", ",", "null", ")", ")", ";", "mSyncAdapter", ".", "cleanup", "(", ")", ";", "assertEquals", "(", "0", ",", "EmailContent", ".", "count", "(", "mMockContext", ",", "Message", ".", "DELETED_CONTENT_URI", ",", "null", ",", "null", ")", ")", ";", "assertEquals", "(", "0", ",", "EmailContent", ".", "count", "(", "mMockContext", ",", "Message", ".", "UPDATED_CONTENT_URI", ",", "null", ",", "null", ")", ")", ";", "}", "</s>"]
["<s>", "public", "static", "void", "actionNewAccountWithCredentials", "(", "Activity", "fromActivity", ",", "String", "username", ",", "String", "password", ",", "boolean", "easFlow", ")", "{", "Intent", "i", "=", "new", "Intent", "(", "fromActivity", ",", "AccountSetupBasics", ".", "class", ")", ";", "i", ".", "putExtra", "(", "EXTRA_USERNAME", ",", "username", ")", ";", "i", ".", "putExtra", "(", "EXTRA_PASSWORD", ",", "password", ")", ";", "i", ".", "putExtra", "(", "EXTRA_EAS_FLOW", ",", "easFlow", ")", ";", "fromActivity", ".", "startActivity", "(", "i", ")", ";", "}", "</s>"]
["<s>", "public", "static", "void", "actionValidateSettings", "(", "Activity", "fromActivity", ",", "EmailContent", ".", "Account", "account", ",", "boolean", "checkIncoming", ",", "boolean", "checkOutgoing", ")", "{", "Intent", "i", "=", "new", "Intent", "(", "fromActivity", ",", "AccountSetupCheckSettings", ".", "class", ")", ";", "i", ".", "putExtra", "(", "EXTRA_ACCOUNT", ",", "account", ")", ";", "i", ".", "putExtra", "(", "EXTRA_CHECK_INCOMING", ",", "checkIncoming", ")", ";", "i", ".", "putExtra", "(", "EXTRA_CHECK_OUTGOING", ",", "checkOutgoing", ")", ";", "fromActivity", ".", "startActivityForResult", "(", "i", ",", "REQUEST_CODE_VALIDATE", ")", ";", "}", "</s>"]
["<s>", "public", "static", "void", "actionAutoDiscover", "(", "Activity", "fromActivity", ",", "EmailContent", ".", "Account", "account", ",", "String", "userName", ",", "String", "password", ")", "{", "Intent", "i", "=", "new", "Intent", "(", "fromActivity", ",", "AccountSetupCheckSettings", ".", "class", ")", ";", "i", ".", "putExtra", "(", "EXTRA_ACCOUNT", ",", "account", ")", ";", "i", ".", "putExtra", "(", "EXTRA_AUTO_DISCOVER", ",", "true", ")", ";", "i", ".", "putExtra", "(", "EXTRA_AUTO_DISCOVER_USERNAME", ",", "userName", ")", ";", "i", ".", "putExtra", "(", "EXTRA_AUTO_DISCOVER_PASSWORD", ",", "password", ")", ";", "fromActivity", ".", "startActivityForResult", "(", "i", ",", "REQUEST_CODE_AUTO_DISCOVER", ")", ";", "}", "</s>"]
["<s>", "private", "void", "showErrorDialog", "(", "final", "boolean", "autoDiscoverAuthException", ",", "final", "int", "msgResId", ",", "final", "Object", ".", ".", ".", "args", ")", "{", "mHandler", ".", "post", "(", "new", "Runnable", "(", ")", "{", "public", "void", "run", "(", ")", "{", "if", "(", "mDestroyed", ")", "{", "return", ";", "}", "mProgressBar", ".", "setIndeterminate", "(", "false", ")", ";", "new", "AlertDialog", ".", "Builder", "(", "AccountSetupCheckSettings", ".", "this", ")", ".", "setIcon", "(", "android", ".", "R", ".", "drawable", ".", "ic_dialog_alert", ")", ".", "setTitle", "(", "getString", "(", "R", ".", "string", ".", "account_setup_failed_dlg_title", ")", ")", ".", "setMessage", "(", "getString", "(", "msgResId", ",", "args", ")", ")", ".", "setCancelable", "(", "true", ")", ".", "setPositiveButton", "(", "getString", "(", "R", ".", "string", ".", "account_setup_failed_dlg_edit_details_action", ")", ",", "new", "DialogInterface", ".", "OnClickListener", "(", ")", "{", "public", "void", "onClick", "(", "DialogInterface", "dialog", ",", "int", "which", ")", "{", "if", "(", "autoDiscoverAuthException", ")", "{", "setResult", "(", "RESULT_AUTO_DISCOVER_AUTH_FAILED", ")", ";", "}", "else", "if", "(", "DBG_FORCE_RESULT_OK", ")", "{", "setResult", "(", "RESULT_OK", ")", ";", "}", "finish", "(", ")", ";", "}", "}", ")", ".", "show", "(", ")", ";", "}", "}", ")", ";", "}", "</s>"]
["<s>", "private", "void", "doOptions", "(", ")", "{", "boolean", "easFlowMode", "=", "getIntent", "(", ")", ".", "getBooleanExtra", "(", "EXTRA_EAS_FLOW", ",", "false", ")", ";", "AccountSetupOptions", ".", "actionOptions", "(", "this", ",", "mAccount", ",", "mMakeDefault", ",", "easFlowMode", ")", ";", "finish", "(", ")", ";", "}", "</s>"]
["<s>", "public", "Bundle", "autoDiscover", "(", "Context", "context", ",", "String", "emailAddress", ",", "String", "password", ")", "throws", "MessagingException", "{", "return", "null", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "Bundle", "autoDiscover", "(", "Context", "context", ",", "String", "username", ",", "String", "password", ")", "throws", "MessagingException", "{", "try", "{", "return", "new", "EmailServiceProxy", "(", "context", ",", "SyncManager", ".", "class", ")", ".", "autoDiscover", "(", "username", ",", "password", ")", ";", "}", "catch", "(", "RemoteException", "e", ")", "{", "return", "null", ";", "}", "}", "</s>"]
["<s>", "public", "Bundle", "autoDiscover", "(", "final", "String", "userName", ",", "final", "String", "password", ")", "throws", "RemoteException", "{", "setTask", "(", "new", "Runnable", "(", ")", "{", "public", "void", "run", "(", ")", "{", "try", "{", "if", "(", "mCallback", "!", "=", "null", ")", "mService", ".", "setCallback", "(", "mCallback", ")", ";", "mReturn", "=", "mService", ".", "autoDiscover", "(", "userName", ",", "password", ")", ";", "}", "catch", "(", "RemoteException", "e", ")", "{", "}", "}", "}", ")", ";", "waitForCompletion", "(", ")", ";", "if", "(", "mReturn", "=", "=", "null", ")", "{", "return", "null", ";", "}", "else", "{", "Bundle", "bundle", "=", "(", "Bundle", ")", "mReturn", ";", "Log", ".", "v", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", "+", "bundle", ".", "getInt", "(", "AUTO_DISCOVER_BUNDLE_ERROR_CODE", ")", ")", ";", "return", "bundle", ";", "}", "}", "</s>"]
["<s>", "private", "HttpPost", "getRedirect", "(", "HttpResponse", "resp", ",", "HttpPost", "post", ")", "{", "Header", "locHeader", "=", "resp", ".", "getFirstHeader", "(", "\"", "<STR_LIT>", "\"", ")", ";", "if", "(", "locHeader", "!", "=", "null", ")", "{", "String", "loc", "=", "locHeader", ".", "getValue", "(", ")", ";", "if", "(", "loc", "!", "=", "null", "&", "&", "loc", ".", "startsWith", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "post", ".", "setURI", "(", "URI", ".", "create", "(", "loc", ")", ")", ";", "return", "post", ";", "}", "}", "return", "null", ";", "}", "</s>"]
["<s>", "private", "HttpResponse", "postAutodiscover", "(", "HttpClient", "client", ",", "HttpPost", "post", ")", "throws", "IOException", ",", "MessagingException", "{", "userLog", "(", "\"", "<STR_LIT>", "\"", "+", "post", ".", "getURI", "(", ")", ")", ";", "HttpResponse", "resp", "=", "client", ".", "execute", "(", "post", ")", ";", "int", "code", "=", "resp", ".", "getStatusLine", "(", ")", ".", "getStatusCode", "(", ")", ";", "if", "(", "code", "=", "=", "AUTO_DISCOVER_REDIRECT_CODE", ")", "{", "post", "=", "getRedirect", "(", "resp", ",", "post", ")", ";", "if", "(", "post", "!", "=", "null", ")", "{", "userLog", "(", "\"", "<STR_LIT>", "\"", "+", "post", ".", "getURI", "(", ")", ")", ";", "return", "client", ".", "execute", "(", "post", ")", ";", "}", "}", "else", "if", "(", "isAuthError", "(", "code", ")", ")", "{", "throw", "new", "MessagingException", "(", "MessagingException", ".", "AUTHENTICATION_FAILED", ")", ";", "}", "else", "if", "(", "code", "!", "=", "HttpStatus", ".", "SC_OK", ")", "{", "userLog", "(", "\"", "<STR_LIT>", "\"", "+", "code", "+", "\"", "<STR_LIT>", "\"", ")", ";", "throw", "new", "IOException", "(", ")", ";", "}", "return", "resp", ";", "}", "</s>"]
["<s>", "public", "Bundle", "tryAutodiscover", "(", "String", "userName", ",", "String", "password", ")", "throws", "RemoteException", "{", "XmlSerializer", "s", "=", "Xml", ".", "newSerializer", "(", ")", ";", "ByteArrayOutputStream", "os", "=", "new", "ByteArrayOutputStream", "(", "<NUM_LIT>", ")", ";", "HostAuth", "hostAuth", "=", "new", "HostAuth", "(", ")", ";", "Bundle", "bundle", "=", "new", "Bundle", "(", ")", ";", "bundle", ".", "putInt", "(", "EmailServiceProxy", ".", "AUTO_DISCOVER_BUNDLE_ERROR_CODE", ",", "MessagingException", ".", "NO_ERROR", ")", ";", "try", "{", "s", ".", "setOutput", "(", "os", ",", "\"", "<STR_LIT:UTF-8>", "\"", ")", ";", "s", ".", "startDocument", "(", "\"", "<STR_LIT:UTF-8>", "\"", ",", "false", ")", ";", "s", ".", "startTag", "(", "null", ",", "\"", "<STR_LIT>", "\"", ")", ";", "s", ".", "attribute", "(", "null", ",", "\"", "<STR_LIT>", "\"", ",", "AUTO_DISCOVER_SCHEMA_PREFIX", "+", "\"", "<STR_LIT>", "\"", ")", ";", "s", ".", "startTag", "(", "null", ",", "\"", "<STR_LIT>", "\"", ")", ";", "s", ".", "startTag", "(", "null", ",", "\"", "<STR_LIT>", "\"", ")", ".", "text", "(", "userName", ")", ".", "endTag", "(", "null", ",", "\"", "<STR_LIT>", "\"", ")", ";", "s", ".", "startTag", "(", "null", ",", "\"", "<STR_LIT>", "\"", ")", ";", "s", ".", "text", "(", "AUTO_DISCOVER_SCHEMA_PREFIX", "+", "\"", "<STR_LIT>", "\"", ")", ";", "s", ".", "endTag", "(", "null", ",", "\"", "<STR_LIT>", "\"", ")", ";", "s", ".", "endTag", "(", "null", ",", "\"", "<STR_LIT>", "\"", ")", ";", "s", ".", "endTag", "(", "null", ",", "\"", "<STR_LIT>", "\"", ")", ";", "s", ".", "endDocument", "(", ")", ";", "String", "req", "=", "os", ".", "toString", "(", ")", ";", "mUserName", "=", "userName", ";", "mPassword", "=", "password", ";", "makeUriString", "(", "\"", "<STR_LIT>", "\"", ",", "null", ")", ";", "int", "amp", "=", "userName", ".", "indexOf", "(", "<CHAR_LIT>", ")", ";", "if", "(", "amp", "<", "0", ")", "{", "throw", "new", "RemoteException", "(", ")", ";", "}", "String", "domain", "=", "userName", ".", "substring", "(", "amp", "+", "1", ")", ";", "HttpPost", "post", "=", "new", "HttpPost", "(", "\"", "<STR_LIT>", "\"", "+", "domain", "+", "AUTO_DISCOVER_PAGE", ")", ";", "setHeaders", "(", "post", ")", ";", "post", ".", "setHeader", "(", "\"", "<STR_LIT:Content-Type>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "post", ".", "setEntity", "(", "new", "StringEntity", "(", "req", ")", ")", ";", "HttpClient", "client", "=", "getHttpClient", "(", "COMMAND_TIMEOUT", ")", ";", "HttpResponse", "resp", ";", "try", "{", "resp", "=", "postAutodiscover", "(", "client", ",", "post", ")", ";", "}", "catch", "(", "ClientProtocolException", "e1", ")", "{", "return", "null", ";", "}", "catch", "(", "IOException", "e1", ")", "{", "post", ".", "setURI", "(", "URI", ".", "create", "(", "\"", "<STR_LIT>", "\"", "+", "domain", "+", "AUTO_DISCOVER_PAGE", ")", ")", ";", "resp", "=", "postAutodiscover", "(", "client", ",", "post", ")", ";", "}", "int", "code", "=", "resp", ".", "getStatusLine", "(", ")", ".", "getStatusCode", "(", ")", ";", "userLog", "(", "\"", "<STR_LIT>", "\"", "+", "code", ")", ";", "if", "(", "code", "!", "=", "HttpStatus", ".", "SC_OK", ")", "return", "null", ";", "HttpEntity", "e", "=", "resp", ".", "getEntity", "(", ")", ";", "InputStream", "is", "=", "e", ".", "getContent", "(", ")", ";", "try", "{", "XmlPullParserFactory", "factory", "=", "XmlPullParserFactory", ".", "newInstance", "(", ")", ";", "XmlPullParser", "parser", "=", "factory", ".", "newPullParser", "(", ")", ";", "parser", ".", "setInput", "(", "is", ",", "\"", "<STR_LIT:UTF-8>", "\"", ")", ";", "int", "type", "=", "parser", ".", "getEventType", "(", ")", ";", "if", "(", "type", "=", "=", "XmlPullParser", ".", "START_DOCUMENT", ")", "{", "type", "=", "parser", ".", "next", "(", ")", ";", "if", "(", "type", "=", "=", "XmlPullParser", ".", "START_TAG", ")", "{", "String", "name", "=", "parser", ".", "getName", "(", ")", ";", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "hostAuth", "=", "new", "HostAuth", "(", ")", ";", "parseAutodiscover", "(", "parser", ",", "hostAuth", ")", ";", "if", "(", "hostAuth", ".", "mAddress", "!", "=", "null", "&", "&", "hostAuth", ".", "mLogin", "!", "=", "null", ")", "{", "hostAuth", ".", "mPassword", "=", "password", ";", "hostAuth", ".", "mPort", "=", "<NUM_LIT>", ";", "hostAuth", ".", "mProtocol", "=", "\"", "<STR_LIT>", "\"", ";", "hostAuth", ".", "mFlags", "=", "HostAuth", ".", "FLAG_SSL", "|", "HostAuth", ".", "FLAG_AUTHENTICATE", ";", "bundle", ".", "putParcelable", "(", "EmailServiceProxy", ".", "AUTO_DISCOVER_BUNDLE_HOST_AUTH", ",", "hostAuth", ")", ";", "}", "else", "{", "bundle", ".", "putInt", "(", "EmailServiceProxy", ".", "AUTO_DISCOVER_BUNDLE_ERROR_CODE", ",", "MessagingException", ".", "UNSPECIFIED_EXCEPTION", ")", ";", "}", "}", "}", "}", "}", "catch", "(", "XmlPullParserException", "e1", ")", "{", "}", "}", "catch", "(", "IllegalArgumentException", "e", ")", "{", "bundle", ".", "putInt", "(", "EmailServiceProxy", ".", "AUTO_DISCOVER_BUNDLE_ERROR_CODE", ",", "MessagingException", ".", "UNSPECIFIED_EXCEPTION", ")", ";", "}", "catch", "(", "IllegalStateException", "e", ")", "{", "bundle", ".", "putInt", "(", "EmailServiceProxy", ".", "AUTO_DISCOVER_BUNDLE_ERROR_CODE", ",", "MessagingException", ".", "UNSPECIFIED_EXCEPTION", ")", ";", "}", "catch", "(", "IOException", "e", ")", "{", "userLog", "(", "\"", "<STR_LIT>", "\"", ",", "e", ")", ";", "bundle", ".", "putInt", "(", "EmailServiceProxy", ".", "AUTO_DISCOVER_BUNDLE_ERROR_CODE", ",", "MessagingException", ".", "IOERROR", ")", ";", "}", "catch", "(", "MessagingException", "e", ")", "{", "bundle", ".", "putInt", "(", "EmailServiceProxy", ".", "AUTO_DISCOVER_BUNDLE_ERROR_CODE", ",", "MessagingException", ".", "AUTHENTICATION_FAILED", ")", ";", "}", "return", "bundle", ";", "}", "</s>"]
["<s>", "void", "parseServer", "(", "XmlPullParser", "parser", ",", "HostAuth", "hostAuth", ")", "throws", "XmlPullParserException", ",", "IOException", "{", "boolean", "mobileSync", "=", "false", ";", "while", "(", "true", ")", "{", "int", "type", "=", "parser", ".", "next", "(", ")", ";", "if", "(", "type", "=", "=", "XmlPullParser", ".", "END_TAG", "&", "&", "parser", ".", "getName", "(", ")", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "break", ";", "}", "else", "if", "(", "type", "=", "=", "XmlPullParser", ".", "START_TAG", ")", "{", "String", "name", "=", "parser", ".", "getName", "(", ")", ";", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "if", "(", "parser", ".", "nextText", "(", ")", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "mobileSync", "=", "true", ";", "}", "}", "else", "if", "(", "mobileSync", "&", "&", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "String", "url", "=", "parser", ".", "nextText", "(", ")", ".", "toLowerCase", "(", ")", ";", "if", "(", "url", ".", "startsWith", "(", "\"", "<STR_LIT>", "\"", ")", "&", "&", "url", ".", "endsWith", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "int", "lastSlash", "=", "url", ".", "lastIndexOf", "(", "<CHAR_LIT:/>", ")", ";", "hostAuth", ".", "mAddress", "=", "url", ".", "substring", "(", "<NUM_LIT:8>", ",", "lastSlash", ")", ";", "userLog", "(", "\"", "<STR_LIT>", "\"", "+", "hostAuth", ".", "mAddress", ")", ";", "}", "}", "}", "}", "}", "</s>"]
["<s>", "void", "parseSettings", "(", "XmlPullParser", "parser", ",", "HostAuth", "hostAuth", ")", "throws", "XmlPullParserException", ",", "IOException", "{", "while", "(", "true", ")", "{", "int", "type", "=", "parser", ".", "next", "(", ")", ";", "if", "(", "type", "=", "=", "XmlPullParser", ".", "END_TAG", "&", "&", "parser", ".", "getName", "(", ")", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "break", ";", "}", "else", "if", "(", "type", "=", "=", "XmlPullParser", ".", "START_TAG", ")", "{", "String", "name", "=", "parser", ".", "getName", "(", ")", ";", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "parseServer", "(", "parser", ",", "hostAuth", ")", ";", "}", "}", "}", "}", "</s>"]
["<s>", "void", "parseAction", "(", "XmlPullParser", "parser", ",", "HostAuth", "hostAuth", ")", "throws", "XmlPullParserException", ",", "IOException", "{", "while", "(", "true", ")", "{", "int", "type", "=", "parser", ".", "next", "(", ")", ";", "if", "(", "type", "=", "=", "XmlPullParser", ".", "END_TAG", "&", "&", "parser", ".", "getName", "(", ")", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "break", ";", "}", "else", "if", "(", "type", "=", "=", "XmlPullParser", ".", "START_TAG", ")", "{", "String", "name", "=", "parser", ".", "getName", "(", ")", ";", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "}", "else", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "Log", ".", "d", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", "+", "parser", ".", "nextText", "(", ")", ")", ";", "}", "else", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "parseSettings", "(", "parser", ",", "hostAuth", ")", ";", "}", "}", "}", "}", "</s>"]
["<s>", "void", "parseUser", "(", "XmlPullParser", "parser", ",", "HostAuth", "hostAuth", ")", "throws", "XmlPullParserException", ",", "IOException", "{", "while", "(", "true", ")", "{", "int", "type", "=", "parser", ".", "next", "(", ")", ";", "if", "(", "type", "=", "=", "XmlPullParser", ".", "END_TAG", "&", "&", "parser", ".", "getName", "(", ")", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "break", ";", "}", "else", "if", "(", "type", "=", "=", "XmlPullParser", ".", "START_TAG", ")", "{", "String", "name", "=", "parser", ".", "getName", "(", ")", ";", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "String", "addr", "=", "parser", ".", "nextText", "(", ")", ";", "hostAuth", ".", "mLogin", "=", "addr", ";", "userLog", "(", "\"", "<STR_LIT>", "\"", "+", "addr", ")", ";", "}", "else", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "String", "dn", "=", "parser", ".", "nextText", "(", ")", ";", "userLog", "(", "\"", "<STR_LIT>", "\"", "+", "dn", ")", ";", "}", "}", "}", "}", "</s>"]
["<s>", "void", "parseResponse", "(", "XmlPullParser", "parser", ",", "HostAuth", "hostAuth", ")", "throws", "XmlPullParserException", ",", "IOException", "{", "while", "(", "true", ")", "{", "int", "type", "=", "parser", ".", "next", "(", ")", ";", "if", "(", "type", "=", "=", "XmlPullParser", ".", "END_TAG", "&", "&", "parser", ".", "getName", "(", ")", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "break", ";", "}", "else", "if", "(", "type", "=", "=", "XmlPullParser", ".", "START_TAG", ")", "{", "String", "name", "=", "parser", ".", "getName", "(", ")", ";", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "parseUser", "(", "parser", ",", "hostAuth", ")", ";", "}", "else", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "parseAction", "(", "parser", ",", "hostAuth", ")", ";", "}", "}", "}", "}", "</s>"]
["<s>", "void", "parseAutodiscover", "(", "XmlPullParser", "parser", ",", "HostAuth", "hostAuth", ")", "throws", "XmlPullParserException", ",", "IOException", "{", "while", "(", "true", ")", "{", "int", "type", "=", "parser", ".", "nextTag", "(", ")", ";", "if", "(", "type", "=", "=", "XmlPullParser", ".", "END_TAG", "&", "&", "parser", ".", "getName", "(", ")", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "break", ";", "}", "else", "if", "(", "type", "=", "=", "XmlPullParser", ".", "START_TAG", "&", "&", "parser", ".", "getName", "(", ")", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "parseResponse", "(", "parser", ",", "hostAuth", ")", ";", "}", "}", "}", "</s>"]
["<s>", "public", "Bundle", "autoDiscover", "(", "String", "userName", ",", "String", "password", ")", "throws", "RemoteException", "{", "return", "new", "EasSyncService", "(", ")", ".", "tryAutodiscover", "(", "userName", ",", "password", ")", ";", "}", "</s>"]
["<s>", "public", "static", "void", "backupAccounts", "(", "final", "Context", "context", ")", "{", "if", "(", "Email", ".", "DEBUG", ")", "{", "Log", ".", "v", "(", "Email", ".", "LOG_TAG", ",", "\"", "<STR_LIT>", "\"", ")", ";", "}", "new", "Thread", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "synchronized", "(", "AccountBackupRestore", ".", "class", ")", "{", "doBackupAccounts", "(", "context", ",", "Preferences", ".", "getPreferences", "(", "context", ")", ")", ";", "}", "}", "}", ".", "start", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "run", "(", ")", "{", "synchronized", "(", "AccountBackupRestore", ".", "class", ")", "{", "doBackupAccounts", "(", "context", ",", "Preferences", ".", "getPreferences", "(", "context", ")", ")", ";", "}", "}", "</s>"]
["<s>", "public", "static", "void", "restoreAccountsIfNeeded", "(", "final", "Context", "context", ")", "{", "boolean", "restored", ";", "synchronized", "(", "AccountBackupRestore", ".", "class", ")", "{", "restored", "=", "doRestoreAccounts", "(", "context", ",", "Preferences", ".", "getPreferences", "(", "context", ")", ")", ";", "}", "if", "(", "restored", ")", "{", "Log", ".", "w", "(", "Email", ".", "LOG_TAG", ",", "\"", "<STR_LIT>", "\"", ")", ";", "Email", ".", "setServicesEnabled", "(", "context", ")", ";", "context", ".", "startService", "(", "new", "Intent", "(", "context", ".", "getApplicationContext", "(", ")", ",", "com", ".", "android", ".", "exchange", ".", "SyncManager", ".", "class", ")", ")", ";", "}", "}", "</s>"]
["<s>", "static", "void", "doBackupAccounts", "(", "Context", "context", ",", "Preferences", "preferences", ")", "{", "Account", "[", "]", "oldBackups", "=", "preferences", ".", "getAccounts", "(", ")", ";", "for", "(", "Account", "backup", ":", "oldBackups", ")", "{", "backup", ".", "delete", "(", "preferences", ")", ";", "}", "long", "defaultAccountId", "=", "EmailContent", ".", "Account", ".", "getDefaultAccountId", "(", "context", ")", ";", "if", "(", "defaultAccountId", "=", "=", "-", "1", ")", "{", "return", ";", "}", "Cursor", "c", "=", "context", ".", "getContentResolver", "(", ")", ".", "query", "(", "EmailContent", ".", "Account", ".", "CONTENT_URI", ",", "EmailContent", ".", "Account", ".", "CONTENT_PROJECTION", ",", "null", ",", "null", ",", "null", ")", ";", "try", "{", "while", "(", "c", ".", "moveToNext", "(", ")", ")", "{", "EmailContent", ".", "Account", "fromAccount", "=", "EmailContent", ".", "getContent", "(", "c", ",", "EmailContent", ".", "Account", ".", "class", ")", ";", "if", "(", "Email", ".", "DEBUG", ")", "{", "Log", ".", "v", "(", "Email", ".", "LOG_TAG", ",", "\"", "<STR_LIT>", "\"", "+", "fromAccount", ".", "getDisplayName", "(", ")", ")", ";", "}", "Account", "toAccount", "=", "LegacyConversions", ".", "makeLegacyAccount", "(", "context", ",", "fromAccount", ")", ";", "if", "(", "fromAccount", ".", "mHostAuthRecv", ".", "mProtocol", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "android", ".", "accounts", ".", "Account", "acct", "=", "new", "android", ".", "accounts", ".", "Account", "(", "fromAccount", ".", "mEmailAddress", ",", "Eas", ".", "ACCOUNT_MANAGER_TYPE", ")", ";", "boolean", "syncContacts", "=", "ContentResolver", ".", "getSyncAutomatically", "(", "acct", ",", "ContactsContract", ".", "AUTHORITY", ")", ";", "if", "(", "syncContacts", ")", "{", "toAccount", ".", "mBackupFlags", "|", "=", "Account", ".", "BACKUP_FLAGS_SYNC_CONTACTS", ";", "}", "}", "if", "(", "fromAccount", ".", "mId", "=", "=", "defaultAccountId", ")", "{", "toAccount", ".", "mBackupFlags", "|", "=", "Account", ".", "BACKUP_FLAGS_IS_DEFAULT", ";", "}", "toAccount", ".", "mBackupFlags", "|", "=", "Account", ".", "BACKUP_FLAGS_IS_BACKUP", ";", "toAccount", ".", "save", "(", "preferences", ")", ";", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "}", "</s>"]
["<s>", "static", "boolean", "doRestoreAccounts", "(", "Context", "context", ",", "Preferences", "preferences", ")", "{", "boolean", "result", "=", "false", ";", "int", "numAccounts", "=", "EmailContent", ".", "count", "(", "context", ",", "EmailContent", ".", "Account", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ";", "if", "(", "numAccounts", ">", "0", ")", "{", "return", "result", ";", "}", "Account", "[", "]", "backups", "=", "preferences", ".", "getAccounts", "(", ")", ";", "if", "(", "backups", ".", "length", "=", "=", "0", ")", "{", "return", "result", ";", "}", "Log", ".", "w", "(", "Email", ".", "LOG_TAG", ",", "\"", "<STR_LIT>", "\"", "+", "backups", ".", "length", ")", ";", "for", "(", "Account", "backupAccount", ":", "backups", ")", "{", "if", "(", "(", "backupAccount", ".", "mBackupFlags", "&", "Account", ".", "BACKUP_FLAGS_IS_BACKUP", ")", "=", "=", "0", ")", "{", "continue", ";", "}", "Log", ".", "v", "(", "Email", ".", "LOG_TAG", ",", "\"", "<STR_LIT>", "\"", "+", "backupAccount", ".", "getDescription", "(", ")", ")", ";", "EmailContent", ".", "Account", "toAccount", "=", "LegacyConversions", ".", "makeAccount", "(", "context", ",", "backupAccount", ")", ";", "if", "(", "0", "!", "=", "(", "backupAccount", ".", "mBackupFlags", "&", "Account", ".", "BACKUP_FLAGS_IS_DEFAULT", ")", ")", "{", "toAccount", ".", "setDefaultAccount", "(", "true", ")", ";", "}", "if", "(", "toAccount", ".", "mHostAuthRecv", ".", "mProtocol", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "boolean", "alsoSyncContacts", "=", "(", "backupAccount", ".", "mBackupFlags", "&", "Account", ".", "BACKUP_FLAGS_SYNC_CONTACTS", ")", "!", "=", "0", ";", "AccountManagerFuture", "<", "Bundle", ">", "addAccountResult", "=", "ExchangeStore", ".", "addSystemAccount", "(", "context", ".", "getApplicationContext", "(", ")", ",", "toAccount", ",", "alsoSyncContacts", ",", "null", ")", ";", "toAccount", ".", "save", "(", "context", ")", ";", "}", "else", "{", "toAccount", ".", "save", "(", "context", ")", ";", "}", "result", "=", "true", ";", "}", "return", "result", ";", "}", "</s>"]
["<s>", "static", "Account", "makeLegacyAccount", "(", "Context", "context", ",", "EmailContent", ".", "Account", "fromAccount", ")", "{", "Account", "result", "=", "new", "Account", "(", "context", ")", ";", "result", ".", "setDescription", "(", "fromAccount", ".", "getDisplayName", "(", ")", ")", ";", "result", ".", "setEmail", "(", "fromAccount", ".", "getEmailAddress", "(", ")", ")", ";", "result", ".", "setSyncWindow", "(", "fromAccount", ".", "getSyncLookback", "(", ")", ")", ";", "result", ".", "setAutomaticCheckIntervalMinutes", "(", "fromAccount", ".", "getSyncInterval", "(", ")", ")", ";", "result", ".", "setNotifyNewMail", "(", "0", "!", "=", "(", "fromAccount", ".", "getFlags", "(", ")", "&", "EmailContent", ".", "Account", ".", "FLAGS_NOTIFY_NEW_MAIL", ")", ")", ";", "result", ".", "setVibrate", "(", "0", "!", "=", "(", "fromAccount", ".", "getFlags", "(", ")", "&", "EmailContent", ".", "Account", ".", "FLAGS_VIBRATE", ")", ")", ";", "result", ".", "setDeletePolicy", "(", "fromAccount", ".", "getDeletePolicy", "(", ")", ")", ";", "result", ".", "mUuid", "=", "fromAccount", ".", "getUuid", "(", ")", ";", "result", ".", "setName", "(", "fromAccount", ".", "mSenderName", ")", ";", "result", ".", "setRingtone", "(", "fromAccount", ".", "mRingtoneUri", ")", ";", "result", ".", "mProtocolVersion", "=", "fromAccount", ".", "mProtocolVersion", ";", "result", ".", "setStoreUri", "(", "fromAccount", ".", "getStoreUri", "(", "context", ")", ")", ";", "result", ".", "setSenderUri", "(", "fromAccount", ".", "getSenderUri", "(", "context", ")", ")", ";", "return", "result", ";", "}", "</s>"]
["<s>", "static", "EmailContent", ".", "Account", "makeAccount", "(", "Context", "context", ",", "Account", "fromAccount", ")", "{", "EmailContent", ".", "Account", "result", "=", "new", "EmailContent", ".", "Account", "(", ")", ";", "result", ".", "setDisplayName", "(", "fromAccount", ".", "getDescription", "(", ")", ")", ";", "result", ".", "setEmailAddress", "(", "fromAccount", ".", "getEmail", "(", ")", ")", ";", "result", ".", "mSyncKey", "=", "\"", "\"", ";", "result", ".", "setSyncLookback", "(", "fromAccount", ".", "getSyncWindow", "(", ")", ")", ";", "result", ".", "setSyncInterval", "(", "fromAccount", ".", "getAutomaticCheckIntervalMinutes", "(", ")", ")", ";", "int", "flags", "=", "0", ";", "if", "(", "fromAccount", ".", "isNotifyNewMail", "(", ")", ")", "flags", "|", "=", "EmailContent", ".", "Account", ".", "FLAGS_NOTIFY_NEW_MAIL", ";", "if", "(", "fromAccount", ".", "isVibrate", "(", ")", ")", "flags", "|", "=", "EmailContent", ".", "Account", ".", "FLAGS_VIBRATE", ";", "result", ".", "setFlags", "(", "flags", ")", ";", "result", ".", "setDeletePolicy", "(", "fromAccount", ".", "getDeletePolicy", "(", ")", ")", ";", "result", ".", "mCompatibilityUuid", "=", "fromAccount", ".", "getUuid", "(", ")", ";", "result", ".", "setSenderName", "(", "fromAccount", ".", "getName", "(", ")", ")", ";", "result", ".", "setRingtone", "(", "fromAccount", ".", "getRingtone", "(", ")", ")", ";", "result", ".", "mProtocolVersion", "=", "fromAccount", ".", "mProtocolVersion", ";", "result", ".", "mNewMessageCount", "=", "0", ";", "result", ".", "setStoreUri", "(", "context", ",", "fromAccount", ".", "getStoreUri", "(", ")", ")", ";", "result", ".", "setSenderUri", "(", "context", ",", "fromAccount", ".", "getSenderUri", "(", ")", ")", ";", "return", "result", ";", "}", "</s>"]
["<s>", "static", "public", "AccountManagerFuture", "<", "Boolean", ">", "removeSystemAccount", "(", "Context", "context", ",", "Account", "acct", ",", "AccountManagerCallback", "<", "Bundle", ">", "callback", ")", "{", "android", ".", "accounts", ".", "Account", "systemAccount", "=", "new", "android", ".", "accounts", ".", "Account", "(", "acct", ".", "mEmailAddress", ",", "Eas", ".", "ACCOUNT_MANAGER_TYPE", ")", ";", "return", "AccountManager", ".", "get", "(", "context", ")", ".", "removeAccount", "(", "systemAccount", ",", "null", ",", "null", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "void", "setUp", "(", ")", "throws", "Exception", "{", "super", ".", "setUp", "(", ")", ";", "mMockContext", "=", "getMockContext", "(", ")", ";", "mPreferences", "=", "Preferences", ".", "getPreferences", "(", "mContext", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "void", "tearDown", "(", ")", "throws", "Exception", "{", "super", ".", "tearDown", "(", ")", ";", "deleteLegacyAccounts", "(", ")", ";", "}", "</s>"]
["<s>", "private", "void", "deleteLegacyAccounts", "(", ")", "{", "Account", "[", "]", "oldAccounts", "=", "mPreferences", ".", "getAccounts", "(", ")", ";", "for", "(", "Account", "oldAccount", ":", "oldAccounts", ")", "{", "oldAccount", ".", "delete", "(", "mPreferences", ")", ";", "}", "}", "</s>"]
["<s>", "public", "void", "testNoAccountBackup", "(", ")", "{", "Account", "backupAccount", "=", "new", "Account", "(", "mMockContext", ")", ";", "backupAccount", ".", "save", "(", "mPreferences", ")", ";", "Account", "[", "]", "oldBackups", "=", "mPreferences", ".", "getAccounts", "(", ")", ";", "assertTrue", "(", "oldBackups", ".", "length", ">", "=", "1", ")", ";", "int", "numAccounts", "=", "EmailContent", ".", "count", "(", "mMockContext", ",", "EmailContent", ".", "Account", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ";", "assertEquals", "(", "0", ",", "numAccounts", ")", ";", "AccountBackupRestore", ".", "doBackupAccounts", "(", "mMockContext", ",", "mPreferences", ")", ";", "Account", "[", "]", "backups", "=", "mPreferences", ".", "getAccounts", "(", ")", ";", "assertEquals", "(", "0", ",", "backups", ".", "length", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testBackup", "(", ")", "{", "deleteLegacyAccounts", "(", ")", ";", "EmailContent", ".", "Account", "liveAccount1", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "false", ",", "mMockContext", ")", ";", "liveAccount1", ".", "mHostAuthRecv", "=", "ProviderTestUtils", ".", "setupHostAuth", "(", "\"", "<STR_LIT>", "\"", ",", "0", ",", "false", ",", "mMockContext", ")", ";", "liveAccount1", ".", "mHostAuthSend", "=", "ProviderTestUtils", ".", "setupHostAuth", "(", "\"", "<STR_LIT>", "\"", ",", "0", ",", "false", ",", "mMockContext", ")", ";", "liveAccount1", ".", "setDefaultAccount", "(", "true", ")", ";", "liveAccount1", ".", "save", "(", "mMockContext", ")", ";", "EmailContent", ".", "Account", "liveAccount2", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "false", ",", "mMockContext", ")", ";", "liveAccount2", ".", "mHostAuthRecv", "=", "ProviderTestUtils", ".", "setupHostAuth", "(", "\"", "<STR_LIT>", "\"", ",", "0", ",", "false", ",", "mMockContext", ")", ";", "liveAccount2", ".", "mHostAuthSend", "=", "ProviderTestUtils", ".", "setupHostAuth", "(", "\"", "<STR_LIT>", "\"", ",", "0", ",", "false", ",", "mMockContext", ")", ";", "liveAccount2", ".", "setDefaultAccount", "(", "false", ")", ";", "liveAccount2", ".", "save", "(", "mMockContext", ")", ";", "AccountBackupRestore", ".", "doBackupAccounts", "(", "mMockContext", ",", "mPreferences", ")", ";", "Account", "[", "]", "backups", "=", "mPreferences", ".", "getAccounts", "(", ")", ";", "assertEquals", "(", "<NUM_LIT:2>", ",", "backups", ".", "length", ")", ";", "for", "(", "Account", "backup", ":", "backups", ")", "{", "if", "(", "\"", "<STR_LIT>", "\"", ".", "equals", "(", "backup", ".", "getDescription", "(", ")", ")", ")", "{", "assertTrue", "(", "0", "!", "=", "(", "backup", ".", "mBackupFlags", "&", "Account", ".", "BACKUP_FLAGS_IS_DEFAULT", ")", ")", ";", "}", "else", "if", "(", "\"", "<STR_LIT>", "\"", ".", "equals", "(", "backup", ".", "getDescription", "(", ")", ")", ")", "{", "assertFalse", "(", "0", "!", "=", "(", "backup", ".", "mBackupFlags", "&", "Account", ".", "BACKUP_FLAGS_IS_DEFAULT", ")", ")", ";", "}", "else", "{", "fail", "(", "\"", "<STR_LIT>", "\"", "+", "backup", ".", "getDescription", "(", ")", ")", ";", "}", "}", "Account", "backup1", "=", "backups", "[", "0", "]", ";", "assertTrue", "(", "0", "!", "=", "(", "backup1", ".", "mBackupFlags", "&", "Account", ".", "BACKUP_FLAGS_IS_BACKUP", ")", ")", ";", "assertEquals", "(", "liveAccount1", ".", "getDisplayName", "(", ")", ",", "backup1", ".", "getDescription", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testNoAccountRestore1", "(", ")", "{", "deleteLegacyAccounts", "(", ")", ";", "Account", "backupAccount1", "=", "setupLegacyBackupAccount", "(", "\"", "<STR_LIT:1>", "\"", ")", ";", "backupAccount1", ".", "save", "(", "mPreferences", ")", ";", "Account", "backupAccount2", "=", "setupLegacyBackupAccount", "(", "\"", "<STR_LIT:2>", "\"", ")", ";", "backupAccount2", ".", "save", "(", "mPreferences", ")", ";", "EmailContent", ".", "Account", "existing", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "true", ",", "mMockContext", ")", ";", "boolean", "anyRestored", "=", "AccountBackupRestore", ".", "doRestoreAccounts", "(", "mMockContext", ",", "mPreferences", ")", ";", "assertFalse", "(", "anyRestored", ")", ";", "int", "numAccounts", "=", "EmailContent", ".", "count", "(", "mMockContext", ",", "EmailContent", ".", "Account", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ";", "assertEquals", "(", "1", ",", "numAccounts", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testNoAccountRestore2", "(", ")", "{", "deleteLegacyAccounts", "(", ")", ";", "int", "numAccounts", "=", "EmailContent", ".", "count", "(", "mMockContext", ",", "EmailContent", ".", "Account", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ";", "assertEquals", "(", "0", ",", "numAccounts", ")", ";", "boolean", "anyRestored", "=", "AccountBackupRestore", ".", "doRestoreAccounts", "(", "mMockContext", ",", "mPreferences", ")", ";", "assertFalse", "(", "anyRestored", ")", ";", "numAccounts", "=", "EmailContent", ".", "count", "(", "mMockContext", ",", "EmailContent", ".", "Account", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ";", "assertEquals", "(", "0", ",", "numAccounts", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testAccountRestore", "(", ")", "{", "deleteLegacyAccounts", "(", ")", ";", "Account", "backupAccount1", "=", "setupLegacyBackupAccount", "(", "\"", "<STR_LIT:1>", "\"", ")", ";", "backupAccount1", ".", "mBackupFlags", "|", "=", "Account", ".", "BACKUP_FLAGS_IS_DEFAULT", ";", "backupAccount1", ".", "save", "(", "mPreferences", ")", ";", "Account", "backupAccount2", "=", "setupLegacyBackupAccount", "(", "\"", "<STR_LIT:2>", "\"", ")", ";", "backupAccount2", ".", "save", "(", "mPreferences", ")", ";", "boolean", "anyRestored", "=", "AccountBackupRestore", ".", "doRestoreAccounts", "(", "mMockContext", ",", "mPreferences", ")", ";", "assertTrue", "(", "anyRestored", ")", ";", "Cursor", "c", "=", "mMockContext", ".", "getContentResolver", "(", ")", ".", "query", "(", "EmailContent", ".", "Account", ".", "CONTENT_URI", ",", "EmailContent", ".", "Account", ".", "CONTENT_PROJECTION", ",", "null", ",", "null", ",", "null", ")", ";", "try", "{", "assertEquals", "(", "<NUM_LIT:2>", ",", "c", ".", "getCount", "(", ")", ")", ";", "while", "(", "c", ".", "moveToNext", "(", ")", ")", "{", "EmailContent", ".", "Account", "restored", "=", "EmailContent", ".", "getContent", "(", "c", ",", "EmailContent", ".", "Account", ".", "class", ")", ";", "if", "(", "\"", "<STR_LIT:1>", "\"", ".", "equals", "(", "restored", ".", "getDisplayName", "(", ")", ")", ")", "{", "assertTrue", "(", "restored", ".", "mIsDefault", ")", ";", "}", "else", "if", "(", "\"", "<STR_LIT:2>", "\"", ".", "equals", "(", "restored", ".", "getDisplayName", "(", ")", ")", ")", "{", "assertFalse", "(", "restored", ".", "mIsDefault", ")", ";", "}", "else", "{", "fail", "(", "\"", "<STR_LIT>", "\"", "+", "restored", ".", "getDisplayName", "(", ")", ")", ";", "}", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "deleteLegacyAccounts", "(", ")", ";", "mMockContext", ".", "getContentResolver", "(", ")", ".", "delete", "(", "EmailContent", ".", "Account", ".", "CONTENT_URI", ",", "null", ",", "null", ")", ";", "Account", "backupAccount3", "=", "setupLegacyBackupAccount", "(", "\"", "<STR_LIT:3>", "\"", ")", ";", "backupAccount3", ".", "save", "(", "mPreferences", ")", ";", "Account", "backupAccount4", "=", "setupLegacyBackupAccount", "(", "\"", "<STR_LIT:4>", "\"", ")", ";", "backupAccount4", ".", "mBackupFlags", "|", "=", "Account", ".", "BACKUP_FLAGS_IS_DEFAULT", ";", "backupAccount4", ".", "save", "(", "mPreferences", ")", ";", "AccountBackupRestore", ".", "doRestoreAccounts", "(", "mMockContext", ",", "mPreferences", ")", ";", "c", "=", "mMockContext", ".", "getContentResolver", "(", ")", ".", "query", "(", "EmailContent", ".", "Account", ".", "CONTENT_URI", ",", "EmailContent", ".", "Account", ".", "CONTENT_PROJECTION", ",", "null", ",", "null", ",", "null", ")", ";", "try", "{", "assertEquals", "(", "<NUM_LIT:2>", ",", "c", ".", "getCount", "(", ")", ")", ";", "while", "(", "c", ".", "moveToNext", "(", ")", ")", "{", "EmailContent", ".", "Account", "restored", "=", "EmailContent", ".", "getContent", "(", "c", ",", "EmailContent", ".", "Account", ".", "class", ")", ";", "if", "(", "\"", "<STR_LIT:3>", "\"", ".", "equals", "(", "restored", ".", "getDisplayName", "(", ")", ")", ")", "{", "assertFalse", "(", "restored", ".", "mIsDefault", ")", ";", "}", "else", "if", "(", "\"", "<STR_LIT:4>", "\"", ".", "equals", "(", "restored", ".", "getDisplayName", "(", ")", ")", ")", "{", "assertTrue", "(", "restored", ".", "mIsDefault", ")", ";", "}", "else", "{", "fail", "(", "\"", "<STR_LIT>", "\"", "+", "restored", ".", "getDisplayName", "(", ")", ")", ";", "}", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "}", "</s>"]
["<s>", "private", "Account", "setupLegacyBackupAccount", "(", "String", "name", ")", "{", "Account", "backup", "=", "new", "Account", "(", "mMockContext", ")", ";", "backup", ".", "mUuid", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "backup", ".", "mStoreUri", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "backup", ".", "mLocalStoreUri", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "backup", ".", "mSenderUri", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "backup", ".", "mDescription", "=", "name", ";", "backup", ".", "mName", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "backup", ".", "mEmail", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "backup", ".", "mAutomaticCheckIntervalMinutes", "=", "<NUM_LIT:100>", ";", "backup", ".", "mLastAutomaticCheckTime", "=", "<NUM_LIT>", ";", "backup", ".", "mNotifyNewMail", "=", "true", ";", "backup", ".", "mDraftsFolderName", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "backup", ".", "mSentFolderName", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "backup", ".", "mTrashFolderName", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "backup", ".", "mOutboxFolderName", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "backup", ".", "mAccountNumber", "=", "<NUM_LIT>", ";", "backup", ".", "mVibrate", "=", "true", ";", "backup", ".", "mRingtoneUri", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "backup", ".", "mSyncWindow", "=", "<NUM_LIT>", ";", "backup", ".", "mBackupFlags", "=", "Account", ".", "BACKUP_FLAGS_IS_BACKUP", ";", "backup", ".", "mProtocolVersion", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "backup", ".", "mDeletePolicy", "=", "Account", ".", "DELETE_POLICY_NEVER", ";", "return", "backup", ";", "}", "</s>"]
["<s>", "public", "void", "testFlagsField", "(", ")", "{", "createTestAccount", "(", ")", ";", "assertEquals", "(", "0", ",", "mAccount", ".", "mBackupFlags", ")", ";", "mAccount", ".", "save", "(", "mPreferences", ")", ";", "mAccount", ".", "mBackupFlags", "=", "-", "1", ";", "mAccount", ".", "refresh", "(", "mPreferences", ")", ";", "assertEquals", "(", "0", ",", "mAccount", ".", "mBackupFlags", ")", ";", "mAccount", ".", "mBackupFlags", "=", "Account", ".", "BACKUP_FLAGS_IS_BACKUP", ";", "mAccount", ".", "save", "(", "mPreferences", ")", ";", "mAccount", ".", "mBackupFlags", "=", "-", "1", ";", "mAccount", ".", "refresh", "(", "mPreferences", ")", ";", "assertEquals", "(", "Account", ".", "BACKUP_FLAGS_IS_BACKUP", ",", "mAccount", ".", "mBackupFlags", ")", ";", "mAccount", ".", "mBackupFlags", "=", "Account", ".", "BACKUP_FLAGS_SYNC_CONTACTS", ";", "mAccount", ".", "save", "(", "mPreferences", ")", ";", "mAccount", ".", "mBackupFlags", "=", "-", "1", ";", "mAccount", ".", "refresh", "(", "mPreferences", ")", ";", "assertEquals", "(", "Account", ".", "BACKUP_FLAGS_SYNC_CONTACTS", ",", "mAccount", ".", "mBackupFlags", ")", ";", "mAccount", ".", "mBackupFlags", "=", "Account", ".", "BACKUP_FLAGS_IS_DEFAULT", ";", "mAccount", ".", "save", "(", "mPreferences", ")", ";", "mAccount", ".", "mBackupFlags", "=", "-", "1", ";", "mAccount", ".", "refresh", "(", "mPreferences", ")", ";", "assertEquals", "(", "Account", ".", "BACKUP_FLAGS_IS_DEFAULT", ",", "mAccount", ".", "mBackupFlags", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testMakeProviderAccount", "(", ")", "throws", "MessagingException", "{", "setupLegacyAccount", "(", "\"", "<STR_LIT>", "\"", ",", "true", ")", ";", "EmailContent", ".", "Account", "toAccount", "=", "LegacyConversions", ".", "makeAccount", "(", "mProviderContext", ",", "mLegacyAccount", ")", ";", "checkProviderAccount", "(", "\"", "<STR_LIT>", "\"", ",", "mLegacyAccount", ",", "toAccount", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testMakeLegacyAccount", "(", ")", "throws", "MessagingException", "{", "EmailContent", ".", "Account", "fromAccount", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "false", ",", "mProviderContext", ")", ";", "fromAccount", ".", "mHostAuthRecv", "=", "ProviderTestUtils", ".", "setupHostAuth", "(", "\"", "<STR_LIT>", "\"", ",", "0", ",", "false", ",", "mProviderContext", ")", ";", "fromAccount", ".", "mHostAuthSend", "=", "ProviderTestUtils", ".", "setupHostAuth", "(", "\"", "<STR_LIT>", "\"", ",", "0", ",", "false", ",", "mProviderContext", ")", ";", "fromAccount", ".", "save", "(", "mProviderContext", ")", ";", "Account", "toAccount", "=", "LegacyConversions", ".", "makeLegacyAccount", "(", "mProviderContext", ",", "fromAccount", ")", ";", "checkLegacyAccount", "(", "\"", "<STR_LIT>", "\"", ",", "fromAccount", ",", "toAccount", ")", ";", "}", "</s>"]
["<s>", "private", "void", "setupLegacyAccount", "(", "String", "name", ",", "boolean", "saveIt", ")", "{", "mPreferences", "=", "Preferences", ".", "getPreferences", "(", "mProviderContext", ")", ";", "mLegacyAccount", "=", "new", "Account", "(", "mProviderContext", ")", ";", "mLegacyAccount", ".", "mUuid", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "mLegacyAccount", ".", "mStoreUri", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "mLegacyAccount", ".", "mLocalStoreUri", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "mLegacyAccount", ".", "mSenderUri", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "mLegacyAccount", ".", "mDescription", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "mLegacyAccount", ".", "mName", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "mLegacyAccount", ".", "mEmail", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "mLegacyAccount", ".", "mAutomaticCheckIntervalMinutes", "=", "<NUM_LIT:100>", ";", "mLegacyAccount", ".", "mLastAutomaticCheckTime", "=", "<NUM_LIT>", ";", "mLegacyAccount", ".", "mNotifyNewMail", "=", "true", ";", "mLegacyAccount", ".", "mDraftsFolderName", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "mLegacyAccount", ".", "mSentFolderName", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "mLegacyAccount", ".", "mTrashFolderName", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "mLegacyAccount", ".", "mOutboxFolderName", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "mLegacyAccount", ".", "mAccountNumber", "=", "<NUM_LIT>", ";", "mLegacyAccount", ".", "mVibrate", "=", "true", ";", "mLegacyAccount", ".", "mRingtoneUri", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "mLegacyAccount", ".", "mSyncWindow", "=", "<NUM_LIT>", ";", "mLegacyAccount", ".", "mBackupFlags", "=", "0", ";", "mLegacyAccount", ".", "mDeletePolicy", "=", "Account", ".", "DELETE_POLICY_NEVER", ";", "if", "(", "saveIt", ")", "{", "mLegacyAccount", ".", "save", "(", "mPreferences", ")", ";", "}", "}", "</s>"]
["<s>", "private", "void", "checkProviderAccount", "(", "String", "tag", ",", "Account", "expect", ",", "EmailContent", ".", "Account", "actual", ")", "throws", "MessagingException", "{", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getDescription", "(", ")", ",", "actual", ".", "mDisplayName", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getEmail", "(", ")", ",", "actual", ".", "mEmailAddress", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "\"", "\"", ",", "actual", ".", "mSyncKey", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getSyncWindow", "(", ")", ",", "actual", ".", "mSyncLookback", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getAutomaticCheckIntervalMinutes", "(", ")", ",", "actual", ".", "mSyncInterval", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getStoreUri", "(", ")", ",", "actual", ".", "getStoreUri", "(", "mProviderContext", ")", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getSenderUri", "(", ")", ",", "actual", ".", "getSenderUri", "(", "mProviderContext", ")", ")", ";", "int", "expectFlags", "=", "0", ";", "if", "(", "expect", ".", "mNotifyNewMail", ")", "expectFlags", "|", "=", "EmailContent", ".", "Account", ".", "FLAGS_NOTIFY_NEW_MAIL", ";", "if", "(", "expect", ".", "mVibrate", ")", "expectFlags", "|", "=", "EmailContent", ".", "Account", ".", "FLAGS_VIBRATE", ";", "expectFlags", "|", "=", "(", "expect", ".", "mDeletePolicy", "<", "<", "EmailContent", ".", "Account", ".", "FLAGS_DELETE_POLICY_SHIFT", ")", "&", "EmailContent", ".", "Account", ".", "FLAGS_DELETE_POLICY_MASK", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expectFlags", ",", "actual", ".", "mFlags", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "false", ",", "actual", ".", "mIsDefault", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getUuid", "(", ")", ",", "actual", ".", "mCompatibilityUuid", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getName", "(", ")", ",", "actual", ".", "mSenderName", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getRingtone", "(", ")", ",", "actual", ".", "mRingtoneUri", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "mProtocolVersion", ",", "actual", ".", "mProtocolVersion", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "0", ",", "actual", ".", "mNewMessageCount", ")", ";", "}", "</s>"]
["<s>", "private", "void", "checkLegacyAccount", "(", "String", "tag", ",", "EmailContent", ".", "Account", "expect", ",", "Account", "actual", ")", "throws", "MessagingException", "{", "int", "expectFlags", "=", "expect", ".", "getFlags", "(", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "mCompatibilityUuid", ",", "actual", ".", "mUuid", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getStoreUri", "(", "mProviderContext", ")", ",", "actual", ".", "mStoreUri", ")", ";", "assertTrue", "(", "actual", ".", "mLocalStoreUri", ".", "startsWith", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getSenderUri", "(", "mProviderContext", ")", ",", "actual", ".", "mSenderUri", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getDisplayName", "(", ")", ",", "actual", ".", "mDescription", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getSenderName", "(", ")", ",", "actual", ".", "mName", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getEmailAddress", "(", ")", ",", "actual", ".", "mEmail", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getSyncInterval", "(", ")", ",", "actual", ".", "mAutomaticCheckIntervalMinutes", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "0", ",", "actual", ".", "mLastAutomaticCheckTime", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "(", "expectFlags", "&", "EmailContent", ".", "Account", ".", "FLAGS_NOTIFY_NEW_MAIL", ")", "!", "=", "0", ",", "actual", ".", "mNotifyNewMail", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "null", ",", "actual", ".", "mDraftsFolderName", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "null", ",", "actual", ".", "mSentFolderName", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "null", ",", "actual", ".", "mTrashFolderName", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "null", ",", "actual", ".", "mOutboxFolderName", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "-", "1", ",", "actual", ".", "mAccountNumber", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "(", "expectFlags", "&", "EmailContent", ".", "Account", ".", "FLAGS_VIBRATE", ")", "!", "=", "0", ",", "actual", ".", "mVibrate", ")", ";", "assertEquals", "(", "tag", "+", "\"", "\"", ",", "expect", ".", "getRingtone", "(", ")", ",", "actual", ".", "mRingtoneUri", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getSyncLookback", "(", ")", ",", "actual", ".", "mSyncWindow", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "0", ",", "actual", ".", "mBackupFlags", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "mProtocolVersion", ",", "actual", ".", "mProtocolVersion", ")", ";", "assertEquals", "(", "tag", "+", "\"", "<STR_LIT>", "\"", ",", "expect", ".", "getDeletePolicy", "(", ")", ",", "actual", ".", "getDeletePolicy", "(", ")", ")", ";", "}", "</s>"]
["<s>", "private", "void", "checkRestoredTransientValues", "(", "EmailContent", ".", "Account", "restored", ")", "{", "assertNull", "(", "restored", ".", "mSyncKey", ")", ";", "assertTrue", "(", "restored", ".", "mHostAuthKeyRecv", ">", "0", ")", ";", "assertTrue", "(", "restored", ".", "mHostAuthKeySend", ">", "0", ")", ";", "assertTrue", "(", "restored", ".", "mProtocolVersion", "=", "=", "null", "|", "|", "restored", ".", "mProtocolVersion", ".", "length", "(", ")", ">", "0", ")", ";", "}", "</s>"]
["<s>", "private", "void", "setAccount", "(", "Account", "account", ")", "{", "mAccount", "=", "account", ";", "if", "(", "account", "!", "=", "null", ")", "{", "mRightTitle", ".", "setText", "(", "account", ".", "mDisplayName", ")", ";", "}", "}", "</s>"]
["<s>", "public", "void", "testWhiteSpace", "(", ")", "throws", "MessagingException", ",", "IOException", "{", "String", "entireMessage", "=", "\"", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", ";", "MimeMessage", "mm", "=", "null", ";", "mm", "=", "new", "MimeMessage", "(", "new", "ByteArrayInputStream", "(", "entireMessage", ".", "getBytes", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "assertTrue", "(", "mm", ".", "getMimeType", "(", ")", ",", "MimeUtility", ".", "mimeTypeMatches", "(", "\"", "<STR_LIT>", "\"", ",", "mm", ".", "getMimeType", "(", ")", ")", ")", ";", "assertEquals", "(", "new", "Date", "(", "-", "<NUM_LIT>", ")", ",", "mm", ".", "getSentDate", "(", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "mm", ".", "getMessageId", "(", ")", ")", ";", "Address", "[", "]", "toAddresses", "=", "mm", ".", "getRecipients", "(", "MimeMessage", ".", "RecipientType", ".", "TO", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "toAddresses", "[", "1", "]", ".", "getAddress", "(", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "toAddresses", "[", "<NUM_LIT:2>", "]", ".", "getAddress", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testContentTypeCharset", "(", ")", "throws", "MessagingException", "{", "final", "String", "UNICODE_EXPECT", "=", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", ";", "final", "String", "WINDOWS1252_EXPECT", "=", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", ";", "TextBody", "tb", "=", "new", "TextBody", "(", "UNICODE_EXPECT", ")", ";", "MimeBodyPart", "p", "=", "new", "MimeBodyPart", "(", ")", ";", "String", "gotText", ",", "mimeType", ",", "charset", ";", "p", ".", "setBody", "(", "tb", ")", ";", "p", ".", "setHeader", "(", "MimeHeader", ".", "HEADER_CONTENT_TYPE", ",", "\"", "<STR_LIT>", "\"", ")", ";", "gotText", "=", "MimeUtility", ".", "getTextFromPart", "(", "p", ")", ";", "assertTrue", "(", "MimeUtility", ".", "mimeTypeMatches", "(", "p", ".", "getMimeType", "(", ")", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "UNICODE_EXPECT", ",", "gotText", ")", ";", "p", ".", "setBody", "(", "tb", ")", ";", "p", ".", "setHeader", "(", "MimeHeader", ".", "HEADER_CONTENT_TYPE", ",", "\"", "<STR_LIT>", "\"", ")", ";", "gotText", "=", "MimeUtility", ".", "getTextFromPart", "(", "p", ")", ";", "assertTrue", "(", "MimeUtility", ".", "mimeTypeMatches", "(", "p", ".", "getMimeType", "(", ")", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "WINDOWS1252_EXPECT", ",", "gotText", ")", ";", "p", ".", "setBody", "(", "tb", ")", ";", "p", ".", "setHeader", "(", "MimeHeader", ".", "HEADER_CONTENT_TYPE", ",", "\"", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "\"", ")", ";", "gotText", "=", "MimeUtility", ".", "getTextFromPart", "(", "p", ")", ";", "assertTrue", "(", "MimeUtility", ".", "mimeTypeMatches", "(", "p", ".", "getMimeType", "(", ")", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "UNICODE_EXPECT", ",", "gotText", ")", ";", "p", ".", "setBody", "(", "tb", ")", ";", "p", ".", "setHeader", "(", "MimeHeader", ".", "HEADER_CONTENT_TYPE", ",", "\"", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "\"", ")", ";", "gotText", "=", "MimeUtility", ".", "getTextFromPart", "(", "p", ")", ";", "assertTrue", "(", "MimeUtility", ".", "mimeTypeMatches", "(", "p", ".", "getMimeType", "(", ")", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "WINDOWS1252_EXPECT", ",", "gotText", ")", ";", "p", ".", "setBody", "(", "tb", ")", ";", "p", ".", "setHeader", "(", "MimeHeader", ".", "HEADER_CONTENT_TYPE", ",", "\"", "<STR_LIT>", "\"", ")", ";", "gotText", "=", "MimeUtility", ".", "getTextFromPart", "(", "p", ")", ";", "assertTrue", "(", "MimeUtility", ".", "mimeTypeMatches", "(", "p", ".", "getMimeType", "(", ")", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "UNICODE_EXPECT", ",", "gotText", ")", ";", "p", ".", "setBody", "(", "tb", ")", ";", "p", ".", "setHeader", "(", "MimeHeader", ".", "HEADER_CONTENT_TYPE", ",", "\"", "<STR_LIT>", "\"", ")", ";", "gotText", "=", "MimeUtility", ".", "getTextFromPart", "(", "p", ")", ";", "assertTrue", "(", "MimeUtility", ".", "mimeTypeMatches", "(", "p", ".", "getMimeType", "(", ")", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "WINDOWS1252_EXPECT", ",", "gotText", ")", ";", "p", ".", "setBody", "(", "tb", ")", ";", "p", ".", "setHeader", "(", "MimeHeader", ".", "HEADER_CONTENT_TYPE", ",", "\"", "<STR_LIT>", "\"", ")", ";", "gotText", "=", "MimeUtility", ".", "getTextFromPart", "(", "p", ")", ";", "assertTrue", "(", "MimeUtility", ".", "mimeTypeMatches", "(", "p", ".", "getMimeType", "(", ")", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "p", ".", "setBody", "(", "tb", ")", ";", "p", ".", "setHeader", "(", "MimeHeader", ".", "HEADER_CONTENT_TYPE", ",", "\"", "<STR_LIT>", "\"", ")", ";", "gotText", "=", "MimeUtility", ".", "getTextFromPart", "(", "p", ")", ";", "assertTrue", "(", "MimeUtility", ".", "mimeTypeMatches", "(", "p", ".", "getMimeType", "(", ")", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "</s>"]
["<s>", "public", "String", "getImapId", "(", "Context", "context", ")", "{", "synchronized", "(", "Email", ".", "class", ")", "{", "if", "(", "sImapId", "=", "=", "null", ")", "{", "StringBuffer", "sb", "=", "new", "StringBuffer", "(", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "\"", ")", ";", "sb", ".", "append", "(", "context", ".", "getPackageName", "(", ")", ")", ";", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "\"", ")", ";", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "\"", ")", ";", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "\"", ")", ";", "final", "String", "version", "=", "Build", ".", "VERSION", ".", "RELEASE", ";", "if", "(", "version", ".", "length", "(", ")", ">", "0", ")", "{", "sb", ".", "append", "(", "version", ")", ";", "}", "else", "{", "sb", ".", "append", "(", "\"", "<STR_LIT:1.0>", "\"", ")", ";", "}", "if", "(", "\"", "<STR_LIT>", "\"", ".", "equals", "(", "Build", ".", "VERSION", ".", "CODENAME", ")", ")", "{", "final", "String", "model", "=", "Build", ".", "MODEL", ";", "if", "(", "model", ".", "length", "(", ")", ">", "0", ")", "{", "sb", ".", "append", "(", "\"", "<STR_LIT>", "\"", ")", ";", "sb", ".", "append", "(", "model", ")", ";", "}", "}", "final", "String", "id", "=", "Build", ".", "ID", ";", "if", "(", "id", ".", "length", "(", ")", ">", "0", ")", "{", "sb", ".", "append", "(", "\"", "<STR_LIT>", "\"", ")", ";", "sb", ".", "append", "(", "id", ")", ";", "}", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "\"", ")", ";", "final", "String", "vendor", "=", "Build", ".", "MANUFACTURER", ";", "if", "(", "vendor", ".", "length", "(", ")", ">", "0", ")", "{", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "\"", ")", ";", "sb", ".", "append", "(", "vendor", ")", ";", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "\"", ")", ";", "}", "sImapId", "=", "sb", ".", "toString", "(", ")", ";", "}", "}", "return", "sImapId", ";", "}", "</s>"]
["<s>", "public", "void", "testImapId", "(", ")", "{", "String", "id", "=", "mStore", ".", "getImapId", "(", "getContext", "(", ")", ")", ";", "String", "[", "]", "elements", "=", "id", ".", "split", "(", "\"", "<STR_LIT:\\\">", "\"", ")", ";", "HashMap", "<", "String", ",", "String", ">", "map", "=", "new", "HashMap", "<", "String", ",", "String", ">", "(", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "elements", ".", "length", ";", ")", "{", "map", ".", "put", "(", "elements", "[", "i", "+", "1", "]", ",", "elements", "[", "i", "+", "<NUM_LIT:3>", "]", ")", ";", "i", "+", "=", "<NUM_LIT:4>", ";", "}", "String", "name", "=", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ";", "assertEquals", "(", "getContext", "(", ")", ".", "getPackageName", "(", ")", ",", "name", ")", ";", "String", "os", "=", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "os", ")", ";", "String", "osversion", "=", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ";", "assertNotNull", "(", "osversion", ")", ";", "String", "vendor", "=", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ";", "assertNotNull", "(", "vendor", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testServerId", "(", ")", "throws", "MessagingException", "{", "MockTransport", "mockTransport", "=", "openAndInjectMockTransport", "(", ")", ";", "setupOpenFolder", "(", "mockTransport", ",", "new", "String", "[", "]", "{", "\"", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "\"", "+", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "\"", "+", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:)>", "\"", ",", "\"", "<STR_LIT>", "\"", "}", ")", ";", "mFolder", ".", "open", "(", "OpenMode", ".", "READ_WRITE", ",", "null", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testImapIdOkParsing", "(", ")", "throws", "MessagingException", "{", "MockTransport", "mockTransport", "=", "openAndInjectMockTransport", "(", ")", ";", "setupOpenFolder", "(", "mockTransport", ",", "new", "String", "[", "]", "{", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", "}", ")", ";", "mFolder", ".", "open", "(", "OpenMode", ".", "READ_WRITE", ",", "null", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testImapIdBad", "(", ")", "throws", "MessagingException", "{", "MockTransport", "mockTransport", "=", "openAndInjectMockTransport", "(", ")", ";", "setupOpenFolder", "(", "mockTransport", ",", "new", "String", "[", "]", "{", "\"", "<STR_LIT>", "\"", "}", ")", ";", "mFolder", ".", "open", "(", "OpenMode", ".", "READ_WRITE", ",", "null", ")", ";", "}", "</s>"]
["<s>", "private", "void", "setupOpenFolder", "(", "MockTransport", "mockTransport", ",", "String", "[", "]", "imapIdResponse", ")", "{", "mockTransport", ".", "expect", "(", "null", ",", "\"", "<STR_LIT>", "\"", ")", ";", "mockTransport", ".", "expect", "(", "\"", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT:)>", "\"", ",", "imapIdResponse", ")", ";", "mockTransport", ".", "expect", "(", "\"", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "mockTransport", ".", "expect", "(", "\"", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "\"", ",", "new", "String", "[", "]", "{", "\"", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", "}", ")", ";", "}", "</s>"]
["<s>", "public", "void", "sendMeetingResponse", "(", "final", "long", "messageId", ",", "final", "int", "response", ",", "final", "Result", "callback", ")", "{", "IEmailService", "service", "=", "getServiceForMessage", "(", "messageId", ")", ";", "if", "(", "service", "!", "=", "null", ")", "{", "try", "{", "service", ".", "sendMeetingResponse", "(", "messageId", ",", "response", ")", ";", "}", "catch", "(", "RemoteException", "e", ")", "{", "Log", ".", "e", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "e", ")", ";", "}", "}", "}", "</s>"]
["<s>", "private", "void", "onAccept", "(", ")", "{", "mController", ".", "sendMeetingResponse", "(", "mMessageId", ",", "EmailServiceConstants", ".", "MEETING_REQUEST_ACCEPTED", ",", "mControllerCallback", ")", ";", "}", "</s>"]
["<s>", "public", "void", "sendMeetingResponse", "(", "final", "long", "messageId", ",", "final", "int", "response", ")", "throws", "RemoteException", "{", "setTask", "(", "new", "Runnable", "(", ")", "{", "public", "void", "run", "(", ")", "{", "try", "{", "if", "(", "mCallback", "!", "=", "null", ")", "mService", ".", "setCallback", "(", "mCallback", ")", ";", "mService", ".", "sendMeetingResponse", "(", "messageId", ",", "response", ")", ";", "}", "catch", "(", "RemoteException", "e", ")", "{", "}", "}", "}", ")", ";", "}", "</s>"]
["<s>", "public", "void", "addRequest", "(", "Request", "req", ")", "{", "synchronized", "(", "mRequests", ")", "{", "mRequests", ".", "add", "(", "req", ")", ";", "mRequestTime", "=", "System", ".", "currentTimeMillis", "(", ")", ";", "}", "}", "</s>"]
["<s>", "public", "void", "removeRequest", "(", "Request", "req", ")", "{", "synchronized", "(", "mRequests", ")", "{", "mRequests", ".", "remove", "(", "req", ")", ";", "}", "}", "</s>"]
["<s>", "protected", "void", "sendMeetingResponse", "(", "MeetingResponseRequest", "req", ")", "throws", "IOException", "{", "Message", "msg", "=", "Message", ".", "restoreMessageWithId", "(", "mContext", ",", "req", ".", "mMessageId", ")", ";", "Serializer", "s", "=", "new", "Serializer", "(", ")", ";", "s", ".", "start", "(", "Tags", ".", "MREQ_MEETING_RESPONSE", ")", ".", "start", "(", "Tags", ".", "MREQ_REQUEST", ")", ";", "s", ".", "data", "(", "Tags", ".", "MREQ_USER_RESPONSE", ",", "Integer", ".", "toString", "(", "req", ".", "mResponse", ")", ")", ";", "s", ".", "data", "(", "Tags", ".", "MREQ_COLLECTION_ID", ",", "Long", ".", "toString", "(", "msg", ".", "mMailboxKey", ")", ")", ";", "s", ".", "data", "(", "Tags", ".", "MREQ_REQ_ID", ",", "msg", ".", "mServerId", ")", ";", "s", ".", "end", "(", ")", ".", "end", "(", ")", ".", "done", "(", ")", ";", "HttpResponse", "res", "=", "sendHttpClientPost", "(", "\"", "<STR_LIT>", "\"", ",", "s", ".", "toByteArray", "(", ")", ")", ";", "int", "status", "=", "res", ".", "getStatusLine", "(", ")", ".", "getStatusCode", "(", ")", ";", "if", "(", "status", "=", "=", "HttpStatus", ".", "SC_OK", ")", "{", "HttpEntity", "e", "=", "res", ".", "getEntity", "(", ")", ";", "int", "len", "=", "(", "int", ")", "e", ".", "getContentLength", "(", ")", ";", "InputStream", "is", "=", "res", ".", "getEntity", "(", ")", ".", "getContent", "(", ")", ";", "if", "(", "len", "!", "=", "0", ")", "{", "new", "MeetingResponseParser", "(", "is", ",", "this", ")", ".", "parse", "(", ")", ";", "}", "}", "else", "if", "(", "isAuthError", "(", "status", ")", ")", "{", "throw", "new", "EasAuthenticationException", "(", ")", ";", "}", "else", "{", "userLog", "(", "\"", "<STR_LIT>", "\"", "+", "status", ")", ";", "throw", "new", "IOException", "(", ")", ";", "}", "}", "</s>"]
["<s>", "public", "void", "sendMeetingResponse", "(", "long", "messageId", ",", "int", "response", ")", "throws", "RemoteException", "{", "sendMessageRequest", "(", "new", "MeetingResponseRequest", "(", "messageId", ",", "response", ")", ")", ";", "}", "</s>"]
["<s>", "private", "void", "startService", "(", "Mailbox", "m", ",", "int", "reason", ",", "Request", "req", ")", "{", "if", "(", "sConnectivityHold", ")", "return", ";", "synchronized", "(", "sSyncToken", ")", "{", "Account", "acct", "=", "Account", ".", "restoreAccountWithId", "(", "this", ",", "m", ".", "mAccountKey", ")", ";", "if", "(", "acct", "!", "=", "null", ")", "{", "AbstractSyncService", "service", "=", "mServiceMap", ".", "get", "(", "m", ".", "mId", ")", ";", "if", "(", "service", "=", "=", "null", ")", "{", "service", "=", "new", "EasSyncService", "(", "this", ",", "m", ")", ";", "if", "(", "!", "(", "(", "EasSyncService", ")", "service", ")", ".", "mIsValid", ")", "return", ";", "service", ".", "mSyncReason", "=", "reason", ";", "if", "(", "req", "!", "=", "null", ")", "{", "service", ".", "addRequest", "(", "req", ")", ";", "}", "startService", "(", "service", ",", "m", ")", ";", "}", "}", "}", "}", "</s>"]
["<s>", "static", "public", "void", "sendMessageRequest", "(", "Request", "req", ")", "{", "if", "(", "INSTANCE", "=", "=", "null", ")", "return", ";", "Message", "msg", "=", "Message", ".", "restoreMessageWithId", "(", "INSTANCE", ",", "req", ".", "mMessageId", ")", ";", "if", "(", "msg", "=", "=", "null", ")", "{", "return", ";", "}", "long", "mailboxId", "=", "msg", ".", "mMailboxKey", ";", "AbstractSyncService", "service", "=", "INSTANCE", ".", "mServiceMap", ".", "get", "(", "mailboxId", ")", ";", "if", "(", "service", "=", "=", "null", ")", "{", "service", "=", "startManualSync", "(", "mailboxId", ",", "SYNC_SERVICE_PART_REQUEST", ",", "req", ")", ";", "kick", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "else", "{", "service", ".", "addRequest", "(", "req", ")", ";", "}", "}", "</s>"]
["<s>", "static", "public", "AbstractSyncService", "startManualSync", "(", "long", "mailboxId", ",", "int", "reason", ",", "Request", "req", ")", "{", "if", "(", "INSTANCE", "=", "=", "null", "|", "|", "INSTANCE", ".", "mServiceMap", "=", "=", "null", ")", "return", "null", ";", "synchronized", "(", "sSyncToken", ")", "{", "if", "(", "INSTANCE", ".", "mServiceMap", ".", "get", "(", "mailboxId", ")", "=", "=", "null", ")", "{", "INSTANCE", ".", "mSyncErrorMap", ".", "remove", "(", "mailboxId", ")", ";", "Mailbox", "m", "=", "Mailbox", ".", "restoreMailboxWithId", "(", "INSTANCE", ",", "mailboxId", ")", ";", "if", "(", "m", "!", "=", "null", ")", "{", "INSTANCE", ".", "log", "(", "\"", "<STR_LIT>", "\"", "+", "m", ".", "mDisplayName", ")", ";", "INSTANCE", ".", "startService", "(", "m", ",", "reason", ",", "req", ")", ";", "}", "}", "}", "return", "INSTANCE", ".", "mServiceMap", ".", "get", "(", "mailboxId", ")", ";", "}", "</s>"]
["<s>", "public", "void", "parseResult", "(", ")", "throws", "IOException", "{", "while", "(", "nextTag", "(", "Tags", ".", "MREQ_RESULT", ")", "!", "=", "END", ")", "{", "if", "(", "tag", "=", "=", "Tags", ".", "MREQ_STATUS", ")", "{", "int", "status", "=", "getValueInt", "(", ")", ";", "if", "(", "status", "!", "=", "1", ")", "{", "mService", ".", "userLog", "(", "\"", "<STR_LIT>", "\"", "+", "status", ")", ";", "}", "}", "else", "if", "(", "tag", "=", "=", "Tags", ".", "MREQ_CAL_ID", ")", "{", "mService", ".", "userLog", "(", "\"", "<STR_LIT>", "\"", "+", "getValue", "(", ")", ")", ";", "}", "else", "{", "skipTag", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "@", "Override", "public", "boolean", "parse", "(", ")", "throws", "IOException", "{", "boolean", "res", "=", "false", ";", "if", "(", "nextTag", "(", "START_DOCUMENT", ")", "!", "=", "Tags", ".", "MREQ_MEETING_RESPONSE", ")", "{", "throw", "new", "IOException", "(", ")", ";", "}", "while", "(", "nextTag", "(", "START_DOCUMENT", ")", "!", "=", "END_DOCUMENT", ")", "{", "if", "(", "tag", "=", "=", "Tags", ".", "MREQ_RESULT", ")", "{", "parseResult", "(", ")", ";", "}", "else", "{", "skipTag", "(", ")", ";", "}", "}", "return", "res", ";", "}", "</s>"]
["<s>", "public", "synchronized", "static", "SecurityPolicy", "getInstance", "(", "Context", "context", ")", "{", "if", "(", "sInstance", "=", "=", "null", ")", "{", "sInstance", "=", "new", "SecurityPolicy", "(", "context", ")", ";", "}", "return", "sInstance", ";", "}", "</s>"]
["<s>", "void", "setContext", "(", "Context", "context", ")", "{", "mContext", "=", "context", ";", "}", "</s>"]
["<s>", "PolicySet", "computeAggregatePolicy", "(", ")", "{", "boolean", "policiesFound", "=", "false", ";", "int", "minPasswordLength", "=", "Integer", ".", "MIN_VALUE", ";", "int", "passwordMode", "=", "Integer", ".", "MIN_VALUE", ";", "int", "maxPasswordFails", "=", "Integer", ".", "MAX_VALUE", ";", "int", "maxScreenLockTime", "=", "Integer", ".", "MAX_VALUE", ";", "boolean", "requireRemoteWipe", "=", "false", ";", "Cursor", "c", "=", "mContext", ".", "getContentResolver", "(", ")", ".", "query", "(", "Account", ".", "CONTENT_URI", ",", "ACCOUNT_SECURITY_PROJECTION", ",", "WHERE_ACCOUNT_SECURITY_NONZERO", ",", "null", ",", "null", ")", ";", "try", "{", "while", "(", "c", ".", "moveToNext", "(", ")", ")", "{", "int", "flags", "=", "c", ".", "getInt", "(", "ACCOUNT_SECURITY_COLUMN_FLAGS", ")", ";", "if", "(", "flags", "!", "=", "0", ")", "{", "PolicySet", "p", "=", "new", "PolicySet", "(", "flags", ")", ";", "if", "(", "p", ".", "mMinPasswordLength", ">", "0", ")", "{", "minPasswordLength", "=", "Math", ".", "max", "(", "p", ".", "mMinPasswordLength", ",", "minPasswordLength", ")", ";", "}", "if", "(", "p", ".", "mPasswordMode", ">", "0", ")", "{", "passwordMode", "=", "Math", ".", "max", "(", "p", ".", "mPasswordMode", ",", "passwordMode", ")", ";", "}", "if", "(", "p", ".", "mMaxPasswordFails", ">", "0", ")", "{", "maxPasswordFails", "=", "Math", ".", "min", "(", "p", ".", "mMaxPasswordFails", ",", "maxPasswordFails", ")", ";", "}", "if", "(", "p", ".", "mMaxScreenLockTime", ">", "0", ")", "{", "maxScreenLockTime", "=", "Math", ".", "min", "(", "p", ".", "mMaxScreenLockTime", ",", "maxScreenLockTime", ")", ";", "}", "requireRemoteWipe", "|", "=", "p", ".", "mRequireRemoteWipe", ";", "policiesFound", "=", "true", ";", "}", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "if", "(", "policiesFound", ")", "{", "return", "new", "PolicySet", "(", "minPasswordLength", ",", "passwordMode", ",", "maxPasswordFails", ",", "maxScreenLockTime", ",", "requireRemoteWipe", ")", ";", "}", "else", "{", "return", "null", ";", "}", "}", "</s>"]
["<s>", "public", "boolean", "isSupported", "(", "PolicySet", "policies", ")", "{", "return", "true", ";", "}", "</s>"]
["<s>", "public", "boolean", "isActive", "(", "PolicySet", "policies", ")", "{", "return", "true", ";", "}", "</s>"]
["<s>", "public", "void", "writeAccount", "(", "Account", "account", ",", "String", "syncKey", ")", "{", "account", ".", "mSecurityFlags", "=", "hashCode", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "boolean", "equals", "(", "Object", "o", ")", "{", "if", "(", "o", "instanceof", "PolicySet", ")", "{", "PolicySet", "other", "=", "(", "PolicySet", ")", "o", ";", "return", "(", "this", ".", "mMinPasswordLength", "=", "=", "other", ".", "mMinPasswordLength", ")", "&", "&", "(", "this", ".", "mPasswordMode", "=", "=", "other", ".", "mPasswordMode", ")", "&", "&", "(", "this", ".", "mMaxPasswordFails", "=", "=", "other", ".", "mMaxPasswordFails", ")", "&", "&", "(", "this", ".", "mMaxScreenLockTime", "=", "=", "other", ".", "mMaxScreenLockTime", ")", "&", "&", "(", "this", ".", "mRequireRemoteWipe", "=", "=", "other", ".", "mRequireRemoteWipe", ")", ";", "}", "return", "false", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "int", "hashCode", "(", ")", "{", "int", "flags", "=", "0", ";", "flags", "=", "mMinPasswordLength", "<", "<", "PASSWORD_LENGTH_SHIFT", ";", "flags", "|", "=", "mPasswordMode", ";", "flags", "|", "=", "mMaxPasswordFails", "<", "<", "PASSWORD_MAX_FAILS_SHIFT", ";", "flags", "|", "=", "mMaxScreenLockTime", "<", "<", "SCREEN_LOCK_TIME_SHIFT", ";", "if", "(", "mRequireRemoteWipe", ")", "{", "flags", "|", "=", "REQUIRE_REMOTE_WIPE", ";", "}", "return", "flags", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "String", "toString", "(", ")", "{", "return", "\"", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "\"", "+", "mMinPasswordLength", "+", "\"", "<STR_LIT>", "\"", "+", "mPasswordMode", "+", "\"", "<STR_LIT>", "\"", "+", "mMaxPasswordFails", "+", "\"", "<STR_LIT>", "\"", "+", "mMaxScreenLockTime", "+", "\"", "<STR_LIT>", "\"", "+", "mRequireRemoteWipe", "+", "\"", "<STR_LIT:}>", "\"", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "onEnabled", "(", "Context", "context", ",", "Intent", "intent", ")", "{", "mEnabled", "=", "true", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "onDisabled", "(", "Context", "context", ",", "Intent", "intent", ")", "{", "mEnabled", "=", "false", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "void", "setUp", "(", ")", "throws", "Exception", "{", "super", ".", "setUp", "(", ")", ";", "mMockContext", "=", "getMockContext", "(", ")", ";", "}", "</s>"]
["<s>", "private", "SecurityPolicy", "getSecurityPolicy", "(", ")", "{", "SecurityPolicy", "sp", "=", "SecurityPolicy", ".", "getInstance", "(", "mMockContext", ")", ";", "sp", ".", "setContext", "(", "mMockContext", ")", ";", "return", "sp", ";", "}", "</s>"]
["<s>", "public", "void", "testAggregator", "(", ")", "{", "SecurityPolicy", "sp", "=", "getSecurityPolicy", "(", ")", ";", "assertNull", "(", "sp", ".", "computeAggregatePolicy", "(", ")", ")", ";", "Account", "a1", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "false", ",", "mMockContext", ")", ";", "a1", ".", "mSecurityFlags", "=", "0", ";", "a1", ".", "save", "(", "mMockContext", ")", ";", "Account", "a2", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "false", ",", "mMockContext", ")", ";", "a2", ".", "mSecurityFlags", "=", "0", ";", "a2", ".", "save", "(", "mMockContext", ")", ";", "assertNull", "(", "sp", ".", "computeAggregatePolicy", "(", ")", ")", ";", "PolicySet", "p3in", "=", "new", "PolicySet", "(", "<NUM_LIT:10>", ",", "PolicySet", ".", "PASSWORD_MODE_SIMPLE", ",", "<NUM_LIT:15>", ",", "<NUM_LIT:16>", ",", "false", ")", ";", "Account", "a3", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "false", ",", "mMockContext", ")", ";", "p3in", ".", "writeAccount", "(", "a3", ",", "null", ")", ";", "a3", ".", "save", "(", "mMockContext", ")", ";", "PolicySet", "p3out", "=", "sp", ".", "computeAggregatePolicy", "(", ")", ";", "assertNotNull", "(", "p3out", ")", ";", "assertEquals", "(", "p3in", ",", "p3out", ")", ";", "PolicySet", "p4in", "=", "new", "PolicySet", "(", "<NUM_LIT:20>", ",", "PolicySet", ".", "PASSWORD_MODE_STRONG", ",", "<NUM_LIT>", ",", "<NUM_LIT>", ",", "false", ")", ";", "Account", "a4", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "false", ",", "mMockContext", ")", ";", "p4in", ".", "writeAccount", "(", "a4", ",", "null", ")", ";", "a4", ".", "save", "(", "mMockContext", ")", ";", "PolicySet", "p4out", "=", "sp", ".", "computeAggregatePolicy", "(", ")", ";", "assertNotNull", "(", "p4out", ")", ";", "assertEquals", "(", "<NUM_LIT:20>", ",", "p4out", ".", "mMinPasswordLength", ")", ";", "assertEquals", "(", "PolicySet", ".", "PASSWORD_MODE_STRONG", ",", "p4out", ".", "mPasswordMode", ")", ";", "assertEquals", "(", "<NUM_LIT:15>", ",", "p4out", ".", "mMaxPasswordFails", ")", ";", "assertEquals", "(", "<NUM_LIT:16>", ",", "p4out", ".", "mMaxScreenLockTime", ")", ";", "assertFalse", "(", "p4out", ".", "mRequireRemoteWipe", ")", ";", "PolicySet", "p5in", "=", "new", "PolicySet", "(", "<NUM_LIT:4>", ",", "PolicySet", ".", "PASSWORD_MODE_NONE", ",", "<NUM_LIT:5>", ",", "<NUM_LIT:6>", ",", "true", ")", ";", "Account", "a5", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "false", ",", "mMockContext", ")", ";", "p5in", ".", "writeAccount", "(", "a5", ",", "null", ")", ";", "a5", ".", "save", "(", "mMockContext", ")", ";", "PolicySet", "p5out", "=", "sp", ".", "computeAggregatePolicy", "(", ")", ";", "assertNotNull", "(", "p5out", ")", ";", "assertEquals", "(", "<NUM_LIT:20>", ",", "p5out", ".", "mMinPasswordLength", ")", ";", "assertEquals", "(", "PolicySet", ".", "PASSWORD_MODE_STRONG", ",", "p5out", ".", "mPasswordMode", ")", ";", "assertEquals", "(", "<NUM_LIT:5>", ",", "p5out", ".", "mMaxPasswordFails", ")", ";", "assertEquals", "(", "<NUM_LIT:6>", ",", "p5out", ".", "mMaxScreenLockTime", ")", ";", "assertTrue", "(", "p5out", ".", "mRequireRemoteWipe", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testNullFlags", "(", ")", "{", "SecurityPolicy", "sp", "=", "getSecurityPolicy", "(", ")", ";", "Account", "a1", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "true", ",", "mMockContext", ")", ";", "ContentValues", "cv", "=", "new", "ContentValues", "(", ")", ";", "cv", ".", "putNull", "(", "AccountColumns", ".", "SECURITY_FLAGS", ")", ";", "Uri", "uri", "=", "ContentUris", ".", "withAppendedId", "(", "Account", ".", "CONTENT_URI", ",", "a1", ".", "mId", ")", ";", "mMockContext", ".", "getContentResolver", "(", ")", ".", "update", "(", "uri", ",", "cv", ",", "null", ",", "null", ")", ";", "Account", "a2", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "false", ",", "mMockContext", ")", ";", "a2", ".", "mSecurityFlags", "=", "0", ";", "a2", ".", "save", "(", "mMockContext", ")", ";", "assertNull", "(", "sp", ".", "computeAggregatePolicy", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "SmallTest", "public", "void", "testFieldRanges", "(", ")", "{", "PolicySet", "p", "=", "new", "PolicySet", "(", "PolicySet", ".", "PASSWORD_LENGTH_MAX", ",", "0", ",", "0", ",", "0", ",", "false", ")", ";", "assertEquals", "(", "PolicySet", ".", "PASSWORD_LENGTH_MAX", ",", "p", ".", "mMinPasswordLength", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mPasswordMode", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mMaxPasswordFails", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mMaxScreenLockTime", ")", ";", "assertFalse", "(", "p", ".", "mRequireRemoteWipe", ")", ";", "p", "=", "new", "PolicySet", "(", "0", ",", "PolicySet", ".", "PASSWORD_MODE_STRONG", ",", "0", ",", "0", ",", "false", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mMinPasswordLength", ")", ";", "assertEquals", "(", "PolicySet", ".", "PASSWORD_MODE_STRONG", ",", "p", ".", "mPasswordMode", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mMaxPasswordFails", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mMaxScreenLockTime", ")", ";", "assertFalse", "(", "p", ".", "mRequireRemoteWipe", ")", ";", "p", "=", "new", "PolicySet", "(", "0", ",", "0", ",", "PolicySet", ".", "PASSWORD_MAX_FAILS_MAX", ",", "0", ",", "false", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mMinPasswordLength", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mPasswordMode", ")", ";", "assertEquals", "(", "PolicySet", ".", "PASSWORD_MAX_FAILS_MAX", ",", "p", ".", "mMaxPasswordFails", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mMaxScreenLockTime", ")", ";", "assertFalse", "(", "p", ".", "mRequireRemoteWipe", ")", ";", "p", "=", "new", "PolicySet", "(", "0", ",", "0", ",", "0", ",", "PolicySet", ".", "SCREEN_LOCK_TIME_MAX", ",", "false", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mMinPasswordLength", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mPasswordMode", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mMaxPasswordFails", ")", ";", "assertEquals", "(", "PolicySet", ".", "SCREEN_LOCK_TIME_MAX", ",", "p", ".", "mMaxScreenLockTime", ")", ";", "assertFalse", "(", "p", ".", "mRequireRemoteWipe", ")", ";", "p", "=", "new", "PolicySet", "(", "0", ",", "0", ",", "0", ",", "0", ",", "true", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mMinPasswordLength", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mPasswordMode", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mMaxPasswordFails", ")", ";", "assertEquals", "(", "0", ",", "p", ".", "mMaxScreenLockTime", ")", ";", "assertTrue", "(", "p", ".", "mRequireRemoteWipe", ")", ";", "}", "</s>"]
["<s>", "@", "SmallTest", "public", "void", "testAccountEncoding", "(", ")", "{", "PolicySet", "p1", "=", "new", "PolicySet", "(", "1", ",", "PolicySet", ".", "PASSWORD_MODE_STRONG", ",", "<NUM_LIT:3>", ",", "<NUM_LIT:4>", ",", "true", ")", ";", "Account", "a", "=", "new", "Account", "(", ")", ";", "final", "String", "SYNC_KEY", "=", "\"", "<STR_LIT>", "\"", ";", "p1", ".", "writeAccount", "(", "a", ",", "SYNC_KEY", ")", ";", "PolicySet", "p2", "=", "new", "PolicySet", "(", "a", ")", ";", "assertEquals", "(", "p1", ",", "p2", ")", ";", "}", "</s>"]
["<s>", "@", "SmallTest", "public", "void", "testEqualsAndHash", "(", ")", "{", "PolicySet", "p1", "=", "new", "PolicySet", "(", "1", ",", "PolicySet", ".", "PASSWORD_MODE_STRONG", ",", "<NUM_LIT:3>", ",", "<NUM_LIT:4>", ",", "true", ")", ";", "PolicySet", "p2", "=", "new", "PolicySet", "(", "1", ",", "PolicySet", ".", "PASSWORD_MODE_STRONG", ",", "<NUM_LIT:3>", ",", "<NUM_LIT:4>", ",", "true", ")", ";", "PolicySet", "p3", "=", "new", "PolicySet", "(", "<NUM_LIT:2>", ",", "PolicySet", ".", "PASSWORD_MODE_SIMPLE", ",", "<NUM_LIT:5>", ",", "<NUM_LIT:6>", ",", "true", ")", ";", "assertTrue", "(", "p1", ".", "equals", "(", "p2", ")", ")", ";", "assertFalse", "(", "p2", ".", "equals", "(", "p3", ")", ")", ";", "assertTrue", "(", "p1", ".", "hashCode", "(", ")", "=", "=", "p2", ".", "hashCode", "(", ")", ")", ";", "assertFalse", "(", "p2", ".", "hashCode", "(", ")", "=", "=", "p3", ".", "hashCode", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "static", "VendorPolicyLoader", "getInstance", "(", "Context", "context", ")", "{", "if", "(", "sInstance", "=", "=", "null", ")", "{", "sInstance", "=", "new", "VendorPolicyLoader", "(", "context", ")", ";", "}", "return", "sInstance", ";", "}", "</s>"]
["<s>", "static", "boolean", "isSystemPackage", "(", "Context", "context", ",", "String", "packageName", ")", "{", "try", "{", "ApplicationInfo", "ai", "=", "context", ".", "getPackageManager", "(", ")", ".", "getApplicationInfo", "(", "packageName", ",", "0", ")", ";", "return", "(", "ai", ".", "flags", "&", "ApplicationInfo", ".", "FLAG_SYSTEM", ")", "!", "=", "0", ";", "}", "catch", "(", "NameNotFoundException", "e", ")", "{", "return", "false", ";", "}", "}", "</s>"]
["<s>", "Bundle", "getPolicy", "(", "String", "policy", ",", "Bundle", "args", ")", "{", "Bundle", "ret", "=", "null", ";", "if", "(", "mPolicyMethod", "!", "=", "null", ")", "{", "try", "{", "ret", "=", "(", "Bundle", ")", "mPolicyMethod", ".", "invoke", "(", "null", ",", "policy", ",", "args", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "Log", ".", "w", "(", "Email", ".", "LOG_TAG", ",", "\"", "<STR_LIT>", "\"", ",", "e", ")", ";", "}", "}", "return", "(", "ret", "!", "=", "null", ")", "?", "ret", ":", "Bundle", ".", "EMPTY", ";", "}", "</s>"]
["<s>", "public", "boolean", "useAlternateExchangeStrings", "(", ")", "{", "return", "getPolicy", "(", "USE_ALTERNATE_EXCHANGE_STRINGS", ",", "null", ")", ".", "getBoolean", "(", "USE_ALTERNATE_EXCHANGE_STRINGS", ",", "false", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testPackageNotExist", "(", ")", "{", "VendorPolicyLoader", "pl", "=", "new", "VendorPolicyLoader", "(", "getContext", "(", ")", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "true", ")", ";", "assertEquals", "(", "Bundle", ".", "EMPTY", ",", "pl", ".", "getPolicy", "(", "null", ",", "null", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testIsSystemPackage", "(", ")", "{", "final", "Context", "c", "=", "getContext", "(", ")", ";", "assertEquals", "(", "false", ",", "VendorPolicyLoader", ".", "isSystemPackage", "(", "c", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "false", ",", "VendorPolicyLoader", ".", "isSystemPackage", "(", "c", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "true", ",", "VendorPolicyLoader", ".", "isSystemPackage", "(", "c", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testGetPolicy", "(", ")", "{", "VendorPolicyLoader", "pl", "=", "new", "VendorPolicyLoader", "(", "getContext", "(", ")", ",", "\"", "<STR_LIT>", "\"", ",", "MockVendorPolicy", ".", "class", ".", "getName", "(", ")", ",", "true", ")", ";", "Bundle", "result", "=", "new", "Bundle", "(", ")", ";", "result", ".", "putInt", "(", "\"", "<STR_LIT>", "\"", ",", "1", ")", ";", "MockVendorPolicy", ".", "mockResult", "=", "result", ";", "Bundle", "args", "=", "new", "Bundle", "(", ")", ";", "args", ".", "putString", "(", "\"", "<STR_LIT:1>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "Bundle", "actualResult", "=", "pl", ".", "getPolicy", "(", "\"", "<STR_LIT:1>", "\"", ",", "args", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:1>", "\"", ",", "MockVendorPolicy", ".", "passedPolicy", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "MockVendorPolicy", ".", "passedBundle", ".", "getString", "(", "\"", "<STR_LIT:1>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "1", ",", "actualResult", ".", "getInt", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testGetPolicyNonSystem", "(", ")", "{", "VendorPolicyLoader", "pl", "=", "new", "VendorPolicyLoader", "(", "getContext", "(", ")", ",", "\"", "<STR_LIT>", "\"", ",", "MockVendorPolicy", ".", "class", ".", "getName", "(", ")", ",", "false", ")", ";", "MockVendorPolicy", ".", "passedPolicy", "=", "null", ";", "assertEquals", "(", "Bundle", ".", "EMPTY", ",", "pl", ".", "getPolicy", "(", "\"", "<STR_LIT:1>", "\"", ",", "null", ")", ")", ";", "assertNull", "(", "MockVendorPolicy", ".", "passedPolicy", ")", ";", "}", "</s>"]
["<s>", "public", "static", "Bundle", "getPolicy", "(", "String", "operation", ",", "Bundle", "args", ")", "{", "passedPolicy", "=", "operation", ";", "passedBundle", "=", "args", ";", "return", "mockResult", ";", "}", "</s>"]
["<s>", "static", "public", "AccountManagerFuture", "<", "Bundle", ">", "addSystemAccount", "(", "Context", "context", ",", "Account", "acct", ",", "boolean", "syncContacts", ",", "boolean", "syncCalendar", ",", "AccountManagerCallback", "<", "Bundle", ">", "callback", ")", "{", "Bundle", "options", "=", "new", "Bundle", "(", ")", ";", "options", ".", "putString", "(", "EasAuthenticatorService", ".", "OPTIONS_USERNAME", ",", "acct", ".", "mEmailAddress", ")", ";", "options", ".", "putString", "(", "EasAuthenticatorService", ".", "OPTIONS_PASSWORD", ",", "acct", ".", "mHostAuthRecv", ".", "mPassword", ")", ";", "options", ".", "putBoolean", "(", "EasAuthenticatorService", ".", "OPTIONS_CONTACTS_SYNC_ENABLED", ",", "syncContacts", ")", ";", "options", ".", "putBoolean", "(", "EasAuthenticatorService", ".", "OPTIONS_CALENDAR_SYNC_ENABLED", ",", "syncCalendar", ")", ";", "return", "AccountManager", ".", "get", "(", "context", ")", ".", "addAccount", "(", "Eas", ".", "ACCOUNT_MANAGER_TYPE", ",", "null", ",", "null", ",", "options", ",", "null", ",", "callback", ",", "null", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "onPerformSync", "(", "Account", "account", ",", "Bundle", "extras", ",", "String", "authority", ",", "ContentProviderClient", "provider", ",", "SyncResult", "syncResult", ")", "{", "try", "{", "CalendarSyncAdapterService", ".", "performSync", "(", "mContext", ",", "account", ",", "extras", ",", "authority", ",", "provider", ",", "syncResult", ")", ";", "}", "catch", "(", "OperationCanceledException", "e", ")", "{", "}", "}", "</s>"]
["<s>", "private", "static", "void", "performSync", "(", "Context", "context", ",", "Account", "account", ",", "Bundle", "extras", ",", "String", "authority", ",", "ContentProviderClient", "provider", ",", "SyncResult", "syncResult", ")", "throws", "OperationCanceledException", "{", "ContentResolver", "cr", "=", "context", ".", "getContentResolver", "(", ")", ";", "boolean", "logging", "=", "Eas", ".", "USER_LOG", ";", "if", "(", "logging", ")", "{", "Log", ".", "d", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", ")", ";", "}", "if", "(", "extras", ".", "getBoolean", "(", "ContentResolver", ".", "SYNC_EXTRAS_UPLOAD", ")", ")", "{", "Cursor", "c", "=", "cr", ".", "query", "(", "Events", ".", "CONTENT_URI", ",", "new", "String", "[", "]", "{", "Events", ".", "_ID", "}", ",", "Events", ".", "_SYNC_ID", "+", "\"", "<STR_LIT>", "\"", ",", "null", ",", "null", ")", ";", "try", "{", "if", "(", "!", "c", ".", "moveToFirst", "(", ")", ")", "{", "if", "(", "logging", ")", "{", "Log", ".", "d", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", ")", ";", "}", "return", ";", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "}", "Cursor", "accountCursor", "=", "cr", ".", "query", "(", "EmailContent", ".", "Account", ".", "CONTENT_URI", ",", "EmailContent", ".", "ID_PROJECTION", ",", "AccountColumns", ".", "EMAIL_ADDRESS", "+", "\"", "<STR_LIT>", "\"", ",", "new", "String", "[", "]", "{", "account", ".", "name", "}", ",", "null", ")", ";", "try", "{", "if", "(", "accountCursor", ".", "moveToFirst", "(", ")", ")", "{", "long", "accountId", "=", "accountCursor", ".", "getLong", "(", "0", ")", ";", "Cursor", "mailboxCursor", "=", "cr", ".", "query", "(", "Mailbox", ".", "CONTENT_URI", ",", "EmailContent", ".", "ID_PROJECTION", ",", "ACCOUNT_AND_TYPE_CALENDAR", ",", "new", "String", "[", "]", "{", "Long", ".", "toString", "(", "accountId", ")", "}", ",", "null", ")", ";", "try", "{", "if", "(", "mailboxCursor", ".", "moveToFirst", "(", ")", ")", "{", "if", "(", "logging", ")", "{", "Log", ".", "d", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", "+", "account", ".", "name", ")", ";", "}", "SyncManager", ".", "serviceRequest", "(", "mailboxCursor", ".", "getLong", "(", "0", ")", ",", "SyncManager", ".", "SYNC_UPSYNC", ")", ";", "}", "}", "finally", "{", "mailboxCursor", ".", "close", "(", ")", ";", "}", "}", "}", "finally", "{", "accountCursor", ".", "close", "(", ")", ";", "}", "}", "</s>"]
["<s>", "static", "Uri", "asSyncAdapter", "(", "Uri", "uri", ")", "{", "return", "uri", ".", "buildUpon", "(", ")", ".", "appendQueryParameter", "(", "Calendar", ".", "CALLER_IS_SYNCADAPTER", ",", "\"", "<STR_LIT>", "\"", ")", ".", "build", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "String", "getSyncKey", "(", ")", "throws", "IOException", "{", "return", "super", ".", "getSyncKey", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "setSyncKey", "(", "String", "syncKey", ",", "boolean", "inCommands", ")", "throws", "IOException", "{", "super", ".", "setSyncKey", "(", "syncKey", ",", "inCommands", ")", ";", "}", "</s>"]
["<s>", "public", "void", "addEvent", "(", "CalendarOperations", "ops", ",", "String", "serverId", ",", "boolean", "update", ")", "throws", "IOException", "{", "ContentValues", "cv", "=", "new", "ContentValues", "(", ")", ";", "cv", ".", "put", "(", "Events", ".", "CALENDAR_ID", ",", "mCalendarId", ")", ";", "cv", ".", "put", "(", "Events", ".", "_SYNC_ACCOUNT", ",", "mAccount", ".", "mEmailAddress", ")", ";", "cv", ".", "put", "(", "Events", ".", "_SYNC_ACCOUNT_TYPE", ",", "Eas", ".", "ACCOUNT_MANAGER_TYPE", ")", ";", "cv", ".", "put", "(", "Events", ".", "_SYNC_ID", ",", "serverId", ")", ";", "int", "allDayEvent", "=", "0", ";", "String", "organizerName", "=", "null", ";", "String", "organizerEmail", "=", "null", ";", "int", "eventOffset", "=", "-", "1", ";", "boolean", "firstTag", "=", "true", ";", "long", "eventId", "=", "-", "1", ";", "while", "(", "nextTag", "(", "Tags", ".", "SYNC_APPLICATION_DATA", ")", "!", "=", "END", ")", "{", "if", "(", "update", "&", "&", "firstTag", ")", "{", "Cursor", "c", "=", "getServerIdCursor", "(", "serverId", ")", ";", "long", "id", "=", "-", "1", ";", "try", "{", "if", "(", "c", ".", "moveToFirst", "(", ")", ")", "{", "id", "=", "c", ".", "getLong", "(", "0", ")", ";", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "if", "(", "id", ">", "0", ")", "{", "if", "(", "tag", "=", "=", "Tags", ".", "CALENDAR_ATTENDEES", ")", "{", "mBindArgument", "[", "0", "]", "=", "Long", ".", "toString", "(", "id", ")", ";", "ops", ".", "add", "(", "ContentProviderOperation", ".", "newDelete", "(", "Attendees", ".", "CONTENT_URI", ")", ".", "withSelection", "(", "ATTENDEES_EXCEPT_ORGANIZER", ",", "mBindArgument", ")", ".", "build", "(", ")", ")", ";", "eventId", "=", "id", ";", "}", "else", "{", "userLog", "(", "\"", "<STR_LIT>", "\"", ",", "serverId", ")", ";", "ops", ".", "delete", "(", "id", ")", ";", "eventOffset", "=", "ops", ".", "newEvent", "(", "PLACEHOLDER_OPERATION", ")", ";", "}", "}", "}", "else", "if", "(", "firstTag", ")", "{", "eventOffset", "=", "ops", ".", "newEvent", "(", "PLACEHOLDER_OPERATION", ")", ";", "}", "firstTag", "=", "false", ";", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "CALENDAR_ALL_DAY_EVENT", ":", "allDayEvent", "=", "getValueInt", "(", ")", ";", "cv", ".", "put", "(", "Events", ".", "ALL_DAY", ",", "allDayEvent", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_ATTENDEES", ":", "attendeesParser", "(", "ops", ",", "organizerName", ",", "organizerEmail", ",", "eventId", ")", ";", "break", ";", "case", "Tags", ".", "BASE_BODY", ":", "cv", ".", "put", "(", "Events", ".", "DESCRIPTION", ",", "bodyParser", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_BODY", ":", "cv", ".", "put", "(", "Events", ".", "DESCRIPTION", ",", "getValue", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_CATEGORIES", ":", "categoriesParser", "(", "ops", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_TIME_ZONE", ":", "TimeZone", "tz", "=", "CalendarUtilities", ".", "parseTimeZone", "(", "getValue", "(", ")", ")", ";", "if", "(", "tz", "!", "=", "null", ")", "{", "cv", ".", "put", "(", "Events", ".", "EVENT_TIMEZONE", ",", "tz", ".", "getID", "(", ")", ")", ";", "}", "else", "{", "cv", ".", "put", "(", "Events", ".", "EVENT_TIMEZONE", ",", "TimeZone", ".", "getDefault", "(", ")", ".", "getID", "(", ")", ")", ";", "}", "break", ";", "case", "Tags", ".", "CALENDAR_START_TIME", ":", "long", "startTime", "=", "CalendarUtilities", ".", "parseDateTime", "(", "getValue", "(", ")", ")", ";", "cv", ".", "put", "(", "Events", ".", "DTSTART", ",", "startTime", ")", ";", "cv", ".", "put", "(", "Events", ".", "ORIGINAL_INSTANCE_TIME", ",", "startTime", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_END_TIME", ":", "cv", ".", "put", "(", "Events", ".", "DTEND", ",", "CalendarUtilities", ".", "parseDateTime", "(", "getValue", "(", ")", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_EXCEPTIONS", ":", "exceptionsParser", "(", "ops", ",", "cv", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_LOCATION", ":", "cv", ".", "put", "(", "Events", ".", "EVENT_LOCATION", ",", "getValue", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_RECURRENCE", ":", "String", "rrule", "=", "recurrenceParser", "(", "ops", ")", ";", "if", "(", "rrule", "!", "=", "null", ")", "{", "cv", ".", "put", "(", "Events", ".", "RRULE", ",", "rrule", ")", ";", "}", "break", ";", "case", "Tags", ".", "CALENDAR_ORGANIZER_EMAIL", ":", "organizerEmail", "=", "getValue", "(", ")", ";", "cv", ".", "put", "(", "Events", ".", "ORGANIZER", ",", "organizerEmail", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_SUBJECT", ":", "cv", ".", "put", "(", "Events", ".", "TITLE", ",", "getValue", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_SENSITIVITY", ":", "cv", ".", "put", "(", "Events", ".", "VISIBILITY", ",", "encodeVisibility", "(", "getValueInt", "(", ")", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_UID", ":", "ops", ".", "newExtendedProperty", "(", "\"", "<STR_LIT>", "\"", ",", "getValue", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_ORGANIZER_NAME", ":", "organizerName", "=", "getValue", "(", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_DTSTAMP", ":", "ops", ".", "newExtendedProperty", "(", "\"", "<STR_LIT>", "\"", ",", "getValue", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_MEETING_STATUS", ":", "ops", ".", "newExtendedProperty", "(", "\"", "<STR_LIT>", "\"", ",", "getValue", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_BUSY_STATUS", ":", "ops", ".", "newExtendedProperty", "(", "\"", "<STR_LIT>", "\"", ",", "getValue", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_REMINDER_MINS_BEFORE", ":", "ops", ".", "newReminder", "(", "getValueInt", "(", ")", ")", ";", "cv", ".", "put", "(", "Events", ".", "HAS_ALARM", ",", "1", ")", ";", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "if", "(", "eventOffset", ">", "=", "0", ")", "{", "ops", ".", "set", "(", "eventOffset", ",", "ContentProviderOperation", ".", "newInsert", "(", "sEventsUri", ")", ".", "withValues", "(", "cv", ")", ".", "build", "(", ")", ")", ";", "}", "}", "</s>"]
["<s>", "private", "String", "recurrenceParser", "(", "CalendarOperations", "ops", ")", "throws", "IOException", "{", "int", "type", "=", "-", "1", ";", "int", "occurrences", "=", "-", "1", ";", "int", "interval", "=", "-", "1", ";", "int", "dow", "=", "-", "1", ";", "int", "dom", "=", "-", "1", ";", "int", "wom", "=", "-", "1", ";", "int", "moy", "=", "-", "1", ";", "String", "until", "=", "null", ";", "while", "(", "nextTag", "(", "Tags", ".", "CALENDAR_RECURRENCE", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "CALENDAR_RECURRENCE_TYPE", ":", "type", "=", "getValueInt", "(", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_RECURRENCE_INTERVAL", ":", "interval", "=", "getValueInt", "(", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_RECURRENCE_OCCURRENCES", ":", "occurrences", "=", "getValueInt", "(", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_RECURRENCE_DAYOFWEEK", ":", "dow", "=", "getValueInt", "(", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_RECURRENCE_DAYOFMONTH", ":", "dom", "=", "getValueInt", "(", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_RECURRENCE_WEEKOFMONTH", ":", "wom", "=", "getValueInt", "(", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_RECURRENCE_MONTHOFYEAR", ":", "moy", "=", "getValueInt", "(", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_RECURRENCE_UNTIL", ":", "until", "=", "getValue", "(", ")", ";", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "return", "CalendarUtilities", ".", "rruleFromRecurrence", "(", "type", ",", "occurrences", ",", "interval", ",", "dow", ",", "dom", ",", "wom", ",", "moy", ",", "until", ")", ";", "}", "</s>"]
["<s>", "private", "void", "exceptionParser", "(", "CalendarOperations", "ops", ",", "ContentValues", "parentCv", ")", "throws", "IOException", "{", "ContentValues", "cv", "=", "new", "ContentValues", "(", ")", ";", "cv", ".", "put", "(", "Events", ".", "CALENDAR_ID", ",", "mCalendarId", ")", ";", "cv", ".", "put", "(", "Events", ".", "_SYNC_ACCOUNT", ",", "mAccount", ".", "mEmailAddress", ")", ";", "cv", ".", "put", "(", "Events", ".", "_SYNC_ACCOUNT_TYPE", ",", "Eas", ".", "ACCOUNT_MANAGER_TYPE", ")", ";", "cv", ".", "put", "(", "Events", ".", "_SYNC_ID", ",", "parentCv", ".", "getAsString", "(", "Events", ".", "_SYNC_ID", ")", ")", ";", "cv", ".", "put", "(", "Events", ".", "ORGANIZER", ",", "parentCv", ".", "getAsString", "(", "Events", ".", "ORGANIZER", ")", ")", ";", "cv", ".", "put", "(", "Events", ".", "TITLE", ",", "parentCv", ".", "getAsString", "(", "Events", ".", "TITLE", ")", ")", ";", "cv", ".", "put", "(", "Events", ".", "DESCRIPTION", ",", "parentCv", ".", "getAsBoolean", "(", "Events", ".", "DESCRIPTION", ")", ")", ";", "cv", ".", "put", "(", "Events", ".", "ORIGINAL_ALL_DAY", ",", "parentCv", ".", "getAsInteger", "(", "Events", ".", "ALL_DAY", ")", ")", ";", "cv", ".", "put", "(", "Events", ".", "ORIGINAL_EVENT", ",", "parentCv", ".", "getAsString", "(", "Events", ".", "_SYNC_ID", ")", ")", ";", "while", "(", "nextTag", "(", "Tags", ".", "SYNC_APPLICATION_DATA", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "CALENDAR_EXCEPTION_START_TIME", ":", "cv", ".", "put", "(", "Events", ".", "ORIGINAL_INSTANCE_TIME", ",", "CalendarUtilities", ".", "parseDateTime", "(", "getValue", "(", ")", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_EXCEPTION_IS_DELETED", ":", "if", "(", "getValueInt", "(", ")", "=", "=", "1", ")", "{", "cv", ".", "put", "(", "Events", ".", "STATUS", ",", "Events", ".", "STATUS_CANCELED", ")", ";", "}", "break", ";", "case", "Tags", ".", "CALENDAR_ALL_DAY_EVENT", ":", "cv", ".", "put", "(", "Events", ".", "ALL_DAY", ",", "getValueInt", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "BASE_BODY", ":", "cv", ".", "put", "(", "Events", ".", "DESCRIPTION", ",", "bodyParser", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_BODY", ":", "cv", ".", "put", "(", "Events", ".", "DESCRIPTION", ",", "getValue", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_START_TIME", ":", "cv", ".", "put", "(", "Events", ".", "DTSTART", ",", "CalendarUtilities", ".", "parseDateTime", "(", "getValue", "(", ")", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_END_TIME", ":", "cv", ".", "put", "(", "Events", ".", "DTEND", ",", "CalendarUtilities", ".", "parseDateTime", "(", "getValue", "(", ")", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_LOCATION", ":", "cv", ".", "put", "(", "Events", ".", "EVENT_LOCATION", ",", "getValue", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_RECURRENCE", ":", "String", "rrule", "=", "recurrenceParser", "(", "ops", ")", ";", "if", "(", "rrule", "!", "=", "null", ")", "{", "cv", ".", "put", "(", "Events", ".", "RRULE", ",", "rrule", ")", ";", "}", "break", ";", "case", "Tags", ".", "CALENDAR_SUBJECT", ":", "cv", ".", "put", "(", "Events", ".", "TITLE", ",", "getValue", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_SENSITIVITY", ":", "cv", ".", "put", "(", "Events", ".", "VISIBILITY", ",", "encodeVisibility", "(", "getValueInt", "(", ")", ")", ")", ";", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "if", "(", "!", "cv", ".", "containsKey", "(", "Events", ".", "DTSTART", ")", ")", "{", "cv", ".", "put", "(", "Events", ".", "DTSTART", ",", "parentCv", ".", "getAsLong", "(", "Events", ".", "DTSTART", ")", ")", ";", "}", "if", "(", "!", "cv", ".", "containsKey", "(", "Events", ".", "DTEND", ")", ")", "{", "cv", ".", "put", "(", "Events", ".", "DTEND", ",", "parentCv", ".", "getAsLong", "(", "Events", ".", "DTEND", ")", ")", ";", "}", "ops", ".", "newException", "(", "cv", ")", ";", "}", "</s>"]
["<s>", "private", "int", "encodeVisibility", "(", "int", "easVisibility", ")", "{", "int", "visibility", "=", "0", ";", "switch", "(", "easVisibility", ")", "{", "case", "0", ":", "visibility", "=", "Events", ".", "VISIBILITY_DEFAULT", ";", "break", ";", "case", "1", ":", "visibility", "=", "Events", ".", "VISIBILITY_PUBLIC", ";", "break", ";", "case", "<NUM_LIT:2>", ":", "visibility", "=", "Events", ".", "VISIBILITY_PRIVATE", ";", "break", ";", "case", "<NUM_LIT:3>", ":", "visibility", "=", "Events", ".", "VISIBILITY_CONFIDENTIAL", ";", "break", ";", "}", "return", "visibility", ";", "}", "</s>"]
["<s>", "private", "void", "exceptionsParser", "(", "CalendarOperations", "ops", ",", "ContentValues", "cv", ")", "throws", "IOException", "{", "while", "(", "nextTag", "(", "Tags", ".", "CALENDAR_EXCEPTIONS", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "CALENDAR_EXCEPTION", ":", "exceptionParser", "(", "ops", ",", "cv", ")", ";", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "private", "void", "categoriesParser", "(", "CalendarOperations", "ops", ")", "throws", "IOException", "{", "while", "(", "nextTag", "(", "Tags", ".", "CALENDAR_CATEGORIES", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "CALENDAR_CATEGORY", ":", "default", ":", "skipTag", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "private", "String", "attendeesParser", "(", "CalendarOperations", "ops", ",", "String", "organizerName", ",", "String", "organizerEmail", ",", "long", "eventId", ")", "throws", "IOException", "{", "String", "body", "=", "null", ";", "if", "(", "organizerName", "!", "=", "null", "|", "|", "organizerEmail", "!", "=", "null", ")", "{", "ContentValues", "cv", "=", "new", "ContentValues", "(", ")", ";", "if", "(", "organizerName", "!", "=", "null", ")", "{", "cv", ".", "put", "(", "Attendees", ".", "ATTENDEE_NAME", ",", "organizerName", ")", ";", "}", "if", "(", "organizerEmail", "!", "=", "null", ")", "{", "cv", ".", "put", "(", "Attendees", ".", "ATTENDEE_EMAIL", ",", "organizerEmail", ")", ";", "}", "cv", ".", "put", "(", "Attendees", ".", "ATTENDEE_RELATIONSHIP", ",", "Attendees", ".", "RELATIONSHIP_ORGANIZER", ")", ";", "cv", ".", "put", "(", "Attendees", ".", "ATTENDEE_TYPE", ",", "Attendees", ".", "TYPE_REQUIRED", ")", ";", "if", "(", "eventId", "<", "0", ")", "{", "ops", ".", "newAttendee", "(", "cv", ")", ";", "}", "else", "{", "ops", ".", "updatedAttendee", "(", "cv", ",", "eventId", ")", ";", "}", "}", "while", "(", "nextTag", "(", "Tags", ".", "CALENDAR_ATTENDEES", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "CALENDAR_ATTENDEE", ":", "attendeeParser", "(", "ops", ",", "eventId", ")", ";", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "return", "body", ";", "}", "</s>"]
["<s>", "private", "void", "attendeeParser", "(", "CalendarOperations", "ops", ",", "long", "eventId", ")", "throws", "IOException", "{", "ContentValues", "cv", "=", "new", "ContentValues", "(", ")", ";", "while", "(", "nextTag", "(", "Tags", ".", "CALENDAR_ATTENDEE", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "CALENDAR_ATTENDEE_EMAIL", ":", "cv", ".", "put", "(", "Attendees", ".", "ATTENDEE_EMAIL", ",", "getValue", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_ATTENDEE_NAME", ":", "cv", ".", "put", "(", "Attendees", ".", "ATTENDEE_NAME", ",", "getValue", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_ATTENDEE_STATUS", ":", "int", "status", "=", "getValueInt", "(", ")", ";", "cv", ".", "put", "(", "Attendees", ".", "ATTENDEE_STATUS", ",", "(", "status", "=", "=", "<NUM_LIT:2>", ")", "?", "Attendees", ".", "ATTENDEE_STATUS_TENTATIVE", ":", "(", "status", "=", "=", "<NUM_LIT:3>", ")", "?", "Attendees", ".", "ATTENDEE_STATUS_ACCEPTED", ":", "(", "status", "=", "=", "<NUM_LIT:4>", ")", "?", "Attendees", ".", "ATTENDEE_STATUS_DECLINED", ":", "(", "status", "=", "=", "<NUM_LIT:5>", ")", "?", "Attendees", ".", "ATTENDEE_STATUS_INVITED", ":", "Attendees", ".", "ATTENDEE_STATUS_NONE", ")", ";", "break", ";", "case", "Tags", ".", "CALENDAR_ATTENDEE_TYPE", ":", "int", "type", "=", "Attendees", ".", "TYPE_NONE", ";", "switch", "(", "getValueInt", "(", ")", ")", "{", "case", "1", ":", "type", "=", "Attendees", ".", "TYPE_REQUIRED", ";", "break", ";", "case", "<NUM_LIT:2>", ":", "type", "=", "Attendees", ".", "TYPE_OPTIONAL", ";", "break", ";", "}", "cv", ".", "put", "(", "Attendees", ".", "ATTENDEE_TYPE", ",", "type", ")", ";", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "cv", ".", "put", "(", "Attendees", ".", "ATTENDEE_RELATIONSHIP", ",", "Attendees", ".", "RELATIONSHIP_ATTENDEE", ")", ";", "if", "(", "eventId", "<", "0", ")", "{", "ops", ".", "newAttendee", "(", "cv", ")", ";", "}", "else", "{", "ops", ".", "updatedAttendee", "(", "cv", ",", "eventId", ")", ";", "}", "}", "</s>"]
["<s>", "private", "String", "bodyParser", "(", ")", "throws", "IOException", "{", "String", "body", "=", "null", ";", "while", "(", "nextTag", "(", "Tags", ".", "BASE_BODY", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "BASE_DATA", ":", "body", "=", "getValue", "(", ")", ";", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "return", "body", ".", "replace", "(", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "public", "void", "addParser", "(", "CalendarOperations", "ops", ")", "throws", "IOException", "{", "String", "serverId", "=", "null", ";", "while", "(", "nextTag", "(", "Tags", ".", "SYNC_ADD", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "SYNC_SERVER_ID", ":", "serverId", "=", "getValue", "(", ")", ";", "break", ";", "case", "Tags", ".", "SYNC_APPLICATION_DATA", ":", "addEvent", "(", "ops", ",", "serverId", ",", "false", ")", ";", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "public", "void", "deleteParser", "(", "CalendarOperations", "ops", ")", "throws", "IOException", "{", "while", "(", "nextTag", "(", "Tags", ".", "SYNC_DELETE", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "SYNC_SERVER_ID", ":", "String", "serverId", "=", "getValue", "(", ")", ";", "Cursor", "c", "=", "getServerIdCursor", "(", "serverId", ")", ";", "try", "{", "if", "(", "c", ".", "moveToFirst", "(", ")", ")", "{", "userLog", "(", "\"", "<STR_LIT>", "\"", ",", "serverId", ")", ";", "ops", ".", "delete", "(", "c", ".", "getLong", "(", "0", ")", ")", ";", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "public", "void", "changeParser", "(", "CalendarOperations", "ops", ")", "throws", "IOException", "{", "String", "serverId", "=", "null", ";", "while", "(", "nextTag", "(", "Tags", ".", "SYNC_CHANGE", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "SYNC_SERVER_ID", ":", "serverId", "=", "getValue", "(", ")", ";", "break", ";", "case", "Tags", ".", "SYNC_APPLICATION_DATA", ":", "addEvent", "(", "ops", ",", "serverId", ",", "true", ")", ";", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "commandsParser", "(", ")", "throws", "IOException", "{", "while", "(", "nextTag", "(", "Tags", ".", "SYNC_COMMANDS", ")", "!", "=", "END", ")", "{", "if", "(", "tag", "=", "=", "Tags", ".", "SYNC_ADD", ")", "{", "addParser", "(", "mOps", ")", ";", "incrementChangeCount", "(", ")", ";", "}", "else", "if", "(", "tag", "=", "=", "Tags", ".", "SYNC_DELETE", ")", "{", "deleteParser", "(", "mOps", ")", ";", "incrementChangeCount", "(", ")", ";", "}", "else", "if", "(", "tag", "=", "=", "Tags", ".", "SYNC_CHANGE", ")", "{", "changeParser", "(", "mOps", ")", ";", "incrementChangeCount", "(", ")", ";", "}", "else", "skipTag", "(", ")", ";", "}", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "commit", "(", ")", "throws", "IOException", "{", "userLog", "(", "\"", "<STR_LIT>", "\"", ",", "mMailbox", ".", "mSyncKey", ")", ";", "mOps", ".", "execute", "(", ")", ";", "if", "(", "mOps", ".", "mResults", "!", "=", "null", ")", "{", "}", "}", "</s>"]
["<s>", "public", "void", "addResponsesParser", "(", ")", "throws", "IOException", "{", "String", "serverId", "=", "null", ";", "String", "clientId", "=", "null", ";", "int", "status", "=", "-", "1", ";", "ContentValues", "cv", "=", "new", "ContentValues", "(", ")", ";", "while", "(", "nextTag", "(", "Tags", ".", "SYNC_ADD", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "SYNC_SERVER_ID", ":", "serverId", "=", "getValue", "(", ")", ";", "break", ";", "case", "Tags", ".", "SYNC_CLIENT_ID", ":", "clientId", "=", "getValue", "(", ")", ";", "break", ";", "case", "Tags", ".", "SYNC_STATUS", ":", "status", "=", "getValueInt", "(", ")", ";", "if", "(", "status", "!", "=", "1", ")", "{", "userLog", "(", "\"", "<STR_LIT>", "\"", "+", "status", ")", ";", "}", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "if", "(", "clientId", "=", "=", "null", ")", "return", ";", "if", "(", "serverId", "=", "=", "null", ")", "{", "serverId", "=", "\"", "<STR_LIT>", "\"", "+", "status", ";", "}", "Cursor", "c", "=", "getClientIdCursor", "(", "clientId", ")", ";", "try", "{", "if", "(", "c", ".", "moveToFirst", "(", ")", ")", "{", "cv", ".", "put", "(", "Events", ".", "_SYNC_ID", ",", "serverId", ")", ";", "mOps", ".", "add", "(", "ContentProviderOperation", ".", "newUpdate", "(", "ContentUris", ".", "withAppendedId", "(", "sEventsUri", ",", "c", ".", "getLong", "(", "0", ")", ")", ")", ".", "withValues", "(", "cv", ")", ".", "build", "(", ")", ")", ";", "userLog", "(", "\"", "<STR_LIT>", "\"", "+", "clientId", "+", "\"", "<STR_LIT>", "\"", "+", "serverId", ")", ";", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "}", "</s>"]
["<s>", "public", "void", "changeResponsesParser", "(", ")", "throws", "IOException", "{", "String", "serverId", "=", "null", ";", "String", "status", "=", "null", ";", "while", "(", "nextTag", "(", "Tags", ".", "SYNC_CHANGE", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "SYNC_SERVER_ID", ":", "serverId", "=", "getValue", "(", ")", ";", "break", ";", "case", "Tags", ".", "SYNC_STATUS", ":", "status", "=", "getValue", "(", ")", ";", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "if", "(", "serverId", "!", "=", "null", "&", "&", "status", "!", "=", "null", ")", "{", "userLog", "(", "\"", "<STR_LIT>", "\"", "+", "serverId", "+", "\"", "<STR_LIT>", "\"", "+", "status", ")", ";", "}", "}", "</s>"]
["<s>", "public", "int", "newEvent", "(", "ContentProviderOperation", "op", ")", "{", "mEventStart", "=", "mCount", ";", "add", "(", "op", ")", ";", "return", "mEventStart", ";", "}", "</s>"]
["<s>", "public", "void", "newAttendee", "(", "ContentValues", "cv", ")", "{", "add", "(", "ContentProviderOperation", ".", "newInsert", "(", "sAttendeesUri", ")", ".", "withValues", "(", "cv", ")", ".", "withValueBackReference", "(", "Attendees", ".", "EVENT_ID", ",", "mEventStart", ")", ".", "build", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "updatedAttendee", "(", "ContentValues", "cv", ",", "long", "id", ")", "{", "cv", ".", "put", "(", "Attendees", ".", "EVENT_ID", ",", "id", ")", ";", "add", "(", "ContentProviderOperation", ".", "newInsert", "(", "sAttendeesUri", ")", ".", "withValues", "(", "cv", ")", ".", "build", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "newException", "(", "ContentValues", "cv", ")", "{", "add", "(", "ContentProviderOperation", ".", "newInsert", "(", "sEventsUri", ")", ".", "withValues", "(", "cv", ")", ".", "build", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "newExtendedProperty", "(", "String", "name", ",", "String", "value", ")", "{", "add", "(", "ContentProviderOperation", ".", "newInsert", "(", "sExtendedPropertiesUri", ")", ".", "withValue", "(", "ExtendedProperties", ".", "NAME", ",", "name", ")", ".", "withValue", "(", "ExtendedProperties", ".", "VALUE", ",", "value", ")", ".", "withValueBackReference", "(", "ExtendedProperties", ".", "EVENT_ID", ",", "mEventStart", ")", ".", "build", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "newReminder", "(", "int", "mins", ")", "{", "add", "(", "ContentProviderOperation", ".", "newInsert", "(", "sRemindersUri", ")", ".", "withValue", "(", "Reminders", ".", "MINUTES", ",", "mins", ")", ".", "withValue", "(", "Reminders", ".", "METHOD", ",", "Reminders", ".", "METHOD_DEFAULT", ")", ".", "withValueBackReference", "(", "ExtendedProperties", ".", "EVENT_ID", ",", "mEventStart", ")", ".", "build", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "delete", "(", "long", "id", ")", "{", "add", "(", "ContentProviderOperation", ".", "newDelete", "(", "ContentUris", ".", "withAppendedId", "(", "sEventsUri", ",", "id", ")", ")", ".", "build", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "execute", "(", ")", "{", "synchronized", "(", "mService", ".", "getSynchronizer", "(", ")", ")", "{", "if", "(", "!", "mService", ".", "isStopped", "(", ")", ")", "{", "try", "{", "if", "(", "!", "isEmpty", "(", ")", ")", "{", "mService", ".", "userLog", "(", "\"", "<STR_LIT>", "\"", ",", "size", "(", ")", ",", "\"", "<STR_LIT>", "\"", ")", ";", "mResults", "=", "mContext", ".", "getContentResolver", "(", ")", ".", "applyBatch", "(", "Calendar", ".", "AUTHORITY", ",", "this", ")", ";", "}", "}", "catch", "(", "RemoteException", "e", ")", "{", "Log", ".", "e", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", ",", "e", ")", ";", "}", "catch", "(", "OperationApplicationException", "e", ")", "{", "Log", ".", "e", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", ",", "e", ")", ";", "}", "}", "}", "}", "</s>"]
["<s>", "private", "String", "decodeVisibility", "(", "int", "visibility", ")", "{", "int", "easVisibility", "=", "0", ";", "switch", "(", "visibility", ")", "{", "case", "Events", ".", "VISIBILITY_DEFAULT", ":", "easVisibility", "=", "0", ";", "break", ";", "case", "Events", ".", "VISIBILITY_PUBLIC", ":", "easVisibility", "=", "1", ";", "break", ";", "case", "Events", ".", "VISIBILITY_PRIVATE", ":", "easVisibility", "=", "<NUM_LIT:2>", ";", "break", ";", "case", "Events", ".", "VISIBILITY_CONFIDENTIAL", ":", "easVisibility", "=", "<NUM_LIT:3>", ";", "break", ";", "}", "return", "Integer", ".", "toString", "(", "easVisibility", ")", ";", "}", "</s>"]
["<s>", "public", "void", "setLoggingTag", "(", "String", "val", ")", "{", "logTag", "=", "val", ";", "}", "</s>"]
["<s>", "static", "int", "getLong", "(", "byte", "[", "]", "bytes", ",", "int", "offset", ")", "{", "return", "(", "bytes", "[", "offset", "+", "+", "]", "&", "<NUM_LIT>", ")", "|", "(", "(", "bytes", "[", "offset", "+", "+", "]", "&", "<NUM_LIT>", ")", "<", "<", "<NUM_LIT:8>", ")", "|", "(", "(", "bytes", "[", "offset", "+", "+", "]", "&", "<NUM_LIT>", ")", "<", "<", "<NUM_LIT:16>", ")", "|", "(", "(", "bytes", "[", "offset", "]", "&", "<NUM_LIT>", ")", "<", "<", "<NUM_LIT:24>", ")", ";", "}", "</s>"]
["<s>", "static", "void", "setLong", "(", "byte", "[", "]", "bytes", ",", "int", "offset", ",", "int", "value", ")", "{", "bytes", "[", "offset", "+", "+", "]", "=", "(", "byte", ")", "(", "value", "&", "<NUM_LIT>", ")", ";", "bytes", "[", "offset", "+", "+", "]", "=", "(", "byte", ")", "(", "(", "value", ">", ">", "<NUM_LIT:8>", ")", "&", "<NUM_LIT>", ")", ";", "bytes", "[", "offset", "+", "+", "]", "=", "(", "byte", ")", "(", "(", "value", ">", ">", "<NUM_LIT:16>", ")", "&", "<NUM_LIT>", ")", ";", "bytes", "[", "offset", "]", "=", "(", "byte", ")", "(", "(", "value", ">", ">", "<NUM_LIT:24>", ")", "&", "<NUM_LIT>", ")", ";", "}", "</s>"]
["<s>", "static", "int", "getWord", "(", "byte", "[", "]", "bytes", ",", "int", "offset", ")", "{", "return", "(", "bytes", "[", "offset", "+", "+", "]", "&", "<NUM_LIT>", ")", "|", "(", "(", "bytes", "[", "offset", "]", "&", "<NUM_LIT>", ")", "<", "<", "<NUM_LIT:8>", ")", ";", "}", "</s>"]
["<s>", "static", "void", "setWord", "(", "byte", "[", "]", "bytes", ",", "int", "offset", ",", "int", "value", ")", "{", "bytes", "[", "offset", "+", "+", "]", "=", "(", "byte", ")", "(", "value", "&", "<NUM_LIT>", ")", ";", "bytes", "[", "offset", "]", "=", "(", "byte", ")", "(", "(", "value", ">", ">", "<NUM_LIT:8>", ")", "&", "<NUM_LIT>", ")", ";", "}", "</s>"]
["<s>", "static", "TimeZoneDate", "getTimeZoneDateFromSystemTime", "(", "byte", "[", "]", "bytes", ",", "int", "offset", ")", "{", "TimeZoneDate", "tzd", "=", "new", "TimeZoneDate", "(", ")", ";", "int", "num", "=", "getWord", "(", "bytes", ",", "offset", "+", "MSFT_SYSTEMTIME_YEAR", ")", ";", "tzd", ".", "year", "=", "Integer", ".", "toString", "(", "num", ")", ";", "num", "=", "getWord", "(", "bytes", ",", "offset", "+", "MSFT_SYSTEMTIME_MONTH", ")", ";", "if", "(", "num", "=", "=", "0", ")", "{", "return", "null", ";", "}", "else", "{", "tzd", ".", "month", "=", "num", "-", "1", ";", "}", "tzd", ".", "dayOfWeek", "=", "getWord", "(", "bytes", ",", "offset", "+", "MSFT_SYSTEMTIME_DAY_OF_WEEK", ")", "+", "1", ";", "num", "=", "getWord", "(", "bytes", ",", "offset", "+", "MSFT_SYSTEMTIME_DAY", ")", ";", "if", "(", "num", "=", "=", "<NUM_LIT:5>", ")", "{", "tzd", ".", "day", "=", "-", "1", ";", "}", "else", "{", "tzd", ".", "day", "=", "num", ";", "}", "int", "hour", "=", "getWord", "(", "bytes", ",", "offset", "+", "MSFT_SYSTEMTIME_HOUR", ")", ";", "tzd", ".", "hour", "=", "hour", ";", "int", "minute", "=", "getWord", "(", "bytes", ",", "offset", "+", "MSFT_SYSTEMTIME_MINUTE", ")", ";", "tzd", ".", "minute", "=", "minute", ";", "tzd", ".", "time", "=", "(", "hour", "*", "HOURS", ")", "+", "(", "minute", "*", "MINUTES", ")", ";", "return", "tzd", ";", "}", "</s>"]
["<s>", "static", "GregorianCalendar", "getCheckCalendar", "(", "TimeZone", "timeZone", ",", "TimeZoneDate", "tzd", ")", "{", "GregorianCalendar", "testCalendar", "=", "new", "GregorianCalendar", "(", "timeZone", ")", ";", "testCalendar", ".", "set", "(", "GregorianCalendar", ".", "YEAR", ",", "<NUM_LIT>", ")", ";", "testCalendar", ".", "set", "(", "GregorianCalendar", ".", "MONTH", ",", "tzd", ".", "month", ")", ";", "testCalendar", ".", "set", "(", "GregorianCalendar", ".", "DAY_OF_WEEK", ",", "tzd", ".", "dayOfWeek", ")", ";", "testCalendar", ".", "set", "(", "GregorianCalendar", ".", "DAY_OF_WEEK_IN_MONTH", ",", "tzd", ".", "day", ")", ";", "testCalendar", ".", "set", "(", "GregorianCalendar", ".", "HOUR_OF_DAY", ",", "tzd", ".", "hour", ")", ";", "testCalendar", ".", "set", "(", "GregorianCalendar", ".", "MINUTE", ",", "tzd", ".", "minute", ")", ";", "return", "testCalendar", ";", "}", "</s>"]
["<s>", "static", "public", "TimeZone", "parseTimeZone", "(", "String", "timeZoneString", ")", "{", "TimeZone", "timeZone", "=", "sTimeZoneCache", ".", "get", "(", "timeZoneString", ")", ";", "if", "(", "timeZone", "!", "=", "null", ")", "{", "if", "(", "Eas", ".", "USER_LOG", ")", "{", "Log", ".", "d", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", "+", "timeZone", ".", "getID", "(", ")", "+", "\"", "<STR_LIT>", "\"", "+", "timeZone", ".", "getDisplayName", "(", ")", ")", ";", "}", "return", "timeZone", ";", "}", "byte", "[", "]", "timeZoneBytes", "=", "Base64", ".", "decode", "(", "timeZoneString", ")", ";", "int", "bias", "=", "-", "1", "*", "getLong", "(", "timeZoneBytes", ",", "MSFT_TIME_ZONE_BIAS_OFFSET", ")", "*", "MINUTES", ";", "String", "[", "]", "zoneIds", "=", "TimeZone", ".", "getAvailableIDs", "(", "bias", ")", ";", "if", "(", "zoneIds", ".", "length", ">", "0", ")", "{", "TimeZoneDate", "dstEnd", "=", "getTimeZoneDateFromSystemTime", "(", "timeZoneBytes", ",", "MSFT_TIME_ZONE_STANDARD_DATE_OFFSET", ")", ";", "if", "(", "dstEnd", "=", "=", "null", ")", "{", "timeZone", "=", "TimeZone", ".", "getTimeZone", "(", "zoneIds", "[", "0", "]", ")", ";", "String", "dn", "=", "timeZone", ".", "getDisplayName", "(", ")", ";", "sTimeZoneCache", ".", "put", "(", "timeZoneString", ",", "timeZone", ")", ";", "if", "(", "Eas", ".", "USER_LOG", ")", "{", "Log", ".", "d", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", "+", "dn", ")", ";", "}", "return", "timeZone", ";", "}", "else", "{", "TimeZoneDate", "dstStart", "=", "getTimeZoneDateFromSystemTime", "(", "timeZoneBytes", ",", "MSFT_TIME_ZONE_DAYLIGHT_DATE_OFFSET", ")", ";", "long", "dstSavings", "=", "-", "1", "*", "getLong", "(", "timeZoneBytes", ",", "MSFT_TIME_ZONE_DAYLIGHT_BIAS_OFFSET", ")", "*", "<NUM_LIT>", "*", "SECONDS", ";", "for", "(", "String", "zoneId", ":", "zoneIds", ")", "{", "timeZone", "=", "TimeZone", ".", "getTimeZone", "(", "zoneId", ")", ";", "GregorianCalendar", "testCalendar", "=", "getCheckCalendar", "(", "timeZone", ",", "dstStart", ")", ";", "testCalendar", ".", "add", "(", "GregorianCalendar", ".", "MINUTE", ",", "-", "1", ")", ";", "Date", "before", "=", "testCalendar", ".", "getTime", "(", ")", ";", "testCalendar", ".", "add", "(", "GregorianCalendar", ".", "MINUTE", ",", "<NUM_LIT:2>", ")", ";", "Date", "after", "=", "testCalendar", ".", "getTime", "(", ")", ";", "if", "(", "timeZone", ".", "inDaylightTime", "(", "before", ")", ")", "continue", ";", "if", "(", "!", "timeZone", ".", "inDaylightTime", "(", "after", ")", ")", "continue", ";", "testCalendar", "=", "getCheckCalendar", "(", "timeZone", ",", "dstEnd", ")", ";", "testCalendar", ".", "add", "(", "GregorianCalendar", ".", "HOUR", ",", "-", "<NUM_LIT:2>", ")", ";", "before", "=", "testCalendar", ".", "getTime", "(", ")", ";", "testCalendar", ".", "add", "(", "GregorianCalendar", ".", "HOUR", ",", "<NUM_LIT:2>", ")", ";", "after", "=", "testCalendar", ".", "getTime", "(", ")", ";", "if", "(", "!", "timeZone", ".", "inDaylightTime", "(", "before", ")", ")", "continue", ";", "if", "(", "timeZone", ".", "inDaylightTime", "(", "after", ")", ")", "continue", ";", "if", "(", "dstSavings", "!", "=", "timeZone", ".", "getDSTSavings", "(", ")", ")", "continue", ";", "String", "dn", "=", "timeZone", ".", "getDisplayName", "(", ")", ";", "sTimeZoneCache", ".", "put", "(", "timeZoneString", ",", "timeZone", ")", ";", "if", "(", "Eas", ".", "USER_LOG", ")", "{", "Log", ".", "d", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", "+", "dn", ")", ";", "}", "return", "timeZone", ";", "}", "}", "}", "Log", ".", "w", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", "+", "bias", "+", "\"", "<STR_LIT>", "\"", ")", ";", "return", "TimeZone", ".", "getDefault", "(", ")", ";", "}", "</s>"]
["<s>", "static", "public", "String", "timeZoneToTZIString", "(", "String", "name", ")", "{", "TimeZone", "tz", "=", "TimeZone", ".", "getTimeZone", "(", "name", ")", ";", "byte", "[", "]", "tziBytes", "=", "new", "byte", "[", "MSFT_TIME_ZONE_SIZE", "]", ";", "int", "standardBias", "=", "-", "tz", ".", "getRawOffset", "(", ")", ";", "standardBias", "/", "=", "<NUM_LIT>", "*", "SECONDS", ";", "setLong", "(", "tziBytes", ",", "MSFT_TIME_ZONE_BIAS_OFFSET", ",", "standardBias", ")", ";", "byte", "[", "]", "tziEncodedBytes", "=", "Base64", ".", "encode", "(", "tziBytes", ")", ";", "return", "new", "String", "(", "tziEncodedBytes", ")", ";", "}", "</s>"]
["<s>", "static", "public", "long", "parseDateTime", "(", "String", "date", ")", "{", "GregorianCalendar", "cal", "=", "new", "GregorianCalendar", "(", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "0", ",", "<NUM_LIT:4>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:4>", ",", "<NUM_LIT:6>", ")", ")", "-", "1", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:6>", ",", "<NUM_LIT:8>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:9>", ",", "<NUM_LIT:11>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:11>", ",", "<NUM_LIT>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT>", ",", "<NUM_LIT:15>", ")", ")", ")", ";", "cal", ".", "setTimeZone", "(", "TimeZone", ".", "getTimeZone", "(", "\"", "<STR_LIT:GMT>", "\"", ")", ")", ";", "return", "cal", ".", "getTimeInMillis", "(", ")", ";", "}", "</s>"]
["<s>", "static", "String", "formatTwo", "(", "int", "num", ")", "{", "if", "(", "num", "<", "=", "<NUM_LIT:12>", ")", "{", "return", "sTwoCharacterNumbers", "[", "num", "]", ";", "}", "else", "return", "Integer", ".", "toString", "(", "num", ")", ";", "}", "</s>"]
["<s>", "static", "public", "String", "millisToEasDateTime", "(", "long", "millis", ")", "{", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", ")", ";", "GregorianCalendar", "cal", "=", "new", "GregorianCalendar", "(", "TimeZone", ".", "getTimeZone", "(", "\"", "<STR_LIT:GMT>", "\"", ")", ")", ";", "cal", ".", "setTimeInMillis", "(", "millis", ")", ";", "sb", ".", "append", "(", "cal", ".", "get", "(", "Calendar", ".", "YEAR", ")", ")", ";", "sb", ".", "append", "(", "formatTwo", "(", "cal", ".", "get", "(", "Calendar", ".", "MONTH", ")", "+", "1", ")", ")", ";", "sb", ".", "append", "(", "formatTwo", "(", "cal", ".", "get", "(", "Calendar", ".", "DAY_OF_MONTH", ")", ")", ")", ";", "sb", ".", "append", "(", "<CHAR_LIT>", ")", ";", "sb", ".", "append", "(", "formatTwo", "(", "cal", ".", "get", "(", "Calendar", ".", "HOUR_OF_DAY", ")", ")", ")", ";", "sb", ".", "append", "(", "formatTwo", "(", "cal", ".", "get", "(", "Calendar", ".", "MINUTE", ")", ")", ")", ";", "sb", ".", "append", "(", "formatTwo", "(", "cal", ".", "get", "(", "Calendar", ".", "SECOND", ")", ")", ")", ";", "sb", ".", "append", "(", "<CHAR_LIT:Z>", ")", ";", "return", "sb", ".", "toString", "(", ")", ";", "}", "</s>"]
["<s>", "static", "void", "addByDay", "(", "StringBuilder", "rrule", ",", "int", "dow", ",", "int", "wom", ")", "{", "rrule", ".", "append", "(", "\"", "<STR_LIT>", "\"", ")", ";", "boolean", "addComma", "=", "false", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "<NUM_LIT:7>", ";", "i", "+", "+", ")", "{", "if", "(", "(", "dow", "&", "1", ")", "=", "=", "1", ")", "{", "if", "(", "addComma", ")", "{", "rrule", ".", "append", "(", "<CHAR_LIT:U+002C>", ")", ";", "}", "if", "(", "wom", ">", "0", ")", "{", "rrule", ".", "append", "(", "wom", "=", "=", "<NUM_LIT:5>", "?", "-", "1", ":", "wom", ")", ";", "}", "rrule", ".", "append", "(", "sDayTokens", "[", "i", "]", ")", ";", "addComma", "=", "true", ";", "}", "dow", ">", ">", "=", "1", ";", "}", "}", "</s>"]
["<s>", "static", "void", "addByMonthDay", "(", "StringBuilder", "rrule", ",", "int", "dom", ")", "{", "if", "(", "dom", "=", "=", "<NUM_LIT>", ")", "{", "dom", "=", "-", "1", ";", "}", "rrule", ".", "append", "(", "\"", "<STR_LIT>", "\"", "+", "dom", ")", ";", "}", "</s>"]
["<s>", "static", "public", "String", "rruleFromRecurrence", "(", "int", "type", ",", "int", "occurrences", ",", "int", "interval", ",", "int", "dow", ",", "int", "dom", ",", "int", "wom", ",", "int", "moy", ",", "String", "until", ")", "{", "StringBuilder", "rrule", "=", "new", "StringBuilder", "(", "\"", "<STR_LIT>", "\"", "+", "sTypeToFreq", "[", "type", "]", ")", ";", "if", "(", "interval", ">", "0", ")", "{", "rrule", ".", "append", "(", "\"", "<STR_LIT>", "\"", "+", "interval", ")", ";", "}", "if", "(", "occurrences", ">", "0", ")", "{", "rrule", ".", "append", "(", "\"", "<STR_LIT>", "\"", "+", "occurrences", ")", ";", "}", "switch", "(", "type", ")", "{", "case", "0", ":", "case", "1", ":", "if", "(", "dow", ">", "0", ")", "addByDay", "(", "rrule", ",", "dow", ",", "-", "1", ")", ";", "break", ";", "case", "<NUM_LIT:2>", ":", "if", "(", "dom", ">", "0", ")", "addByMonthDay", "(", "rrule", ",", "dom", ")", ";", "break", ";", "case", "<NUM_LIT:3>", ":", "if", "(", "dow", ">", "0", ")", "addByDay", "(", "rrule", ",", "dow", ",", "wom", ")", ";", "break", ";", "case", "<NUM_LIT:5>", ":", "if", "(", "dom", ">", "0", ")", "addByMonthDay", "(", "rrule", ",", "dom", ")", ";", "if", "(", "moy", ">", "0", ")", "{", "rrule", ".", "append", "(", "\"", "<STR_LIT>", "\"", "+", "moy", ")", ";", "}", "break", ";", "case", "<NUM_LIT:6>", ":", "if", "(", "dow", ">", "0", ")", "addByDay", "(", "rrule", ",", "dow", ",", "wom", ")", ";", "if", "(", "moy", ">", "0", ")", "addByMonthDay", "(", "rrule", ",", "dow", ")", ";", "break", ";", "default", ":", "break", ";", "}", "if", "(", "until", "!", "=", "null", ")", "{", "}", "return", "rrule", ".", "toString", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "super", ".", "setUp", "(", ")", ";", "mMockContext", "=", "getMockContext", "(", ")", ";", "mMockResolver", "=", "mMockContext", ".", "getContentResolver", "(", ")", ";", "}", "</s>"]
["<s>", "EasSyncService", "getTestService", "(", ")", "{", "Account", "account", "=", "new", "Account", "(", ")", ";", "account", ".", "mId", "=", "-", "1", ";", "Mailbox", "mailbox", "=", "new", "Mailbox", "(", ")", ";", "mailbox", ".", "mId", "=", "-", "1", ";", "EasSyncService", "service", "=", "new", "EasSyncService", "(", ")", ";", "service", ".", "mContext", "=", "mMockContext", ";", "service", ".", "mMailbox", "=", "mailbox", ";", "service", ".", "mAccount", "=", "account", ";", "return", "service", ";", "}", "</s>"]
["<s>", "public", "void", "testGetSet", "(", ")", "{", "byte", "[", "]", "bytes", "=", "new", "byte", "[", "]", "{", "0", ",", "1", ",", "<NUM_LIT:2>", ",", "<NUM_LIT:3>", ",", "<NUM_LIT:4>", ",", "<NUM_LIT:5>", ",", "<NUM_LIT:6>", ",", "<NUM_LIT:7>", "}", ";", "assertEquals", "(", "<NUM_LIT>", ",", "CalendarUtilities", ".", "getWord", "(", "bytes", ",", "0", ")", ")", ";", "assertEquals", "(", "<NUM_LIT>", ",", "CalendarUtilities", ".", "getLong", "(", "bytes", ",", "0", ")", ")", ";", "assertEquals", "(", "<NUM_LIT>", ",", "CalendarUtilities", ".", "getLong", "(", "bytes", ",", "<NUM_LIT:4>", ")", ")", ";", "CalendarUtilities", ".", "setWord", "(", "bytes", ",", "0", ",", "<NUM_LIT>", ")", ";", "CalendarUtilities", ".", "setLong", "(", "bytes", ",", "<NUM_LIT:2>", ",", "<NUM_LIT>", ")", ";", "CalendarUtilities", ".", "setWord", "(", "bytes", ",", "<NUM_LIT:6>", ",", "<NUM_LIT>", ")", ";", "assertEquals", "(", "<NUM_LIT>", ",", "CalendarUtilities", ".", "getWord", "(", "bytes", ",", "0", ")", ")", ";", "assertEquals", "(", "<NUM_LIT>", ",", "CalendarUtilities", ".", "getLong", "(", "bytes", ",", "<NUM_LIT:2>", ")", ")", ";", "assertEquals", "(", "<NUM_LIT>", ",", "CalendarUtilities", ".", "getWord", "(", "bytes", ",", "<NUM_LIT:6>", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testParseTimeZoneEndToEnd", "(", ")", "{", "TimeZone", "tz", "=", "CalendarUtilities", ".", "parseTimeZone", "(", "PACIFIC_STANDARD_TIME", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "tz", ".", "getDisplayName", "(", ")", ")", ";", "tz", "=", "CalendarUtilities", ".", "parseTimeZone", "(", "INDIA_STANDARD_TIME", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "tz", ".", "getDisplayName", "(", ")", ")", ";", "tz", "=", "CalendarUtilities", ".", "parseTimeZone", "(", "ISRAEL_STANDARD_TIME", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "tz", ".", "getDisplayName", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "static", "void", "updateLoggingFlags", "(", "Context", "context", ")", "{", "Preferences", "prefs", "=", "Preferences", ".", "getPreferences", "(", "context", ")", ";", "int", "debugLogging", "=", "prefs", ".", "getEnableDebugLogging", "(", ")", "?", "Eas", ".", "DEBUG_BIT", ":", "0", ";", "int", "exchangeLogging", "=", "prefs", ".", "getEnableExchangeLogging", "(", ")", "?", "Eas", ".", "DEBUG_EXCHANGE_BIT", ":", "0", ";", "int", "fileLogging", "=", "prefs", ".", "getEnableExchangeFileLogging", "(", ")", "?", "Eas", ".", "DEBUG_FILE_BIT", ":", "0", ";", "int", "debugBits", "=", "debugLogging", "|", "exchangeLogging", "|", "fileLogging", ";", "Controller", ".", "getInstance", "(", "context", ")", ".", "serviceLogging", "(", "debugBits", ")", ";", "}", "</s>"]
["<s>", "static", "public", "long", "parseDateTimeToMillis", "(", "String", "date", ")", "{", "GregorianCalendar", "cal", "=", "new", "GregorianCalendar", "(", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "0", ",", "<NUM_LIT:4>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:4>", ",", "<NUM_LIT:6>", ")", ")", "-", "1", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:6>", ",", "<NUM_LIT:8>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:9>", ",", "<NUM_LIT:11>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:11>", ",", "<NUM_LIT>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT>", ",", "<NUM_LIT:15>", ")", ")", ")", ";", "cal", ".", "setTimeZone", "(", "TimeZone", ".", "getTimeZone", "(", "\"", "<STR_LIT:GMT>", "\"", ")", ")", ";", "return", "cal", ".", "getTimeInMillis", "(", ")", ";", "}", "</s>"]
["<s>", "static", "public", "GregorianCalendar", "parseDateTimeToCalendar", "(", "String", "date", ")", "{", "GregorianCalendar", "cal", "=", "new", "GregorianCalendar", "(", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "0", ",", "<NUM_LIT:4>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:4>", ",", "<NUM_LIT:6>", ")", ")", "-", "1", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:6>", ",", "<NUM_LIT:8>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:9>", ",", "<NUM_LIT:11>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:11>", ",", "<NUM_LIT>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT>", ",", "<NUM_LIT:15>", ")", ")", ")", ";", "cal", ".", "setTimeZone", "(", "TimeZone", ".", "getTimeZone", "(", "\"", "<STR_LIT:GMT>", "\"", ")", ")", ";", "return", "cal", ";", "}", "</s>"]
["<s>", "static", "String", "generateEasDayOfWeek", "(", "String", "dow", ")", "{", "int", "bit", "=", "1", ";", "for", "(", "String", "token", ":", "sDayTokens", ")", "{", "if", "(", "dow", ".", "equals", "(", "token", ")", ")", "{", "break", ";", "}", "else", "{", "bit", "<", "<", "=", "1", ";", "}", "}", "return", "Integer", ".", "toString", "(", "bit", ")", ";", "}", "</s>"]
["<s>", "static", "String", "tokenFromRrule", "(", "String", "rrule", ",", "String", "token", ")", "{", "int", "start", "=", "rrule", ".", "indexOf", "(", "token", ")", ";", "if", "(", "start", "<", "0", ")", "return", "null", ";", "int", "len", "=", "rrule", ".", "length", "(", ")", ";", "start", "+", "=", "token", ".", "length", "(", ")", ";", "int", "end", "=", "start", ";", "char", "c", ";", "do", "{", "c", "=", "rrule", ".", "charAt", "(", "end", "+", "+", ")", ";", "if", "(", "!", "Character", ".", "isLetterOrDigit", "(", "c", ")", "|", "|", "(", "end", "=", "=", "len", ")", ")", "{", "if", "(", "end", "=", "=", "len", ")", "end", "+", "+", ";", "return", "rrule", ".", "substring", "(", "start", ",", "end", "-", "1", ")", ";", "}", "}", "while", "(", "true", ")", ";", "}", "</s>"]
["<s>", "static", "public", "void", "recurrenceFromRrule", "(", "String", "rrule", ",", "long", "startTime", ",", "Serializer", "s", ")", "throws", "IOException", "{", "Log", ".", "d", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", "+", "rrule", ")", ";", "String", "freq", "=", "tokenFromRrule", "(", "rrule", ",", "\"", "<STR_LIT>", "\"", ")", ";", "if", "(", "freq", "!", "=", "null", ")", "{", "if", "(", "freq", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "s", ".", "start", "(", "Tags", ".", "CALENDAR_RECURRENCE", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_RECURRENCE_TYPE", ",", "\"", "<STR_LIT:0>", "\"", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_RECURRENCE_INTERVAL", ",", "\"", "<STR_LIT:1>", "\"", ")", ";", "s", ".", "end", "(", ")", ";", "}", "else", "if", "(", "freq", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "s", ".", "start", "(", "Tags", ".", "CALENDAR_RECURRENCE", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_RECURRENCE_TYPE", ",", "\"", "<STR_LIT:1>", "\"", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_RECURRENCE_INTERVAL", ",", "\"", "<STR_LIT:1>", "\"", ")", ";", "String", "byDay", "=", "tokenFromRrule", "(", "rrule", ",", "\"", "<STR_LIT>", "\"", ")", ";", "if", "(", "byDay", "!", "=", "null", ")", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_RECURRENCE_DAYOFWEEK", ",", "generateEasDayOfWeek", "(", "byDay", ")", ")", ";", "}", "s", ".", "end", "(", ")", ";", "}", "else", "if", "(", "freq", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "String", "byMonthDay", "=", "tokenFromRrule", "(", "rrule", ",", "\"", "<STR_LIT>", "\"", ")", ";", "if", "(", "byMonthDay", "!", "=", "null", ")", "{", "s", ".", "start", "(", "Tags", ".", "CALENDAR_RECURRENCE", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_RECURRENCE_TYPE", ",", "\"", "<STR_LIT:2>", "\"", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_RECURRENCE_DAYOFMONTH", ",", "byMonthDay", ")", ";", "s", ".", "end", "(", ")", ";", "}", "else", "{", "String", "byDay", "=", "tokenFromRrule", "(", "rrule", ",", "\"", "<STR_LIT>", "\"", ")", ";", "String", "bareByDay", ";", "if", "(", "byDay", "!", "=", "null", ")", "{", "int", "wom", "=", "byDay", ".", "charAt", "(", "0", ")", ";", "if", "(", "wom", "=", "=", "<CHAR_LIT:->", ")", "{", "wom", "=", "<NUM_LIT:5>", ";", "bareByDay", "=", "byDay", ".", "substring", "(", "<NUM_LIT:2>", ")", ";", "}", "else", "{", "wom", "=", "wom", "-", "<CHAR_LIT:0>", ";", "bareByDay", "=", "byDay", ".", "substring", "(", "1", ")", ";", "}", "s", ".", "start", "(", "Tags", ".", "CALENDAR_RECURRENCE", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_RECURRENCE_TYPE", ",", "\"", "<STR_LIT:3>", "\"", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_RECURRENCE_WEEKOFMONTH", ",", "Integer", ".", "toString", "(", "wom", ")", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_RECURRENCE_DAYOFWEEK", ",", "generateEasDayOfWeek", "(", "bareByDay", ")", ")", ";", "s", ".", "end", "(", ")", ";", "}", "}", "}", "else", "if", "(", "freq", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "String", "byMonth", "=", "tokenFromRrule", "(", "rrule", ",", "\"", "<STR_LIT>", "\"", ")", ";", "String", "byMonthDay", "=", "tokenFromRrule", "(", "rrule", ",", "\"", "<STR_LIT>", "\"", ")", ";", "if", "(", "byMonth", "=", "=", "null", "|", "|", "byMonthDay", "=", "=", "null", ")", "{", "GregorianCalendar", "cal", "=", "new", "GregorianCalendar", "(", ")", ";", "cal", ".", "setTimeInMillis", "(", "startTime", ")", ";", "cal", ".", "setTimeZone", "(", "TimeZone", ".", "getDefault", "(", ")", ")", ";", "byMonth", "=", "Integer", ".", "toString", "(", "cal", ".", "get", "(", "Calendar", ".", "MONTH", ")", "+", "1", ")", ";", "byMonthDay", "=", "Integer", ".", "toString", "(", "cal", ".", "get", "(", "Calendar", ".", "DAY_OF_MONTH", ")", ")", ";", "}", "s", ".", "start", "(", "Tags", ".", "CALENDAR_RECURRENCE", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_RECURRENCE_TYPE", ",", "\"", "<STR_LIT:5>", "\"", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_RECURRENCE_DAYOFMONTH", ",", "byMonthDay", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_RECURRENCE_MONTHOFYEAR", ",", "byMonth", ")", ";", "s", ".", "end", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "public", "void", "parse", "(", "String", "str", ")", "throws", "DateException", "{", "sign", "=", "1", ";", "weeks", "=", "0", ";", "days", "=", "0", ";", "hours", "=", "0", ";", "minutes", "=", "0", ";", "seconds", "=", "0", ";", "int", "len", "=", "str", ".", "length", "(", ")", ";", "int", "index", "=", "0", ";", "char", "c", ";", "if", "(", "len", "<", "1", ")", "{", "return", ";", "}", "c", "=", "str", ".", "charAt", "(", "0", ")", ";", "if", "(", "c", "=", "=", "<CHAR_LIT:->", ")", "{", "sign", "=", "-", "1", ";", "index", "+", "+", ";", "}", "else", "if", "(", "c", "=", "=", "<CHAR_LIT>", ")", "{", "index", "+", "+", ";", "}", "if", "(", "len", "<", "index", ")", "{", "return", ";", "}", "c", "=", "str", ".", "charAt", "(", "index", ")", ";", "if", "(", "c", "!", "=", "<CHAR_LIT>", ")", "{", "throw", "new", "DateException", "(", "\"", "<STR_LIT>", "\"", "+", "str", "+", "\"", "<STR_LIT>", "\"", "+", "index", ")", ";", "}", "index", "+", "+", ";", "int", "n", "=", "0", ";", "for", "(", ";", "index", "<", "len", ";", "index", "+", "+", ")", "{", "c", "=", "str", ".", "charAt", "(", "index", ")", ";", "if", "(", "c", ">", "=", "<CHAR_LIT:0>", "&", "&", "c", "<", "=", "<CHAR_LIT:9>", ")", "{", "n", "*", "=", "<NUM_LIT:10>", ";", "n", "+", "=", "(", "c", "-", "<CHAR_LIT:0>", ")", ";", "}", "else", "if", "(", "c", "=", "=", "<CHAR_LIT>", ")", "{", "weeks", "=", "n", ";", "n", "=", "0", ";", "}", "else", "if", "(", "c", "=", "=", "<CHAR_LIT>", ")", "{", "hours", "=", "n", ";", "n", "=", "0", ";", "}", "else", "if", "(", "c", "=", "=", "<CHAR_LIT>", ")", "{", "minutes", "=", "n", ";", "n", "=", "0", ";", "}", "else", "if", "(", "c", "=", "=", "<CHAR_LIT>", ")", "{", "seconds", "=", "n", ";", "n", "=", "0", ";", "}", "else", "if", "(", "c", "=", "=", "<CHAR_LIT>", ")", "{", "days", "=", "n", ";", "n", "=", "0", ";", "}", "else", "if", "(", "c", "=", "=", "<CHAR_LIT>", ")", "{", "}", "else", "{", "throw", "new", "DateException", "(", "\"", "<STR_LIT>", "\"", "+", "str", "+", "\"", "<STR_LIT>", "\"", "+", "c", "+", "\"", "<STR_LIT>", "\"", "+", "index", ")", ";", "}", "}", "}", "</s>"]
["<s>", "public", "void", "addTo", "(", "Calendar", "cal", ")", "{", "cal", ".", "add", "(", "Calendar", ".", "DAY_OF_MONTH", ",", "sign", "*", "weeks", "*", "<NUM_LIT:7>", ")", ";", "cal", ".", "add", "(", "Calendar", ".", "DAY_OF_MONTH", ",", "sign", "*", "days", ")", ";", "cal", ".", "add", "(", "Calendar", ".", "HOUR", ",", "sign", "*", "hours", ")", ";", "cal", ".", "add", "(", "Calendar", ".", "MINUTE", ",", "sign", "*", "minutes", ")", ";", "cal", ".", "add", "(", "Calendar", ".", "SECOND", ",", "sign", "*", "seconds", ")", ";", "}", "</s>"]
["<s>", "public", "long", "addTo", "(", "long", "dt", ")", "{", "return", "dt", "+", "getMillis", "(", ")", ";", "}", "</s>"]
["<s>", "public", "long", "getMillis", "(", ")", "{", "long", "factor", "=", "<NUM_LIT:1000>", "*", "sign", ";", "return", "factor", "*", "(", "(", "<NUM_LIT:7>", "*", "<NUM_LIT:24>", "*", "<NUM_LIT>", "*", "<NUM_LIT>", "*", "weeks", ")", "+", "(", "<NUM_LIT:24>", "*", "<NUM_LIT>", "*", "<NUM_LIT>", "*", "days", ")", "+", "(", "<NUM_LIT>", "*", "<NUM_LIT>", "*", "hours", ")", "+", "(", "<NUM_LIT>", "*", "minutes", ")", "+", "seconds", ")", ";", "}", "</s>"]
["<s>", "private", "void", "sendEvent", "(", "Entity", "entity", ",", "String", "clientId", ",", "Serializer", "s", ")", "throws", "IOException", "{", "ContentValues", "entityValues", "=", "entity", ".", "getEntityValues", "(", ")", ";", "boolean", "isException", "=", "(", "clientId", "=", "=", "null", ")", ";", "if", "(", "entityValues", ".", "containsKey", "(", "Events", ".", "ALL_DAY", ")", ")", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_ALL_DAY_EVENT", ",", "entityValues", ".", "getAsInteger", "(", "Events", ".", "ALL_DAY", ")", ".", "toString", "(", ")", ")", ";", "}", "long", "startTime", "=", "entityValues", ".", "getAsLong", "(", "Events", ".", "DTSTART", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_START_TIME", ",", "CalendarUtilities", ".", "millisToEasDateTime", "(", "startTime", ")", ")", ";", "if", "(", "!", "entityValues", ".", "containsKey", "(", "Events", ".", "DURATION", ")", ")", "{", "if", "(", "entityValues", ".", "containsKey", "(", "Events", ".", "DTEND", ")", ")", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_END_TIME", ",", "CalendarUtilities", ".", "millisToEasDateTime", "(", "entityValues", ".", "getAsLong", "(", "Events", ".", "DTEND", ")", ")", ")", ";", "}", "}", "else", "{", "long", "durationMillis", "=", "HOURS", ";", "Duration", "duration", "=", "new", "Duration", "(", ")", ";", "try", "{", "duration", ".", "parse", "(", "entityValues", ".", "getAsString", "(", "Events", ".", "DURATION", ")", ")", ";", "}", "catch", "(", "DateException", "e", ")", "{", "}", "s", ".", "data", "(", "Tags", ".", "CALENDAR_END_TIME", ",", "CalendarUtilities", ".", "millisToEasDateTime", "(", "startTime", "+", "durationMillis", ")", ")", ";", "}", "s", ".", "data", "(", "Tags", ".", "CALENDAR_DTSTAMP", ",", "CalendarUtilities", ".", "millisToEasDateTime", "(", "System", ".", "currentTimeMillis", "(", ")", ")", ")", ";", "if", "(", "entityValues", ".", "containsKey", "(", "Events", ".", "EVENT_LOCATION", ")", ")", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_LOCATION", ",", "entityValues", ".", "getAsString", "(", "Events", ".", "EVENT_LOCATION", ")", ")", ";", "}", "if", "(", "entityValues", ".", "containsKey", "(", "Events", ".", "TITLE", ")", ")", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_SUBJECT", ",", "entityValues", ".", "getAsString", "(", "Events", ".", "TITLE", ")", ")", ";", "}", "if", "(", "entityValues", ".", "containsKey", "(", "Events", ".", "VISIBILITY", ")", ")", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_SENSITIVITY", ",", "decodeVisibility", "(", "entityValues", ".", "getAsInteger", "(", "Events", ".", "VISIBILITY", ")", ")", ")", ";", "}", "else", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_SENSITIVITY", ",", "\"", "<STR_LIT:1>", "\"", ")", ";", "}", "if", "(", "!", "isException", ")", "{", "String", "timeZoneName", ";", "if", "(", "entityValues", ".", "containsKey", "(", "Events", ".", "EVENT_TIMEZONE", ")", ")", "{", "timeZoneName", "=", "entityValues", ".", "getAsString", "(", "Events", ".", "EVENT_TIMEZONE", ")", ";", "}", "else", "{", "timeZoneName", "=", "TimeZone", ".", "getDefault", "(", ")", ".", "getID", "(", ")", ";", "}", "String", "x", "=", "CalendarUtilities", ".", "timeZoneToTZIString", "(", "timeZoneName", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_TIME_ZONE", ",", "x", ")", ";", "if", "(", "entityValues", ".", "containsKey", "(", "Events", ".", "DESCRIPTION", ")", ")", "{", "String", "desc", "=", "entityValues", ".", "getAsString", "(", "Events", ".", "DESCRIPTION", ")", ";", "if", "(", "mService", ".", "mProtocolVersionDouble", ">", "=", "<NUM_LIT>", ")", "{", "s", ".", "start", "(", "Tags", ".", "BASE_BODY", ")", ";", "s", ".", "data", "(", "Tags", ".", "BASE_TYPE", ",", "\"", "<STR_LIT:1>", "\"", ")", ";", "s", ".", "data", "(", "Tags", ".", "BASE_DATA", ",", "desc", ")", ";", "s", ".", "end", "(", ")", ";", "}", "else", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_BODY", ",", "desc", ")", ";", "}", "}", "if", "(", "entityValues", ".", "containsKey", "(", "Events", ".", "ORGANIZER", ")", ")", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_ORGANIZER_EMAIL", ",", "entityValues", ".", "getAsString", "(", "Events", ".", "ORGANIZER", ")", ")", ";", "}", "if", "(", "entityValues", ".", "containsKey", "(", "Events", ".", "RRULE", ")", ")", "{", "CalendarUtilities", ".", "recurrenceFromRrule", "(", "entityValues", ".", "getAsString", "(", "Events", ".", "RRULE", ")", ",", "startTime", ",", "s", ")", ";", "}", "ArrayList", "<", "NamedContentValues", ">", "subValues", "=", "entity", ".", "getSubValues", "(", ")", ";", "for", "(", "NamedContentValues", "ncv", ":", "subValues", ")", "{", "Uri", "ncvUri", "=", "ncv", ".", "uri", ";", "ContentValues", "ncvValues", "=", "ncv", ".", "values", ";", "if", "(", "ncvUri", ".", "equals", "(", "ExtendedProperties", ".", "CONTENT_URI", ")", ")", "{", "if", "(", "ncvValues", ".", "containsKey", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "clientId", "=", "ncvValues", ".", "getAsString", "(", "\"", "<STR_LIT>", "\"", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_UID", ",", "clientId", ")", ";", "}", "if", "(", "ncvValues", ".", "containsKey", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_DTSTAMP", ",", "ncvValues", ".", "getAsString", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "if", "(", "ncvValues", ".", "containsKey", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "String", "categories", "=", "ncvValues", ".", "getAsString", "(", "\"", "<STR_LIT>", "\"", ")", ";", "StringTokenizer", "st", "=", "new", "StringTokenizer", "(", "categories", ",", "CATEGORY_TOKENIZER_DELIMITER", ")", ";", "if", "(", "st", ".", "countTokens", "(", ")", ">", "0", ")", "{", "s", ".", "start", "(", "Tags", ".", "CALENDAR_CATEGORIES", ")", ";", "while", "(", "st", ".", "hasMoreTokens", "(", ")", ")", "{", "String", "category", "=", "st", ".", "nextToken", "(", ")", ";", "s", ".", "data", "(", "Tags", ".", "CALENDAR_CATEGORY", ",", "category", ")", ";", "}", "s", ".", "end", "(", ")", ";", "}", "}", "}", "else", "if", "(", "ncvUri", ".", "equals", "(", "Reminders", ".", "CONTENT_URI", ")", ")", "{", "if", "(", "ncvValues", ".", "containsKey", "(", "Reminders", ".", "MINUTES", ")", ")", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_REMINDER_MINS_BEFORE", ",", "ncvValues", ".", "getAsString", "(", "Reminders", ".", "MINUTES", ")", ")", ";", "}", "}", "}", "s", ".", "data", "(", "Tags", ".", "CALENDAR_UID", ",", "clientId", ")", ";", "boolean", "hasAttendees", "=", "false", ";", "String", "organizerName", "=", "null", ";", "for", "(", "NamedContentValues", "ncv", ":", "subValues", ")", "{", "Uri", "ncvUri", "=", "ncv", ".", "uri", ";", "ContentValues", "ncvValues", "=", "ncv", ".", "values", ";", "if", "(", "ncvUri", ".", "equals", "(", "Attendees", ".", "CONTENT_URI", ")", ")", "{", "if", "(", "ncvValues", ".", "containsKey", "(", "Attendees", ".", "ATTENDEE_RELATIONSHIP", ")", ")", "{", "int", "relationship", "=", "ncvValues", ".", "getAsInteger", "(", "Attendees", ".", "ATTENDEE_RELATIONSHIP", ")", ";", "if", "(", "relationship", "=", "=", "Attendees", ".", "RELATIONSHIP_ORGANIZER", ")", "{", "if", "(", "ncvValues", ".", "containsKey", "(", "Attendees", ".", "ATTENDEE_NAME", ")", ")", "{", "organizerName", "=", "ncvValues", ".", "getAsString", "(", "Attendees", ".", "ATTENDEE_NAME", ")", ";", "}", "continue", ";", "}", "if", "(", "!", "hasAttendees", ")", "{", "s", ".", "start", "(", "Tags", ".", "CALENDAR_ATTENDEES", ")", ";", "hasAttendees", "=", "true", ";", "}", "s", ".", "start", "(", "Tags", ".", "CALENDAR_ATTENDEE", ")", ";", "if", "(", "ncvValues", ".", "containsKey", "(", "Attendees", ".", "ATTENDEE_NAME", ")", ")", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_ATTENDEE_NAME", ",", "ncvValues", ".", "getAsString", "(", "Attendees", ".", "ATTENDEE_NAME", ")", ")", ";", "}", "if", "(", "ncvValues", ".", "containsKey", "(", "Attendees", ".", "ATTENDEE_EMAIL", ")", ")", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_ATTENDEE_EMAIL", ",", "ncvValues", ".", "getAsString", "(", "Attendees", ".", "ATTENDEE_EMAIL", ")", ")", ";", "}", "s", ".", "data", "(", "Tags", ".", "CALENDAR_ATTENDEE_TYPE", ",", "\"", "<STR_LIT:1>", "\"", ")", ";", "s", ".", "end", "(", ")", ";", "}", "}", "}", "if", "(", "hasAttendees", ")", "{", "s", ".", "end", "(", ")", ";", "}", "if", "(", "organizerName", "!", "=", "null", ")", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_ORGANIZER_NAME", ",", "organizerName", ")", ";", "}", "}", "else", "{", "if", "(", "entityValues", ".", "containsKey", "(", "Events", ".", "ORIGINAL_INSTANCE_TIME", ")", ")", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_EXCEPTION_START_TIME", ",", "CalendarUtilities", ".", "millisToEasDateTime", "(", "entityValues", ".", "getAsLong", "(", "Events", ".", "ORIGINAL_INSTANCE_TIME", ")", ")", ")", ";", "}", "else", "{", "}", "}", "}", "</s>"]
["<s>", "public", "synchronized", "String", "getDeviceUID", "(", ")", "{", "String", "result", "=", "mSharedPreferences", ".", "getString", "(", "DEVICE_UID", ",", "null", ")", ";", "if", "(", "result", "=", "=", "null", ")", "{", "result", "=", "UUID", ".", "randomUUID", "(", ")", ".", "toString", "(", ")", ";", "mSharedPreferences", ".", "edit", "(", ")", ".", "putString", "(", "DEVICE_UID", ",", "result", ")", ".", "commit", "(", ")", ";", "}", "return", "result", ";", "}", "</s>"]
["<s>", "public", "String", "getImapIdValues", "(", "String", "userName", ",", "String", "host", ",", "String", "capabilities", ")", "{", "Bundle", "params", "=", "new", "Bundle", "(", ")", ";", "params", ".", "putString", "(", "GET_IMAP_ID_USER", ",", "userName", ")", ";", "params", ".", "putString", "(", "GET_IMAP_ID_HOST", ",", "host", ")", ";", "params", ".", "putString", "(", "GET_IMAP_ID_CAPA", ",", "capabilities", ")", ";", "String", "result", "=", "getPolicy", "(", "GET_IMAP_ID", ",", "params", ")", ".", "getString", "(", "GET_IMAP_ID", ")", ";", "return", "result", ";", "}", "</s>"]
["<s>", "public", "Provider", "findProviderForDomain", "(", "String", "domain", ")", "{", "Bundle", "params", "=", "new", "Bundle", "(", ")", ";", "params", ".", "putString", "(", "FIND_PROVIDER", ",", "domain", ")", ";", "Bundle", "out", "=", "getPolicy", "(", "FIND_PROVIDER", ",", "params", ")", ";", "if", "(", "out", "!", "=", "null", ")", "{", "try", "{", "Provider", "p", "=", "new", "Provider", "(", ")", ";", "p", ".", "id", "=", "null", ";", "p", ".", "label", "=", "null", ";", "p", ".", "domain", "=", "domain", ";", "p", ".", "incomingUriTemplate", "=", "new", "URI", "(", "out", ".", "getString", "(", "FIND_PROVIDER_IN_URI", ")", ")", ";", "p", ".", "incomingUsernameTemplate", "=", "out", ".", "getString", "(", "FIND_PROVIDER_IN_USER", ")", ";", "p", ".", "outgoingUriTemplate", "=", "new", "URI", "(", "out", ".", "getString", "(", "FIND_PROVIDER_OUT_URI", ")", ")", ";", "p", ".", "outgoingUsernameTemplate", "=", "out", ".", "getString", "(", "FIND_PROVIDER_OUT_USER", ")", ";", "p", ".", "note", "=", "out", ".", "getString", "(", "FIND_PROVIDER_NOTE", ")", ";", "return", "p", ";", "}", "catch", "(", "URISyntaxException", "e", ")", "{", "Log", ".", "d", "(", "Email", ".", "LOG_TAG", ",", "\"", "<STR_LIT>", "\"", "+", "domain", ")", ";", "}", "}", "return", "null", ";", "}", "</s>"]
["<s>", "public", "String", "getImapId", "(", "Context", "context", ",", "String", "userName", ",", "String", "host", ")", "{", "synchronized", "(", "ImapStore", ".", "class", ")", "{", "if", "(", "sImapId", "=", "=", "null", ")", "{", "String", "networkOperator", "=", "TelephonyManager", ".", "getDefault", "(", ")", ".", "getNetworkOperatorName", "(", ")", ";", "if", "(", "networkOperator", "=", "=", "null", ")", "networkOperator", "=", "\"", "\"", ";", "sImapId", "=", "makeCommonImapId", "(", "context", ".", "getPackageName", "(", ")", ",", "Build", ".", "VERSION", ".", "RELEASE", ",", "Build", ".", "VERSION", ".", "CODENAME", ",", "Build", ".", "MODEL", ",", "Build", ".", "ID", ",", "Build", ".", "MANUFACTURER", ",", "networkOperator", ")", ";", "}", "}", "StringBuilder", "id", "=", "new", "StringBuilder", "(", "sImapId", ")", ";", "String", "vendorId", "=", "VendorPolicyLoader", ".", "getInstance", "(", "context", ")", ".", "getImapIdValues", "(", "userName", ",", "host", ",", "null", ")", ";", "if", "(", "vendorId", "!", "=", "null", ")", "{", "id", ".", "append", "(", "<CHAR_LIT>", ")", ";", "id", ".", "append", "(", "vendorId", ")", ";", "}", "try", "{", "String", "devUID", "=", "Preferences", ".", "getPreferences", "(", "context", ")", ".", "getDeviceUID", "(", ")", ";", "MessageDigest", "messageDigest", ";", "messageDigest", "=", "MessageDigest", ".", "getInstance", "(", "\"", "<STR_LIT>", "\"", ")", ";", "messageDigest", ".", "update", "(", "userName", ".", "getBytes", "(", ")", ")", ";", "messageDigest", ".", "update", "(", "devUID", ".", "getBytes", "(", ")", ")", ";", "byte", "[", "]", "uid", "=", "messageDigest", ".", "digest", "(", ")", ";", "String", "hexUid", "=", "new", "String", "(", "new", "Base64", "(", ")", ".", "encode", "(", "uid", ")", ")", ";", "id", ".", "append", "(", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "\"", ")", ";", "id", ".", "append", "(", "hexUid", ")", ";", "id", ".", "append", "(", "<STR_LIT:\\\">", ")", ";", "}", "catch", "(", "NoSuchAlgorithmException", "e", ")", "{", "Log", ".", "d", "(", "Email", ".", "LOG_TAG", ",", "\"", "<STR_LIT>", "\"", ")", ";", "}", "return", "id", ".", "toString", "(", ")", ";", "}", "</s>"]
["<s>", "String", "makeCommonImapId", "(", "String", "packageName", ",", "String", "version", ",", "String", "codeName", ",", "String", "model", ",", "String", "id", ",", "String", "vendor", ",", "String", "networkOperator", ")", "{", "Pattern", "p", "=", "Pattern", ".", "compile", "(", "\"", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "<STR_LIT:\\\\>", "<STR_LIT>", "\"", ")", ";", "packageName", "=", "p", ".", "matcher", "(", "packageName", ")", ".", "replaceAll", "(", "\"", "\"", ")", ";", "version", "=", "p", ".", "matcher", "(", "version", ")", ".", "replaceAll", "(", "\"", "\"", ")", ";", "codeName", "=", "p", ".", "matcher", "(", "codeName", ")", ".", "replaceAll", "(", "\"", "\"", ")", ";", "model", "=", "p", ".", "matcher", "(", "model", ")", ".", "replaceAll", "(", "\"", "\"", ")", ";", "id", "=", "p", ".", "matcher", "(", "id", ")", ".", "replaceAll", "(", "\"", "\"", ")", ";", "vendor", "=", "p", ".", "matcher", "(", "vendor", ")", ".", "replaceAll", "(", "\"", "\"", ")", ";", "networkOperator", "=", "p", ".", "matcher", "(", "networkOperator", ")", ".", "replaceAll", "(", "\"", "\"", ")", ";", "StringBuffer", "sb", "=", "new", "StringBuffer", "(", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "\"", ")", ";", "sb", ".", "append", "(", "packageName", ")", ";", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "\"", ")", ";", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "\"", ")", ";", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "\"", ")", ";", "if", "(", "version", ".", "length", "(", ")", ">", "0", ")", "{", "sb", ".", "append", "(", "version", ")", ";", "}", "else", "{", "sb", ".", "append", "(", "\"", "<STR_LIT:1.0>", "\"", ")", ";", "}", "if", "(", "id", ".", "length", "(", ")", ">", "0", ")", "{", "sb", ".", "append", "(", "\"", "<STR_LIT>", "\"", ")", ";", "sb", ".", "append", "(", "id", ")", ";", "}", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "\"", ")", ";", "if", "(", "vendor", ".", "length", "(", ")", ">", "0", ")", "{", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "\"", ")", ";", "sb", ".", "append", "(", "vendor", ")", ";", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "\"", ")", ";", "}", "if", "(", "\"", "<STR_LIT>", "\"", ".", "equals", "(", "codeName", ")", ")", "{", "if", "(", "model", ".", "length", "(", ")", ">", "0", ")", "{", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "\"", ")", ";", "sb", ".", "append", "(", "model", ")", ";", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "\"", ")", ";", "}", "}", "if", "(", "networkOperator", ".", "length", "(", ")", ">", "0", ")", "{", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT:\\\">", "\"", ")", ";", "sb", ".", "append", "(", "networkOperator", ")", ";", "sb", ".", "append", "(", "\"", "<STR_LIT:\\\">", "\"", ")", ";", "}", "return", "sb", ".", "toString", "(", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testGetImapIdValues", "(", ")", "{", "VendorPolicyLoader", "pl", "=", "VendorPolicyLoader", ".", "getInstance", "(", "getContext", "(", ")", ")", ";", "String", "id", "=", "pl", ".", "getImapIdValues", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "if", "(", "id", "=", "=", "null", ")", "return", ";", "assertEquals", "(", "\"", "<STR_LIT:\\\">", "\"", ",", "id", ".", "charAt", "(", "0", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT:\\\">", "\"", ",", "id", ".", "charAt", "(", "id", ".", "length", "(", ")", "-", "1", ")", ")", ";", "String", "[", "]", "elements", "=", "id", ".", "split", "(", "\"", "<STR_LIT:\\\">", "\"", ")", ";", "assertEquals", "(", "0", ",", "elements", ".", "length", "%", "<NUM_LIT:4>", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "elements", ".", "length", ";", ")", "{", "assertTrue", "(", "elements", "[", "i", "]", "=", "=", "null", "|", "|", "elements", "[", "i", "]", ".", "startsWith", "(", "\"", "\"", ")", ")", ";", "assertTrue", "(", "elements", "[", "i", "+", "1", "]", ".", "charAt", "(", "0", ")", "!", "=", "<CHAR_LIT>", ")", ";", "assertTrue", "(", "elements", "[", "i", "+", "<NUM_LIT:2>", "]", ".", "startsWith", "(", "\"", "\"", ")", ")", ";", "assertTrue", "(", "elements", "[", "i", "+", "<NUM_LIT:3>", "]", ".", "charAt", "(", "0", ")", "!", "=", "<CHAR_LIT>", ")", ";", "i", "+", "=", "<NUM_LIT:4>", ";", "}", "}", "</s>"]
["<s>", "public", "void", "testImapIdBasic", "(", ")", "{", "String", "id", "=", "mStore", ".", "getImapId", "(", "getContext", "(", ")", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "HashMap", "<", "String", ",", "String", ">", "map", "=", "tokenizeImapId", "(", "id", ")", ";", "assertEquals", "(", "getContext", "(", ")", ".", "getPackageName", "(", ")", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertNotNull", "(", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertNotNull", "(", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertNotNull", "(", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "id", "=", "mStore", ".", "makeCommonImapId", "(", "\"", "<STR_LIT:Name>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:Name>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "map", "=", "tokenizeImapId", "(", "id", ")", ";", "assertEquals", "(", "\"", "<STR_LIT:Name>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "null", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "null", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "id", "=", "mStore", ".", "makeCommonImapId", "(", "\"", "<STR_LIT:Name>", "\"", ",", "\"", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "\"", ")", ";", "map", "=", "tokenizeImapId", "(", "id", ")", ";", "assertEquals", "(", "\"", "<STR_LIT:Name>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "null", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "null", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testImapIdFiltering", "(", ")", "{", "String", "id", "=", "mStore", ".", "makeCommonImapId", "(", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT:Name>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "<STR_LIT:\\\">", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", ",", "\"", "<STR_LIT>", "<STR_LIT:\\\">", "\"", ")", ";", "HashMap", "<", "String", ",", "String", ">", "map", "=", "tokenizeImapId", "(", "id", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertNull", "(", "map", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testImapIdDeviceId", "(", ")", "throws", "MessagingException", "{", "ImapStore", "store1a", "=", "(", "ImapStore", ")", "ImapStore", ".", "newInstance", "(", "\"", "<STR_LIT>", "\"", ",", "getContext", "(", ")", ",", "null", ")", ";", "ImapStore", "store1b", "=", "(", "ImapStore", ")", "ImapStore", ".", "newInstance", "(", "\"", "<STR_LIT>", "\"", ",", "getContext", "(", ")", ",", "null", ")", ";", "ImapStore", "store2", "=", "(", "ImapStore", ")", "ImapStore", ".", "newInstance", "(", "\"", "<STR_LIT>", "\"", ",", "getContext", "(", ")", ",", "null", ")", ";", "String", "id1a", "=", "mStore", ".", "getImapId", "(", "getContext", "(", ")", ",", "\"", "<STR_LIT:1>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "String", "id1b", "=", "mStore", ".", "getImapId", "(", "getContext", "(", ")", ",", "\"", "<STR_LIT:1>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "String", "id2", "=", "mStore", ".", "getImapId", "(", "getContext", "(", ")", ",", "\"", "<STR_LIT:2>", "\"", ",", "\"", "<STR_LIT>", "\"", ")", ";", "String", "uid1a", "=", "tokenizeImapId", "(", "id1a", ")", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ";", "String", "uid1b", "=", "tokenizeImapId", "(", "id1b", ")", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ";", "String", "uid2", "=", "tokenizeImapId", "(", "id2", ")", ".", "get", "(", "\"", "<STR_LIT>", "\"", ")", ";", "assertEquals", "(", "uid1a", ",", "uid1b", ")", ";", "MoreAsserts", ".", "assertNotEqual", "(", "uid1a", ",", "uid2", ")", ";", "}", "</s>"]
["<s>", "private", "HashMap", "<", "String", ",", "String", ">", "tokenizeImapId", "(", "String", "id", ")", "{", "String", "[", "]", "elements", "=", "id", ".", "split", "(", "\"", "<STR_LIT:\\\">", "\"", ")", ";", "HashMap", "<", "String", ",", "String", ">", "map", "=", "new", "HashMap", "<", "String", ",", "String", ">", "(", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "elements", ".", "length", ";", ")", "{", "map", ".", "put", "(", "elements", "[", "i", "+", "1", "]", ",", "elements", "[", "i", "+", "<NUM_LIT:3>", "]", ")", ";", "i", "+", "=", "<NUM_LIT:4>", ";", "}", "return", "map", ";", "}", "</s>"]
["<s>", "public", "void", "testGenerateEasDayOfWeek", "(", ")", "{", "String", "byDay", "=", "\"", "<STR_LIT>", "\"", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "CalendarUtilities", ".", "generateEasDayOfWeek", "(", "byDay", ")", ")", ";", "byDay", "=", "\"", "<STR_LIT>", "\"", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "CalendarUtilities", ".", "generateEasDayOfWeek", "(", "byDay", ")", ")", ";", "byDay", "=", "\"", "<STR_LIT>", "\"", ";", "assertEquals", "(", "\"", "<STR_LIT:1>", "\"", ",", "CalendarUtilities", ".", "generateEasDayOfWeek", "(", "byDay", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testTokenFromRrule", "(", ")", "{", "String", "rrule", "=", "\"", "<STR_LIT>", "\"", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "CalendarUtilities", ".", "tokenFromRrule", "(", "rrule", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT:1>", "\"", ",", "CalendarUtilities", ".", "tokenFromRrule", "(", "rrule", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "CalendarUtilities", ".", "tokenFromRrule", "(", "rrule", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertNull", "(", "CalendarUtilities", ".", "tokenFromRrule", "(", "rrule", ",", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "</s>"]
["<s>", "private", "synchronized", "DevicePolicyManager", "getDPM", "(", ")", "{", "if", "(", "mDPM", "=", "=", "null", ")", "{", "mDPM", "=", "(", "DevicePolicyManager", ")", "mContext", ".", "getSystemService", "(", "Context", ".", "DEVICE_POLICY_SERVICE", ")", ";", "}", "return", "mDPM", ";", "}", "</s>"]
["<s>", "public", "synchronized", "void", "updatePolicies", "(", ")", "{", "mAggregatePolicy", "=", "null", ";", "}", "</s>"]
["<s>", "public", "int", "getDPManagerPasswordMode", "(", ")", "{", "switch", "(", "mPasswordMode", ")", "{", "case", "PASSWORD_MODE_SIMPLE", ":", "return", "DevicePolicyManager", ".", "PASSWORD_QUALITY_NUMERIC", ";", "case", "PASSWORD_MODE_STRONG", ":", "return", "DevicePolicyManager", ".", "PASSWORD_QUALITY_ALPHANUMERIC", ";", "default", ":", "return", "DevicePolicyManager", ".", "PASSWORD_QUALITY_UNSPECIFIED", ";", "}", "}", "</s>"]
["<s>", "@", "Override", "public", "String", "getPackageName", "(", ")", "{", "return", "mRealContext", ".", "getPackageName", "(", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testFindProviderForDomain", "(", ")", "{", "VendorPolicyLoader", "pl", "=", "VendorPolicyLoader", ".", "getInstance", "(", "getContext", "(", ")", ")", ";", "Provider", "p", "=", "pl", ".", "findProviderForDomain", "(", "\"", "<STR_LIT>", "\"", ")", ";", "if", "(", "p", "=", "=", "null", ")", "return", ";", "assertNull", "(", "p", ".", "id", ")", ";", "assertNull", "(", "p", ".", "label", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "p", ".", "domain", ")", ";", "assertNotNull", "(", "p", ".", "incomingUriTemplate", ")", ";", "assertNotNull", "(", "p", ".", "incomingUsernameTemplate", ")", ";", "assertNotNull", "(", "p", ".", "outgoingUriTemplate", ")", ";", "assertNotNull", "(", "p", ".", "outgoingUsernameTemplate", ")", ";", "assertTrue", "(", "p", ".", "note", "=", "=", "null", "|", "|", "p", ".", "note", ".", "length", "(", ")", ">", "0", ")", ";", "}", "</s>"]
["<s>", "public", "static", "void", "startExchangeService", "(", "Context", "context", ")", "{", "context", ".", "startService", "(", "new", "Intent", "(", "context", ",", "SyncManager", ".", "class", ")", ")", ";", "}", "</s>"]
["<s>", "public", "static", "IEmailService", "getExchangeEmailService", "(", "Context", "context", ",", "IEmailServiceCallback", "callback", ")", "{", "return", "new", "EmailServiceProxy", "(", "context", ",", "SyncManager", ".", "class", ",", "callback", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "onReceive", "(", "Context", "context", ",", "Intent", "intent", ")", "{", "if", "(", "Intent", ".", "ACTION_BOOT_COMPLETED", ".", "equals", "(", "intent", ".", "getAction", "(", ")", ")", ")", "{", "initialize", "(", "context", ")", ";", "}", "}", "</s>"]
["<s>", "private", "void", "initialize", "(", "Context", "context", ")", "{", "if", "(", "Config", ".", "LOGD", ")", "{", "Log", ".", "d", "(", "Email", ".", "LOG_TAG", ",", "\"", "<STR_LIT>", "\"", ")", ";", "}", "final", "Preferences", "pref", "=", "Preferences", ".", "getPreferences", "(", "context", ")", ";", "int", "progress", "=", "pref", ".", "getOneTimeInitializationProgress", "(", ")", ";", "if", "(", "progress", "<", "1", ")", "{", "progress", "=", "1", ";", "if", "(", "VendorPolicyLoader", ".", "getInstance", "(", "context", ")", ".", "useAlternateExchangeStrings", "(", ")", ")", "{", "setComponentEnabled", "(", "context", ",", "EasAuthenticatorServiceAlternate", ".", "class", ",", "true", ")", ";", "setComponentEnabled", "(", "context", ",", "EasAuthenticatorService", ".", "class", ",", "false", ")", ";", "}", "}", "pref", ".", "setOneTimeInitializationProgress", "(", "progress", ")", ";", "setComponentEnabled", "(", "context", ",", "getClass", "(", ")", ",", "false", ")", ";", "}", "</s>"]
["<s>", "private", "void", "setComponentEnabled", "(", "Context", "context", ",", "Class", "<", "?", ">", "clazz", ",", "boolean", "enabled", ")", "{", "final", "ComponentName", "c", "=", "new", "ComponentName", "(", "context", ",", "clazz", ".", "getName", "(", ")", ")", ";", "context", ".", "getPackageManager", "(", ")", ".", "setComponentEnabledSetting", "(", "c", ",", "enabled", "?", "PackageManager", ".", "COMPONENT_ENABLED_STATE_ENABLED", ":", "PackageManager", ".", "COMPONENT_ENABLED_STATE_DISABLED", ",", "PackageManager", ".", "DONT_KILL_APP", ")", ";", "}", "</s>"]
["<s>", "public", "int", "getOneTimeInitializationProgress", "(", ")", "{", "return", "mSharedPreferences", ".", "getInt", "(", "ONE_TIME_INITIALIZATION_PROGRESS", ",", "0", ")", ";", "}", "</s>"]
["<s>", "public", "void", "setOneTimeInitializationProgress", "(", "int", "progress", ")", "{", "mSharedPreferences", ".", "edit", "(", ")", ".", "putInt", "(", "ONE_TIME_INITIALIZATION_PROGRESS", ",", "progress", ")", ".", "commit", "(", ")", ";", "}", "</s>"]
["<s>", "void", "loadFields", "(", "Account", "account", ")", "{", "HostAuth", "hostAuth", "=", "account", ".", "mHostAuthRecv", ";", "String", "userName", "=", "hostAuth", ".", "mLogin", ";", "if", "(", "userName", "!", "=", "null", ")", "{", "if", "(", "userName", ".", "indexOf", "(", "<STR_LIT:\\\\>", ")", "<", "0", ")", "{", "userName", "=", "\"", "<STR_LIT:\\\\>", "\"", "+", "userName", ";", "}", "mUsernameView", ".", "setText", "(", "userName", ")", ";", "}", "if", "(", "hostAuth", ".", "mPassword", "!", "=", "null", ")", "{", "mPasswordView", ".", "setText", "(", "hostAuth", ".", "mPassword", ")", ";", "}", "String", "protocol", "=", "hostAuth", ".", "mProtocol", ";", "if", "(", "protocol", "=", "=", "null", "&", "&", "!", "protocol", ".", "startsWith", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "throw", "new", "Error", "(", "\"", "<STR_LIT>", "\"", "+", "account", ".", "getStoreUri", "(", "this", ")", ")", ";", "}", "if", "(", "hostAuth", ".", "mAddress", "!", "=", "null", ")", "{", "mServerView", ".", "setText", "(", "hostAuth", ".", "mAddress", ")", ";", "}", "boolean", "ssl", "=", "0", "!", "=", "(", "hostAuth", ".", "mFlags", "&", "HostAuth", ".", "FLAG_SSL", ")", ";", "boolean", "trustCertificates", "=", "0", "!", "=", "(", "hostAuth", ".", "mFlags", "&", "HostAuth", ".", "FLAG_TRUST_ALL_CERTIFICATES", ")", ";", "mSslSecurityView", ".", "setChecked", "(", "ssl", ")", ";", "mTrustCertificatesView", ".", "setChecked", "(", "trustCertificates", ")", ";", "mTrustCertificatesView", ".", "setVisibility", "(", "ssl", "?", "View", ".", "VISIBLE", ":", "View", ".", "GONE", ")", ";", "}", "</s>"]
["<s>", "@", "UiThreadTest", "public", "void", "testLoadFields", "(", ")", "{", "getActivityAndFields", "(", ")", ";", "assertFalse", "(", "mSslRequiredCheckbox", ".", "isChecked", "(", ")", ")", ";", "assertFalse", "(", "mTrustAllCertificatesCheckbox", ".", "isChecked", "(", ")", ")", ";", "assertFalse", "(", "mTrustAllCertificatesCheckbox", ".", "getVisibility", "(", ")", "=", "=", "View", ".", "VISIBLE", ")", ";", "Account", "account", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "false", ",", "mActivity", ".", "getBaseContext", "(", ")", ")", ";", "account", ".", "mHostAuthRecv", "=", "ProviderTestUtils", ".", "setupHostAuth", "(", "\"", "<STR_LIT>", "\"", ",", "1", ",", "false", ",", "mActivity", ".", "getBaseContext", "(", ")", ")", ";", "account", ".", "mHostAuthRecv", ".", "mFlags", "|", "=", "HostAuth", ".", "FLAG_SSL", ";", "account", ".", "mHostAuthRecv", ".", "mFlags", "&", "=", "~", "HostAuth", ".", "FLAG_TRUST_ALL_CERTIFICATES", ";", "mActivity", ".", "loadFields", "(", "account", ")", ";", "assertTrue", "(", "mSslRequiredCheckbox", ".", "isChecked", "(", ")", ")", ";", "assertFalse", "(", "mTrustAllCertificatesCheckbox", ".", "isChecked", "(", ")", ")", ";", "assertTrue", "(", "mTrustAllCertificatesCheckbox", ".", "getVisibility", "(", ")", "=", "=", "View", ".", "VISIBLE", ")", ";", "account", ".", "mHostAuthRecv", ".", "mFlags", "|", "=", "HostAuth", ".", "FLAG_TRUST_ALL_CERTIFICATES", ";", "mActivity", ".", "loadFields", "(", "account", ")", ";", "assertTrue", "(", "mSslRequiredCheckbox", ".", "isChecked", "(", ")", ")", ";", "assertTrue", "(", "mTrustAllCertificatesCheckbox", ".", "isChecked", "(", ")", ")", ";", "assertTrue", "(", "mTrustAllCertificatesCheckbox", ".", "getVisibility", "(", ")", "=", "=", "View", ".", "VISIBLE", ")", ";", "}", "</s>"]
["<s>", "public", "Bundle", "autoDiscover", "(", "String", "userName", ",", "String", "password", ")", "throws", "RemoteException", "{", "return", "Bundle", ".", "EMPTY", ";", "}", "</s>"]
["<s>", "public", "int", "validate", "(", "String", "protocol", ",", "String", "host", ",", "String", "userName", ",", "String", "password", ",", "int", "port", ",", "boolean", "ssl", ",", "boolean", "trustCertificates", ")", "throws", "RemoteException", "{", "return", "MessagingException", ".", "UNSPECIFIED_EXCEPTION", ";", "}", "</s>"]
["<s>", "static", "void", "putTimeInMillisIntoSystemTime", "(", "byte", "[", "]", "bytes", ",", "int", "offset", ",", "long", "millis", ")", "{", "GregorianCalendar", "cal", "=", "new", "GregorianCalendar", "(", "TimeZone", ".", "getDefault", "(", ")", ")", ";", "cal", ".", "setTimeInMillis", "(", "millis", "+", "<NUM_LIT:30>", "*", "SECONDS", ")", ";", "setWord", "(", "bytes", ",", "offset", "+", "MSFT_SYSTEMTIME_MONTH", ",", "cal", ".", "get", "(", "Calendar", ".", "MONTH", ")", "+", "1", ")", ";", "setWord", "(", "bytes", ",", "offset", "+", "MSFT_SYSTEMTIME_DAY_OF_WEEK", ",", "cal", ".", "get", "(", "Calendar", ".", "DAY_OF_WEEK", ")", "-", "1", ")", ";", "int", "wom", "=", "cal", ".", "get", "(", "Calendar", ".", "DAY_OF_WEEK_IN_MONTH", ")", ";", "setWord", "(", "bytes", ",", "offset", "+", "MSFT_SYSTEMTIME_DAY", ",", "wom", "<", "0", "?", "<NUM_LIT:5>", ":", "wom", ")", ";", "setWord", "(", "bytes", ",", "offset", "+", "MSFT_SYSTEMTIME_HOUR", ",", "cal", ".", "get", "(", "Calendar", ".", "HOUR", ")", ")", ";", "setWord", "(", "bytes", ",", "offset", "+", "MSFT_SYSTEMTIME_MINUTE", ",", "cal", ".", "get", "(", "Calendar", ".", "MINUTE", ")", ")", ";", "}", "</s>"]
["<s>", "static", "private", "long", "findTransition", "(", "TimeZone", "tz", ",", "long", "startTime", ",", "long", "endTime", ",", "boolean", "startInDaylightTime", ")", "{", "long", "startingEndTime", "=", "endTime", ";", "Date", "date", "=", "null", ";", "while", "(", "(", "endTime", "-", "startTime", ")", ">", "MINUTES", ")", "{", "long", "checkTime", "=", "(", "(", "startTime", "+", "endTime", ")", "/", "<NUM_LIT:2>", ")", "+", "1", ";", "date", "=", "new", "Date", "(", "checkTime", ")", ";", "if", "(", "tz", ".", "inDaylightTime", "(", "date", ")", "!", "=", "startInDaylightTime", ")", "{", "endTime", "=", "checkTime", ";", "}", "else", "{", "startTime", "=", "checkTime", ";", "}", "}", "if", "(", "endTime", "=", "=", "startingEndTime", ")", "{", "return", "0", ";", "}", "return", "startTime", ";", "}", "</s>"]
["<s>", "static", "public", "String", "timeZoneToTziString", "(", "TimeZone", "tz", ")", "{", "String", "tziString", "=", "sTziStringCache", ".", "get", "(", "tz", ")", ";", "if", "(", "tziString", "!", "=", "null", ")", "{", "if", "(", "Eas", ".", "USER_LOG", ")", "{", "Log", ".", "d", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", "+", "tz", ".", "getDisplayName", "(", ")", "+", "\"", "<STR_LIT>", "\"", ")", ";", "}", "return", "tziString", ";", "}", "tziString", "=", "timeZoneToTziStringImpl", "(", "tz", ")", ";", "sTziStringCache", ".", "put", "(", "tz", ",", "tziString", ")", ";", "return", "tziString", ";", "}", "</s>"]
["<s>", "static", "public", "String", "timeZoneToTziStringImpl", "(", "TimeZone", "tz", ")", "{", "String", "tziString", ";", "long", "time", "=", "System", ".", "currentTimeMillis", "(", ")", ";", "byte", "[", "]", "tziBytes", "=", "new", "byte", "[", "MSFT_TIME_ZONE_SIZE", "]", ";", "int", "standardBias", "=", "-", "tz", ".", "getRawOffset", "(", ")", ";", "standardBias", "/", "=", "<NUM_LIT>", "*", "SECONDS", ";", "setLong", "(", "tziBytes", ",", "MSFT_TIME_ZONE_BIAS_OFFSET", ",", "standardBias", ")", ";", "if", "(", "tz", ".", "useDaylightTime", "(", ")", ")", "{", "long", "standardTransition", "=", "0", ";", "long", "daylightTransition", "=", "0", ";", "GregorianCalendar", "cal", "=", "new", "GregorianCalendar", "(", ")", ";", "cal", ".", "set", "(", "sCurrentYear", ",", "Calendar", ".", "JANUARY", ",", "1", ",", "0", ",", "0", ",", "0", ")", ";", "cal", ".", "setTimeZone", "(", "tz", ")", ";", "long", "startTime", "=", "cal", ".", "getTimeInMillis", "(", ")", ";", "long", "endOfYearTime", "=", "startTime", "+", "<NUM_LIT>", "*", "DAYS", ";", "Date", "date", "=", "new", "Date", "(", "startTime", ")", ";", "boolean", "startInDaylightTime", "=", "tz", ".", "inDaylightTime", "(", "date", ")", ";", "startTime", "=", "findTransition", "(", "tz", ",", "startTime", ",", "endOfYearTime", ",", "startInDaylightTime", ")", ";", "if", "(", "startInDaylightTime", ")", "{", "standardTransition", "=", "startTime", ";", "}", "else", "{", "daylightTransition", "=", "startTime", ";", "}", "startTime", "=", "findTransition", "(", "tz", ",", "startTime", ",", "endOfYearTime", ",", "!", "startInDaylightTime", ")", ";", "if", "(", "startInDaylightTime", ")", "{", "daylightTransition", "=", "startTime", ";", "}", "else", "{", "standardTransition", "=", "startTime", ";", "}", "if", "(", "standardTransition", "!", "=", "0", "&", "&", "daylightTransition", "!", "=", "0", ")", "{", "putTimeInMillisIntoSystemTime", "(", "tziBytes", ",", "MSFT_TIME_ZONE_STANDARD_DATE_OFFSET", ",", "standardTransition", ")", ";", "putTimeInMillisIntoSystemTime", "(", "tziBytes", ",", "MSFT_TIME_ZONE_DAYLIGHT_DATE_OFFSET", ",", "daylightTransition", ")", ";", "int", "dstOffset", "=", "tz", ".", "getDSTSavings", "(", ")", ";", "setLong", "(", "tziBytes", ",", "MSFT_TIME_ZONE_DAYLIGHT_BIAS_OFFSET", ",", "-", "dstOffset", "/", "MINUTES", ")", ";", "}", "}", "byte", "[", "]", "tziEncodedBytes", "=", "Base64", ".", "encode", "(", "tziBytes", ")", ";", "tziString", "=", "new", "String", "(", "tziEncodedBytes", ")", ";", "if", "(", "Eas", ".", "USER_LOG", ")", "{", "Log", ".", "d", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", "+", "tz", ".", "getDisplayName", "(", ")", "+", "\"", "<STR_LIT>", "\"", "+", "(", "System", ".", "currentTimeMillis", "(", ")", "-", "time", ")", "+", "\"", "<STR_LIT>", "\"", ")", ";", "}", "return", "tziString", ";", "}", "</s>"]
["<s>", "static", "public", "TimeZone", "tziStringToTimeZone", "(", "String", "timeZoneString", ")", "{", "TimeZone", "timeZone", "=", "sTimeZoneCache", ".", "get", "(", "timeZoneString", ")", ";", "if", "(", "timeZone", "!", "=", "null", ")", "{", "if", "(", "Eas", ".", "USER_LOG", ")", "{", "Log", ".", "d", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", "+", "timeZone", ".", "getDisplayName", "(", ")", ")", ";", "}", "}", "else", "{", "timeZone", "=", "tziStringToTimeZoneImpl", "(", "timeZoneString", ")", ";", "if", "(", "timeZone", "=", "=", "null", ")", "{", "Log", ".", "w", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", "+", "timeZoneString", ")", ";", "timeZone", "=", "TimeZone", ".", "getDefault", "(", ")", ";", "}", "sTimeZoneCache", ".", "put", "(", "timeZoneString", ",", "timeZone", ")", ";", "}", "return", "timeZone", ";", "}", "</s>"]
["<s>", "static", "public", "TimeZone", "tziStringToTimeZoneImpl", "(", "String", "timeZoneString", ")", "{", "TimeZone", "timeZone", "=", "null", ";", "long", "time", "=", "System", ".", "currentTimeMillis", "(", ")", ";", "byte", "[", "]", "timeZoneBytes", "=", "Base64", ".", "decode", "(", "timeZoneString", ")", ";", "int", "bias", "=", "-", "1", "*", "getLong", "(", "timeZoneBytes", ",", "MSFT_TIME_ZONE_BIAS_OFFSET", ")", "*", "MINUTES", ";", "String", "[", "]", "zoneIds", "=", "TimeZone", ".", "getAvailableIDs", "(", "bias", ")", ";", "if", "(", "zoneIds", ".", "length", ">", "0", ")", "{", "TimeZoneDate", "dstEnd", "=", "getTimeZoneDateFromSystemTime", "(", "timeZoneBytes", ",", "MSFT_TIME_ZONE_STANDARD_DATE_OFFSET", ")", ";", "if", "(", "dstEnd", "=", "=", "null", ")", "{", "timeZone", "=", "TimeZone", ".", "getTimeZone", "(", "zoneIds", "[", "0", "]", ")", ";", "String", "dn", "=", "timeZone", ".", "getDisplayName", "(", ")", ";", "sTimeZoneCache", ".", "put", "(", "timeZoneString", ",", "timeZone", ")", ";", "if", "(", "Eas", ".", "USER_LOG", ")", "{", "Log", ".", "d", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", "+", "dn", ")", ";", "}", "}", "else", "{", "TimeZoneDate", "dstStart", "=", "getTimeZoneDateFromSystemTime", "(", "timeZoneBytes", ",", "MSFT_TIME_ZONE_DAYLIGHT_DATE_OFFSET", ")", ";", "long", "dstSavings", "=", "-", "1", "*", "getLong", "(", "timeZoneBytes", ",", "MSFT_TIME_ZONE_DAYLIGHT_BIAS_OFFSET", ")", "*", "MINUTES", ";", "for", "(", "String", "zoneId", ":", "zoneIds", ")", "{", "timeZone", "=", "TimeZone", ".", "getTimeZone", "(", "zoneId", ")", ";", "int", "testSavingsMinutes", "=", "timeZone", ".", "getDSTSavings", "(", ")", "/", "MINUTES", ";", "int", "errorBoundsMinutes", "=", "(", "testSavingsMinutes", "*", "<NUM_LIT:2>", ")", "+", "1", ";", "GregorianCalendar", "testCalendar", "=", "getCheckCalendar", "(", "timeZone", ",", "dstStart", ")", ";", "testCalendar", ".", "add", "(", "GregorianCalendar", ".", "MINUTE", ",", "-", "errorBoundsMinutes", ")", ";", "Date", "before", "=", "testCalendar", ".", "getTime", "(", ")", ";", "testCalendar", ".", "add", "(", "GregorianCalendar", ".", "MINUTE", ",", "<NUM_LIT:2>", "*", "errorBoundsMinutes", ")", ";", "Date", "after", "=", "testCalendar", ".", "getTime", "(", ")", ";", "if", "(", "timeZone", ".", "inDaylightTime", "(", "before", ")", ")", "continue", ";", "if", "(", "!", "timeZone", ".", "inDaylightTime", "(", "after", ")", ")", "continue", ";", "testCalendar", "=", "getCheckCalendar", "(", "timeZone", ",", "dstEnd", ")", ";", "testCalendar", ".", "add", "(", "GregorianCalendar", ".", "MINUTE", ",", "-", "errorBoundsMinutes", ")", ";", "before", "=", "testCalendar", ".", "getTime", "(", ")", ";", "testCalendar", ".", "add", "(", "GregorianCalendar", ".", "MINUTE", ",", "<NUM_LIT:2>", "*", "errorBoundsMinutes", ")", ";", "after", "=", "testCalendar", ".", "getTime", "(", ")", ";", "if", "(", "!", "timeZone", ".", "inDaylightTime", "(", "before", ")", ")", "continue", ";", "if", "(", "timeZone", ".", "inDaylightTime", "(", "after", ")", ")", "continue", ";", "if", "(", "dstSavings", "!", "=", "timeZone", ".", "getDSTSavings", "(", ")", ")", "continue", ";", "String", "dn", "=", "timeZone", ".", "getDisplayName", "(", ")", ";", "if", "(", "Eas", ".", "USER_LOG", ")", "{", "Log", ".", "d", "(", "TAG", ",", "\"", "<STR_LIT>", "\"", "+", "dn", "+", "\"", "<STR_LIT>", "\"", "+", "(", "System", ".", "currentTimeMillis", "(", ")", "-", "time", ")", "+", "\"", "<STR_LIT>", "\"", ")", ";", "}", "break", ";", "}", "}", "}", "return", "timeZone", ";", "}", "</s>"]
["<s>", "static", "public", "String", "millisToEasDateTime", "(", "long", "millis", ",", "TimeZone", "tz", ")", "{", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", ")", ";", "GregorianCalendar", "cal", "=", "new", "GregorianCalendar", "(", "tz", ")", ";", "cal", ".", "setTimeInMillis", "(", "millis", ")", ";", "sb", ".", "append", "(", "cal", ".", "get", "(", "Calendar", ".", "YEAR", ")", ")", ";", "sb", ".", "append", "(", "formatTwo", "(", "cal", ".", "get", "(", "Calendar", ".", "MONTH", ")", "+", "1", ")", ")", ";", "sb", ".", "append", "(", "formatTwo", "(", "cal", ".", "get", "(", "Calendar", ".", "DAY_OF_MONTH", ")", ")", ")", ";", "sb", ".", "append", "(", "<CHAR_LIT>", ")", ";", "sb", ".", "append", "(", "formatTwo", "(", "cal", ".", "get", "(", "Calendar", ".", "HOUR_OF_DAY", ")", ")", ")", ";", "sb", ".", "append", "(", "formatTwo", "(", "cal", ".", "get", "(", "Calendar", ".", "MINUTE", ")", ")", ")", ";", "sb", ".", "append", "(", "formatTwo", "(", "cal", ".", "get", "(", "Calendar", ".", "SECOND", ")", ")", ")", ";", "sb", ".", "append", "(", "<CHAR_LIT:Z>", ")", ";", "return", "sb", ".", "toString", "(", ")", ";", "}", "</s>"]
["<s>", "public", "String", "getSignature", "(", ")", "{", "return", "mSignature", ";", "}", "</s>"]
["<s>", "public", "void", "setSignature", "(", "String", "signature", ")", "{", "mSignature", "=", "signature", ";", "}", "</s>"]
["<s>", "private", "void", "showSecurityRequiredDialog", "(", ")", "{", "mHandler", ".", "post", "(", "new", "Runnable", "(", ")", "{", "public", "void", "run", "(", ")", "{", "if", "(", "mDestroyed", ")", "{", "return", ";", "}", "mProgressBar", ".", "setIndeterminate", "(", "false", ")", ";", "String", "host", "=", "mAccount", ".", "mHostAuthRecv", ".", "mAddress", ";", "Object", "[", "]", "args", "=", "new", "String", "[", "]", "{", "host", "}", ";", "new", "AlertDialog", ".", "Builder", "(", "AccountSetupCheckSettings", ".", "this", ")", ".", "setIcon", "(", "android", ".", "R", ".", "drawable", ".", "ic_dialog_alert", ")", ".", "setTitle", "(", "getString", "(", "R", ".", "string", ".", "account_setup_security_required_title", ")", ")", ".", "setMessage", "(", "getString", "(", "R", ".", "string", ".", "account_setup_security_policies_required_fmt", ",", "args", ")", ")", ".", "setCancelable", "(", "true", ")", ".", "setPositiveButton", "(", "getString", "(", "R", ".", "string", ".", "okay_action", ")", ",", "new", "DialogInterface", ".", "OnClickListener", "(", ")", "{", "public", "void", "onClick", "(", "DialogInterface", "dialog", ",", "int", "which", ")", "{", "setResult", "(", "RESULT_OK", ")", ";", "finish", "(", ")", ";", "}", "}", ")", ".", "setNegativeButton", "(", "getString", "(", "R", ".", "string", ".", "cancel_action", ")", ",", "new", "DialogInterface", ".", "OnClickListener", "(", ")", "{", "public", "void", "onClick", "(", "DialogInterface", "dialog", ",", "int", "which", ")", "{", "setResult", "(", "RESULT_SECURITY_REQUIRED_USER_CANCEL", ")", ";", "finish", "(", ")", ";", "}", "}", ")", ".", "show", "(", ")", ";", "}", "}", ")", ";", "}", "</s>"]
["<s>", "private", "void", "doActivityResultValidateExistingAccount", "(", "int", "resultCode", ",", "Intent", "data", ")", "{", "if", "(", "resultCode", "=", "=", "RESULT_OK", ")", "{", "if", "(", "mAccount", ".", "isSaved", "(", ")", ")", "{", "mAccount", ".", "update", "(", "this", ",", "mAccount", ".", "toContentValues", "(", ")", ")", ";", "mAccount", ".", "mHostAuthRecv", ".", "update", "(", "this", ",", "mAccount", ".", "mHostAuthRecv", ".", "toContentValues", "(", ")", ")", ";", "mAccount", ".", "mHostAuthSend", ".", "update", "(", "this", ",", "mAccount", ".", "mHostAuthSend", ".", "toContentValues", "(", ")", ")", ";", "if", "(", "mAccount", ".", "mHostAuthRecv", ".", "mProtocol", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "try", "{", "ExchangeUtils", ".", "getExchangeEmailService", "(", "this", ",", "null", ")", ".", "hostChanged", "(", "mAccount", ".", "mId", ")", ";", "}", "catch", "(", "RemoteException", "e", ")", "{", "}", "}", "}", "else", "{", "mAccount", ".", "save", "(", "this", ")", ";", "}", "AccountBackupRestore", ".", "backupAccounts", "(", "this", ")", ";", "finish", "(", ")", ";", "}", "}", "</s>"]
["<s>", "private", "void", "doActivityResultValidateNewAccount", "(", "int", "resultCode", ",", "Intent", "data", ")", "{", "if", "(", "resultCode", "=", "=", "RESULT_OK", ")", "{", "doOptions", "(", ")", ";", "}", "else", "if", "(", "resultCode", "=", "=", "AccountSetupCheckSettings", ".", "RESULT_SECURITY_REQUIRED_USER_CANCEL", ")", "{", "finish", "(", ")", ";", "}", "}", "</s>"]
["<s>", "private", "void", "doActivityResultAutoDiscoverNewAccount", "(", "int", "resultCode", ",", "Intent", "data", ")", "{", "if", "(", "resultCode", "=", "=", "AccountSetupCheckSettings", ".", "RESULT_AUTO_DISCOVER_AUTH_FAILED", ")", "{", "finish", "(", ")", ";", "return", ";", "}", "if", "(", "data", "!", "=", "null", ")", "{", "Parcelable", "p", "=", "data", ".", "getParcelableExtra", "(", "\"", "<STR_LIT>", "\"", ")", ";", "if", "(", "p", "!", "=", "null", ")", "{", "HostAuth", "hostAuth", "=", "(", "HostAuth", ")", "p", ";", "mAccount", ".", "mHostAuthSend", "=", "hostAuth", ";", "mAccount", ".", "mHostAuthRecv", "=", "hostAuth", ";", "loadFields", "(", "mAccount", ")", ";", "if", "(", "validateFields", "(", ")", ")", "{", "onNext", "(", ")", ";", "}", "}", "}", "}", "</s>"]
["<s>", "public", "void", "setActivePolicies", "(", ")", "{", "DevicePolicyManager", "dpm", "=", "getDPM", "(", ")", ";", "if", "(", "dpm", ".", "isAdminActive", "(", "mAdminName", ")", ")", "{", "PolicySet", "policies", ";", "synchronized", "(", "this", ")", "{", "if", "(", "mAggregatePolicy", "=", "=", "null", ")", "{", "mAggregatePolicy", "=", "computeAggregatePolicy", "(", ")", ";", "}", "policies", "=", "mAggregatePolicy", ";", "}", "dpm", ".", "setPasswordQuality", "(", "mAdminName", ",", "policies", ".", "getDPManagerPasswordQuality", "(", ")", ")", ";", "dpm", ".", "setPasswordMinimumLength", "(", "mAdminName", ",", "policies", ".", "mMinPasswordLength", ")", ";", "dpm", ".", "setMaximumTimeToLock", "(", "mAdminName", ",", "policies", ".", "mMaxScreenLockTime", "*", "<NUM_LIT:1000>", ")", ";", "dpm", ".", "setMaximumFailedPasswordsForWipe", "(", "mAdminName", ",", "policies", ".", "mMaxPasswordFails", ")", ";", "}", "}", "</s>"]
["<s>", "public", "synchronized", "void", "clearNotification", "(", "long", "accountId", ")", "{", "NotificationManager", "notificationManager", "=", "(", "NotificationManager", ")", "mContext", ".", "getSystemService", "(", "Context", ".", "NOTIFICATION_SERVICE", ")", ";", "notificationManager", ".", "cancel", "(", "MailService", ".", "NOTIFICATION_ID_SECURITY_NEEDED", ")", ";", "mNotificationActive", "=", "false", ";", "}", "</s>"]
["<s>", "public", "void", "remoteWipe", "(", "long", "accountId", ")", "{", "DevicePolicyManager", "dpm", "=", "getDPM", "(", ")", ";", "if", "(", "dpm", ".", "isAdminActive", "(", "mAdminName", ")", ")", "{", "dpm", ".", "wipeData", "(", "0", ")", ";", "}", "}", "</s>"]
["<s>", "public", "boolean", "writeAccount", "(", "Account", "account", ",", "String", "syncKey", ",", "boolean", "update", ",", "Context", "context", ")", "{", "int", "newFlags", "=", "hashCode", "(", ")", ";", "boolean", "dirty", "=", "(", "newFlags", "!", "=", "account", ".", "mSecurityFlags", ")", ";", "account", ".", "mSecurityFlags", "=", "newFlags", ";", "account", ".", "mSecuritySyncKey", "=", "syncKey", ";", "if", "(", "update", ")", "{", "if", "(", "account", ".", "isSaved", "(", ")", ")", "{", "ContentValues", "cv", "=", "new", "ContentValues", "(", ")", ";", "cv", ".", "put", "(", "AccountColumns", ".", "SECURITY_FLAGS", ",", "account", ".", "mSecurityFlags", ")", ";", "cv", ".", "put", "(", "AccountColumns", ".", "SECURITY_SYNC_KEY", ",", "account", ".", "mSecuritySyncKey", ")", ";", "account", ".", "update", "(", "context", ",", "cv", ")", ";", "}", "else", "{", "account", ".", "save", "(", "context", ")", ";", "}", "}", "return", "dirty", ";", "}", "</s>"]
["<s>", "public", "boolean", "isActiveAdmin", "(", ")", "{", "DevicePolicyManager", "dpm", "=", "getDPM", "(", ")", ";", "return", "dpm", ".", "isAdminActive", "(", "mAdminName", ")", ";", "}", "</s>"]
["<s>", "public", "ComponentName", "getAdminComponent", "(", ")", "{", "return", "mAdminName", ";", "}", "</s>"]
["<s>", "private", "void", "onAdminEnabled", "(", "boolean", "isEnabled", ")", "{", "if", "(", "isEnabled", "&", "&", "!", "mAdminEnabled", ")", "{", "}", "else", "if", "(", "!", "isEnabled", "&", "&", "mAdminEnabled", ")", "{", "}", "mAdminEnabled", "=", "isEnabled", ";", "}", "</s>"]
["<s>", "public", "static", "Intent", "actionUpdateSecurityIntent", "(", "Context", "context", ",", "long", "accountId", ")", "{", "Intent", "intent", "=", "new", "Intent", "(", "context", ",", "AccountSecurity", ".", "class", ")", ";", "intent", ".", "putExtra", "(", "EXTRA_ACCOUNT_ID", ",", "accountId", ")", ";", "return", "intent", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "onCreate", "(", "Bundle", "savedInstanceState", ")", "{", "super", ".", "onCreate", "(", "savedInstanceState", ")", ";", "Intent", "i", "=", "getIntent", "(", ")", ";", "long", "accountId", "=", "i", ".", "getLongExtra", "(", "EXTRA_ACCOUNT_ID", ",", "-", "1", ")", ";", "SecurityPolicy", "security", "=", "SecurityPolicy", ".", "getInstance", "(", "this", ")", ";", "security", ".", "clearNotification", "(", "accountId", ")", ";", "if", "(", "accountId", "!", "=", "-", "1", ")", "{", "Account", "account", "=", "Account", ".", "restoreAccountWithId", "(", "this", ",", "accountId", ")", ";", "if", "(", "account", "!", "=", "null", ")", "{", "if", "(", "account", ".", "mSecurityFlags", "!", "=", "0", ")", "{", "if", "(", "!", "security", ".", "isActiveAdmin", "(", ")", ")", "{", "Intent", "intent", "=", "new", "Intent", "(", "DevicePolicyManager", ".", "ACTION_ADD_DEVICE_ADMIN", ")", ";", "intent", ".", "putExtra", "(", "DevicePolicyManager", ".", "EXTRA_DEVICE_ADMIN", ",", "security", ".", "getAdminComponent", "(", ")", ")", ";", "intent", ".", "putExtra", "(", "DevicePolicyManager", ".", "EXTRA_ADD_EXPLANATION", ",", "this", ".", "getString", "(", "R", ".", "string", ".", "account_security_policy_explanation_fmt", ",", "account", ".", "getDisplayName", "(", ")", ")", ")", ";", "startActivityForResult", "(", "intent", ",", "REQUEST_ENABLE", ")", ";", "return", ";", "}", "else", "{", "setActivePolicies", "(", ")", ";", "}", "}", "}", "}", "finish", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "void", "onActivityResult", "(", "int", "requestCode", ",", "int", "resultCode", ",", "Intent", "data", ")", "{", "switch", "(", "requestCode", ")", "{", "case", "REQUEST_ENABLE", ":", "if", "(", "resultCode", "=", "=", "Activity", ".", "RESULT_OK", ")", "{", "setActivePolicies", "(", ")", ";", "}", "else", "{", "}", "}", "finish", "(", ")", ";", "super", ".", "onActivityResult", "(", "requestCode", ",", "resultCode", ",", "data", ")", ";", "}", "</s>"]
["<s>", "private", "void", "setActivePolicies", "(", ")", "{", "SecurityPolicy", "sp", "=", "SecurityPolicy", ".", "getInstance", "(", "this", ")", ";", "if", "(", "sp", ".", "isActive", "(", "null", ")", ")", "{", "return", ";", "}", "sp", ".", "setActivePolicies", "(", ")", ";", "if", "(", "sp", ".", "isActive", "(", "null", ")", ")", "{", "return", ";", "}", "Intent", "intent", "=", "new", "Intent", "(", "DevicePolicyManager", ".", "ACTION_SET_NEW_PASSWORD", ")", ";", "startActivity", "(", "intent", ")", ";", "}", "</s>"]
["<s>", "void", "writeStringValue", "(", "ContentValues", "cv", ",", "String", "key", ",", "int", "tag", ")", "throws", "IOException", "{", "String", "value", "=", "cv", ".", "getAsString", "(", "key", ")", ";", "if", "(", "value", "!", "=", "null", ")", "{", "data", "(", "tag", ",", "value", ")", ";", "}", "}", "</s>"]
["<s>", "private", "void", "setupProtocolVersion", "(", "EasSyncService", "service", ",", "Header", "versionHeader", ")", "{", "String", "versions", "=", "versionHeader", ".", "getValue", "(", ")", ";", "if", "(", "versions", "!", "=", "null", ")", "{", "if", "(", "versions", ".", "contains", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "service", ".", "mProtocolVersion", "=", "\"", "<STR_LIT>", "\"", ";", "}", "service", ".", "mProtocolVersionDouble", "=", "Double", ".", "parseDouble", "(", "service", ".", "mProtocolVersion", ")", ";", "if", "(", "service", ".", "mAccount", "!", "=", "null", ")", "{", "service", ".", "mAccount", ".", "mProtocolVersion", "=", "service", ".", "mProtocolVersion", ";", "}", "}", "}", "</s>"]
["<s>", "private", "boolean", "canProvision", "(", ")", "throws", "IOException", "{", "Serializer", "s", "=", "new", "Serializer", "(", ")", ";", "s", ".", "start", "(", "Tags", ".", "PROVISION_PROVISION", ")", ".", "start", "(", "Tags", ".", "PROVISION_POLICIES", ")", ";", "s", ".", "start", "(", "Tags", ".", "PROVISION_POLICY", ")", ".", "data", "(", "Tags", ".", "PROVISION_POLICY_TYPE", ",", "\"", "<STR_LIT>", "\"", ")", ".", "end", "(", ")", ".", "end", "(", ")", ".", "end", "(", ")", ".", "done", "(", ")", ";", "HttpResponse", "resp", "=", "sendHttpClientPost", "(", "\"", "<STR_LIT>", "\"", ",", "s", ".", "toByteArray", "(", ")", ")", ";", "int", "code", "=", "resp", ".", "getStatusLine", "(", ")", ".", "getStatusCode", "(", ")", ";", "if", "(", "code", "=", "=", "HttpStatus", ".", "SC_OK", ")", "{", "InputStream", "is", "=", "resp", ".", "getEntity", "(", ")", ".", "getContent", "(", ")", ";", "ProvisionParser", "pp", "=", "new", "ProvisionParser", "(", "is", ",", "this", ")", ";", "if", "(", "pp", ".", "parse", "(", ")", ")", "{", "PolicySet", "ps", "=", "pp", ".", "getPolicySet", "(", ")", ";", "if", "(", "SecurityPolicy", ".", "getInstance", "(", "mContext", ")", ".", "isSupported", "(", "ps", ")", ")", "{", "return", "true", ";", "}", "}", "}", "return", "false", ";", "}", "</s>"]
["<s>", "public", "PolicySet", "getPolicySet", "(", ")", "{", "return", "mPolicySet", ";", "}", "</s>"]
["<s>", "public", "String", "getPolicyKey", "(", ")", "{", "return", "mPolicyKey", ";", "}", "</s>"]
["<s>", "public", "void", "parseProvisionDoc", "(", ")", "throws", "IOException", "{", "int", "minPasswordLength", "=", "0", ";", "int", "passwordMode", "=", "PolicySet", ".", "PASSWORD_MODE_NONE", ";", "int", "maxPasswordFails", "=", "0", ";", "int", "maxScreenLockTime", "=", "0", ";", "boolean", "canSupport", "=", "false", ";", "while", "(", "nextTag", "(", "Tags", ".", "PROVISION_EAS_PROVISION_DOC", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "PROVISION_DEVICE_PASSWORD_ENABLED", ":", "if", "(", "getValueInt", "(", ")", "=", "=", "1", ")", "{", "if", "(", "passwordMode", "=", "=", "PolicySet", ".", "PASSWORD_MODE_NONE", ")", "{", "passwordMode", "=", "PolicySet", ".", "PASSWORD_MODE_SIMPLE", ";", "}", "}", "break", ";", "case", "Tags", ".", "PROVISION_MIN_DEVICE_PASSWORD_LENGTH", ":", "minPasswordLength", "=", "getValueInt", "(", ")", ";", "break", ";", "case", "Tags", ".", "PROVISION_ALPHA_DEVICE_PASSWORD_ENABLED", ":", "if", "(", "getValueInt", "(", ")", "=", "=", "1", ")", "{", "passwordMode", "=", "PolicySet", ".", "PASSWORD_MODE_STRONG", ";", "}", "break", ";", "case", "Tags", ".", "PROVISION_MAX_INACTIVITY_TIME_DEVICE_LOCK", ":", "maxScreenLockTime", "=", "getValueInt", "(", ")", ";", "break", ";", "case", "Tags", ".", "PROVISION_MAX_DEVICE_PASSWORD_FAILED_ATTEMPTS", ":", "maxPasswordFails", "=", "getValueInt", "(", ")", ";", "break", ";", "case", "Tags", ".", "PROVISION_ALLOW_SIMPLE_DEVICE_PASSWORD", ":", "getValue", "(", ")", ";", "break", ";", "case", "Tags", ".", "PROVISION_ATTACHMENTS_ENABLED", ":", "if", "(", "getValueInt", "(", ")", "=", "=", "0", ")", "{", "canSupport", "=", "false", ";", "}", "break", ";", "case", "Tags", ".", "PROVISION_DEVICE_ENCRYPTION_ENABLED", ":", "case", "Tags", ".", "PROVISION_PASSWORD_RECOVERY_ENABLED", ":", "case", "Tags", ".", "PROVISION_DEVICE_PASSWORD_EXPIRATION", ":", "case", "Tags", ".", "PROVISION_DEVICE_PASSWORD_HISTORY", ":", "case", "Tags", ".", "PROVISION_MAX_ATTACHMENT_SIZE", ":", "if", "(", "getValueInt", "(", ")", "=", "=", "1", ")", "{", "canSupport", "=", "false", ";", "}", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "if", "(", "canSupport", ")", "{", "mPolicySet", "=", "new", "SecurityPolicy", ".", "PolicySet", "(", "minPasswordLength", ",", "passwordMode", ",", "maxPasswordFails", ",", "maxScreenLockTime", ",", "true", ")", ";", "}", "}", "</s>"]
["<s>", "public", "void", "parseProvisionData", "(", ")", "throws", "IOException", "{", "while", "(", "nextTag", "(", "Tags", ".", "PROVISION_DATA", ")", "!", "=", "END", ")", "{", "if", "(", "tag", "=", "=", "Tags", ".", "PROVISION_EAS_PROVISION_DOC", ")", "{", "parseProvisionDoc", "(", ")", ";", "}", "else", "{", "skipTag", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "public", "void", "parsePolicy", "(", ")", "throws", "IOException", "{", "while", "(", "nextTag", "(", "Tags", ".", "PROVISION_POLICY", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "PROVISION_POLICIES", ":", "parsePolicies", "(", ")", ";", "break", ";", "case", "Tags", ".", "PROVISION_POLICY_TYPE", ":", "mService", ".", "userLog", "(", "\"", "<STR_LIT>", "\"", ",", "getValue", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "PROVISION_POLICY_KEY", ":", "mPolicyKey", "=", "getValue", "(", ")", ";", "break", ";", "case", "Tags", ".", "PROVISION_STATUS", ":", "mService", ".", "userLog", "(", "\"", "<STR_LIT>", "\"", ",", "getValue", "(", ")", ")", ";", "break", ";", "case", "Tags", ".", "PROVISION_DATA", ":", "parseProvisionData", "(", ")", ";", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "public", "void", "parsePolicies", "(", ")", "throws", "IOException", "{", "while", "(", "nextTag", "(", "Tags", ".", "PROVISION_POLICIES", ")", "!", "=", "END", ")", "{", "if", "(", "tag", "=", "=", "Tags", ".", "PROVISION_POLICY", ")", "{", "parsePolicy", "(", ")", ";", "}", "else", "{", "skipTag", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "@", "Override", "public", "boolean", "parse", "(", ")", "throws", "IOException", "{", "boolean", "res", "=", "false", ";", "if", "(", "nextTag", "(", "START_DOCUMENT", ")", "!", "=", "Tags", ".", "PROVISION_PROVISION", ")", "{", "throw", "new", "IOException", "(", ")", ";", "}", "while", "(", "nextTag", "(", "START_DOCUMENT", ")", "!", "=", "END_DOCUMENT", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "PROVISION_STATUS", ":", "int", "status", "=", "getValueInt", "(", ")", ";", "mService", ".", "userLog", "(", "\"", "<STR_LIT>", "\"", ",", "status", ")", ";", "break", ";", "case", "Tags", ".", "PROVISION_POLICIES", ":", "parsePolicies", "(", ")", ";", "return", "(", "mPolicySet", "!", "=", "null", ")", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "return", "res", ";", "}", "</s>"]
["<s>", "protected", "boolean", "isProvisionError", "(", "int", "code", ")", "{", "return", "(", "code", "=", "=", "HTTP_NEED_PROVISIONING", ")", "|", "|", "(", "code", "=", "=", "HttpStatus", ".", "SC_FORBIDDEN", ")", ";", "}", "</s>"]
["<s>", "private", "boolean", "tryProvision", "(", ")", "throws", "IOException", "{", "ProvisionParser", "pp", "=", "canProvision", "(", ")", ";", "if", "(", "pp", "!", "=", "null", ")", "{", "SecurityPolicy", "sp", "=", "SecurityPolicy", ".", "getInstance", "(", "mContext", ")", ";", "PolicySet", "ps", "=", "pp", ".", "getPolicySet", "(", ")", ";", "if", "(", "ps", ".", "writeAccount", "(", "mAccount", ",", "null", ",", "true", ",", "mContext", ")", ")", "{", "sp", ".", "updatePolicies", "(", "mAccount", ".", "mId", ")", ";", "}", "if", "(", "sp", ".", "isActive", "(", "ps", ")", ")", "{", "String", "policyKey", "=", "acknowledgeProvision", "(", "pp", ".", "getPolicyKey", "(", ")", ")", ";", "if", "(", "policyKey", "!", "=", "null", ")", "{", "ps", ".", "writeAccount", "(", "mAccount", ",", "policyKey", ",", "true", ",", "mContext", ")", ";", "return", "true", ";", "}", "}", "else", "{", "sp", ".", "policiesRequired", "(", "mAccount", ".", "mId", ")", ";", "}", "}", "return", "false", ";", "}", "</s>"]
["<s>", "private", "String", "acknowledgeProvision", "(", "String", "tempKey", ")", "throws", "IOException", "{", "Serializer", "s", "=", "new", "Serializer", "(", ")", ";", "s", ".", "start", "(", "Tags", ".", "PROVISION_PROVISION", ")", ".", "start", "(", "Tags", ".", "PROVISION_POLICIES", ")", ";", "s", ".", "start", "(", "Tags", ".", "PROVISION_POLICY", ")", ";", "s", ".", "data", "(", "Tags", ".", "PROVISION_POLICY_TYPE", ",", "\"", "<STR_LIT>", "\"", ")", ";", "s", ".", "data", "(", "Tags", ".", "PROVISION_POLICY_KEY", ",", "tempKey", ")", ";", "s", ".", "data", "(", "Tags", ".", "PROVISION_STATUS", ",", "\"", "<STR_LIT:1>", "\"", ")", ";", "s", ".", "end", "(", ")", ";", "s", ".", "end", "(", ")", ".", "end", "(", ")", ".", "done", "(", ")", ";", "HttpResponse", "resp", "=", "sendHttpClientPost", "(", "\"", "<STR_LIT>", "\"", ",", "s", ".", "toByteArray", "(", ")", ")", ";", "int", "code", "=", "resp", ".", "getStatusLine", "(", ")", ".", "getStatusCode", "(", ")", ";", "if", "(", "code", "=", "=", "HttpStatus", ".", "SC_OK", ")", "{", "InputStream", "is", "=", "resp", ".", "getEntity", "(", ")", ".", "getContent", "(", ")", ";", "ProvisionParser", "pp", "=", "new", "ProvisionParser", "(", "is", ",", "this", ")", ";", "if", "(", "pp", ".", "parse", "(", ")", ")", "{", "return", "pp", ".", "getPolicyKey", "(", ")", ";", "}", "}", "return", "null", ";", "}", "</s>"]
["<s>", "public", "static", "int", "getAccountColorResourceId", "(", "long", "accountId", ")", "{", "return", "ACCOUNT_COLOR_CHIP_RES_IDS", "[", "(", "int", ")", "accountId", "%", "ACCOUNT_COLOR_CHIP_RES_IDS", ".", "length", "]", ";", "}", "</s>"]
["<s>", "public", "static", "int", "getAccountColor", "(", "long", "accountId", ")", "{", "return", "ACCOUNT_COLOR_CHIP_RGBS", "[", "(", "int", ")", "accountId", "%", "ACCOUNT_COLOR_CHIP_RGBS", ".", "length", "]", ";", "}", "</s>"]
["<s>", "public", "void", "setAccountHoldFlag", "(", "Account", "account", ",", "boolean", "newState", ")", "{", "if", "(", "newState", ")", "{", "account", ".", "mFlags", "|", "=", "Account", ".", "FLAGS_SECURITY_HOLD", ";", "}", "else", "{", "account", ".", "mFlags", "&", "=", "~", "Account", ".", "FLAGS_SECURITY_HOLD", ";", "}", "ContentValues", "cv", "=", "new", "ContentValues", "(", ")", ";", "cv", ".", "put", "(", "AccountColumns", ".", "FLAGS", ",", "account", ".", "mFlags", ")", ";", "account", ".", "update", "(", "mContext", ",", "cv", ")", ";", "}", "</s>"]
["<s>", "public", "void", "clearAccountHoldFlags", "(", ")", "{", "ContentResolver", "resolver", "=", "mContext", ".", "getContentResolver", "(", ")", ";", "Cursor", "c", "=", "resolver", ".", "query", "(", "Account", ".", "CONTENT_URI", ",", "ACCOUNT_FLAGS_PROJECTION", ",", "WHERE_ACCOUNT_SECURITY_NONZERO", ",", "null", ",", "null", ")", ";", "try", "{", "while", "(", "c", ".", "moveToNext", "(", ")", ")", "{", "int", "flags", "=", "c", ".", "getInt", "(", "ACCOUNT_FLAGS_COLUMN_FLAGS", ")", ";", "if", "(", "0", "!", "=", "(", "flags", "&", "Account", ".", "FLAGS_SECURITY_HOLD", ")", ")", "{", "ContentValues", "cv", "=", "new", "ContentValues", "(", ")", ";", "cv", ".", "put", "(", "AccountColumns", ".", "FLAGS", ",", "flags", "&", "~", "Account", ".", "FLAGS_SECURITY_HOLD", ")", ";", "long", "accountId", "=", "c", ".", "getLong", "(", "ACCOUNT_FLAGS_COLUMN_ID", ")", ";", "Uri", "uri", "=", "ContentUris", ".", "withAppendedId", "(", "Account", ".", "CONTENT_URI", ",", "accountId", ")", ";", "resolver", ".", "update", "(", "uri", ",", "cv", ",", "null", ",", "null", ")", ";", "}", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "}", "</s>"]
["<s>", "public", "void", "testSetClearHoldFlag", "(", ")", "{", "SecurityPolicy", "sp", "=", "getSecurityPolicy", "(", ")", ";", "Account", "a1", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT:-1>", "\"", ",", "false", ",", "mMockContext", ")", ";", "a1", ".", "mFlags", "=", "Account", ".", "FLAGS_NOTIFY_NEW_MAIL", ";", "a1", ".", "save", "(", "mMockContext", ")", ";", "Account", "a2", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "false", ",", "mMockContext", ")", ";", "a2", ".", "mFlags", "=", "Account", ".", "FLAGS_VIBRATE", "|", "Account", ".", "FLAGS_SECURITY_HOLD", ";", "a2", ".", "save", "(", "mMockContext", ")", ";", "Account", "a1a", "=", "Account", ".", "restoreAccountWithId", "(", "mMockContext", ",", "a1", ".", "mId", ")", ";", "assertEquals", "(", "Account", ".", "FLAGS_NOTIFY_NEW_MAIL", ",", "a1a", ".", "mFlags", ")", ";", "sp", ".", "setAccountHoldFlag", "(", "a1", ",", "true", ")", ";", "assertEquals", "(", "Account", ".", "FLAGS_NOTIFY_NEW_MAIL", "|", "Account", ".", "FLAGS_SECURITY_HOLD", ",", "a1", ".", "mFlags", ")", ";", "Account", "a1b", "=", "Account", ".", "restoreAccountWithId", "(", "mMockContext", ",", "a1", ".", "mId", ")", ";", "assertEquals", "(", "Account", ".", "FLAGS_NOTIFY_NEW_MAIL", "|", "Account", ".", "FLAGS_SECURITY_HOLD", ",", "a1b", ".", "mFlags", ")", ";", "Account", "a2a", "=", "Account", ".", "restoreAccountWithId", "(", "mMockContext", ",", "a2", ".", "mId", ")", ";", "assertEquals", "(", "Account", ".", "FLAGS_VIBRATE", "|", "Account", ".", "FLAGS_SECURITY_HOLD", ",", "a2a", ".", "mFlags", ")", ";", "sp", ".", "setAccountHoldFlag", "(", "a2", ",", "false", ")", ";", "assertEquals", "(", "Account", ".", "FLAGS_VIBRATE", ",", "a2", ".", "mFlags", ")", ";", "Account", "a2b", "=", "Account", ".", "restoreAccountWithId", "(", "mMockContext", ",", "a2", ".", "mId", ")", ";", "assertEquals", "(", "Account", ".", "FLAGS_VIBRATE", ",", "a2b", ".", "mFlags", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testClearHoldFlags", "(", ")", "{", "SecurityPolicy", "sp", "=", "getSecurityPolicy", "(", ")", ";", "Account", "a1", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT:-1>", "\"", ",", "false", ",", "mMockContext", ")", ";", "a1", ".", "mFlags", "=", "Account", ".", "FLAGS_NOTIFY_NEW_MAIL", ";", "a1", ".", "save", "(", "mMockContext", ")", ";", "Account", "a2", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT>", "\"", ",", "false", ",", "mMockContext", ")", ";", "a2", ".", "mFlags", "=", "Account", ".", "FLAGS_VIBRATE", "|", "Account", ".", "FLAGS_SECURITY_HOLD", ";", "a2", ".", "save", "(", "mMockContext", ")", ";", "sp", ".", "clearAccountHoldFlags", "(", ")", ";", "Account", "a1a", "=", "Account", ".", "restoreAccountWithId", "(", "mMockContext", ",", "a1", ".", "mId", ")", ";", "assertEquals", "(", "Account", ".", "FLAGS_NOTIFY_NEW_MAIL", ",", "a1a", ".", "mFlags", ")", ";", "Account", "a2a", "=", "Account", ".", "restoreAccountWithId", "(", "mMockContext", ",", "a2", ".", "mId", ")", ";", "assertEquals", "(", "Account", ".", "FLAGS_VIBRATE", ",", "a2a", ".", "mFlags", ")", ";", "}", "</s>"]
["<s>", "public", "synchronized", "PolicySet", "getAggregatePolicy", "(", ")", "{", "if", "(", "mAggregatePolicy", "=", "=", "null", ")", "{", "mAggregatePolicy", "=", "computeAggregatePolicy", "(", ")", ";", "}", "return", "mAggregatePolicy", ";", "}", "</s>"]
["<s>", "public", "void", "reducePolicies", "(", ")", "{", "updatePolicies", "(", "-", "1", ")", ";", "setActivePolicies", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "void", "onDestroy", "(", ")", "{", "super", ".", "onDestroy", "(", ")", ";", "if", "(", "mCheckAccountStateTask", "!", "=", "null", "&", "&", "mCheckAccountStateTask", ".", "getStatus", "(", ")", "!", "=", "CheckAccountStateTask", ".", "Status", ".", "FINISHED", ")", "{", "mCheckAccountStateTask", ".", "cancel", "(", "true", ")", ";", "mCheckAccountStateTask", "=", "null", ";", "}", "}", "</s>"]
["<s>", "@", "Override", "protected", "Boolean", "doInBackground", "(", "Void", ".", ".", ".", "params", ")", "{", "Cursor", "c", "=", "AccountSetupNames", ".", "this", ".", "getContentResolver", "(", ")", ".", "query", "(", "ContentUris", ".", "withAppendedId", "(", "Account", ".", "CONTENT_URI", ",", "mAccountId", ")", ",", "ACCOUNT_INFO_PROJECTION", ",", "null", ",", "null", ",", "null", ")", ";", "try", "{", "if", "(", "c", ".", "moveToFirst", "(", ")", ")", "{", "int", "flags", "=", "c", ".", "getInt", "(", "ACCOUNT_INFO_COLUMN_FLAGS", ")", ";", "int", "securityFlags", "=", "c", ".", "getInt", "(", "ACCOUNT_INFO_COLUMN_SECURITY_FLAGS", ")", ";", "if", "(", "(", "flags", "&", "Account", ".", "FLAGS_SECURITY_HOLD", ")", "!", "=", "0", ")", "{", "return", "Boolean", ".", "TRUE", ";", "}", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "return", "Boolean", ".", "FALSE", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "void", "onPostExecute", "(", "Boolean", "isSecurityHold", ")", "{", "if", "(", "!", "isCancelled", "(", ")", ")", "{", "if", "(", "isSecurityHold", ")", "{", "Intent", "i", "=", "AccountSecurity", ".", "actionUpdateSecurityIntent", "(", "AccountSetupNames", ".", "this", ",", "mAccountId", ")", ";", "AccountSetupNames", ".", "this", ".", "startActivityForResult", "(", "i", ",", "REQUEST_SECURITY", ")", ";", "}", "else", "{", "onBackPressed", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "@", "Override", "protected", "void", "onActivityResult", "(", "int", "requestCode", ",", "int", "resultCode", ",", "Intent", "data", ")", "{", "switch", "(", "requestCode", ")", "{", "case", "REQUEST_SECURITY", ":", "onBackPressed", "(", ")", ";", "}", "super", ".", "onActivityResult", "(", "requestCode", ",", "resultCode", ",", "data", ")", ";", "}", "</s>"]
["<s>", "private", "void", "acknowledgeRemoteWipe", "(", "String", "tempKey", ")", "throws", "IOException", "{", "acknowledgeProvisionImpl", "(", "tempKey", ",", "true", ")", ";", "}", "</s>"]
["<s>", "private", "String", "acknowledgeProvisionImpl", "(", "String", "tempKey", ",", "boolean", "remoteWipe", ")", "throws", "IOException", "{", "Serializer", "s", "=", "new", "Serializer", "(", ")", ";", "s", ".", "start", "(", "Tags", ".", "PROVISION_PROVISION", ")", ".", "start", "(", "Tags", ".", "PROVISION_POLICIES", ")", ";", "s", ".", "start", "(", "Tags", ".", "PROVISION_POLICY", ")", ";", "s", ".", "data", "(", "Tags", ".", "PROVISION_POLICY_TYPE", ",", "\"", "<STR_LIT>", "\"", ")", ";", "s", ".", "data", "(", "Tags", ".", "PROVISION_POLICY_KEY", ",", "tempKey", ")", ";", "s", ".", "data", "(", "Tags", ".", "PROVISION_STATUS", ",", "\"", "<STR_LIT:1>", "\"", ")", ";", "if", "(", "remoteWipe", ")", "{", "s", ".", "start", "(", "Tags", ".", "PROVISION_REMOTE_WIPE", ")", ";", "s", ".", "data", "(", "Tags", ".", "PROVISION_STATUS", ",", "\"", "<STR_LIT:1>", "\"", ")", ";", "s", ".", "end", "(", ")", ";", "}", "s", ".", "end", "(", ")", ";", "s", ".", "end", "(", ")", ".", "end", "(", ")", ".", "done", "(", ")", ";", "HttpResponse", "resp", "=", "sendHttpClientPost", "(", "\"", "<STR_LIT>", "\"", ",", "s", ".", "toByteArray", "(", ")", ")", ";", "int", "code", "=", "resp", ".", "getStatusLine", "(", ")", ".", "getStatusCode", "(", ")", ";", "if", "(", "code", "=", "=", "HttpStatus", ".", "SC_OK", ")", "{", "InputStream", "is", "=", "resp", ".", "getEntity", "(", ")", ".", "getContent", "(", ")", ";", "ProvisionParser", "pp", "=", "new", "ProvisionParser", "(", "is", ",", "this", ")", ";", "if", "(", "pp", ".", "parse", "(", ")", ")", "{", "return", "pp", ".", "getPolicyKey", "(", ")", ";", "}", "}", "return", "null", ";", "}", "</s>"]
["<s>", "private", "boolean", "onSecurityHold", "(", "Account", "account", ")", "{", "return", "(", "account", ".", "mFlags", "&", "Account", ".", "FLAGS_SECURITY_HOLD", ")", "!", "=", "0", ";", "}", "</s>"]
["<s>", "void", "releaseSyncHolds", "(", "Context", "context", ",", "int", "reason", ",", "Account", "account", ")", "{", "releaseSyncHoldsImpl", "(", "context", ",", "reason", ",", "account", ")", ";", "kick", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "private", "void", "releaseSyncHoldsImpl", "(", "Context", "context", ",", "int", "reason", ",", "Account", "account", ")", "{", "synchronized", "(", "sSyncToken", ")", "{", "ArrayList", "<", "Long", ">", "releaseList", "=", "new", "ArrayList", "<", "Long", ">", "(", ")", ";", "for", "(", "long", "mailboxId", ":", "mSyncErrorMap", ".", "keySet", "(", ")", ")", "{", "if", "(", "account", "!", "=", "null", ")", "{", "Mailbox", "m", "=", "Mailbox", ".", "restoreMailboxWithId", "(", "context", ",", "mailboxId", ")", ";", "if", "(", "m", "=", "=", "null", ")", "{", "releaseList", ".", "add", "(", "mailboxId", ")", ";", "}", "else", "if", "(", "m", ".", "mAccountKey", "!", "=", "account", ".", "mId", ")", "{", "continue", ";", "}", "}", "SyncError", "error", "=", "mSyncErrorMap", ".", "get", "(", "mailboxId", ")", ";", "if", "(", "error", ".", "reason", "=", "=", "reason", ")", "{", "releaseList", ".", "add", "(", "mailboxId", ")", ";", "}", "}", "for", "(", "long", "mailboxId", ":", "releaseList", ")", "{", "mSyncErrorMap", ".", "remove", "(", "mailboxId", ")", ";", "}", "}", "}", "</s>"]
["<s>", "public", "boolean", "getRemoteWipe", "(", ")", "{", "return", "mRemoteWipe", ";", "}", "</s>"]
["<s>", "public", "void", "testReleaseSyncHolds", "(", ")", "{", "Context", "context", "=", "mMockContext", ";", "SyncManager", "syncManager", "=", "new", "SyncManager", "(", ")", ";", "SyncError", "securityErrorAccount1", "=", "syncManager", ".", "new", "SyncError", "(", "AbstractSyncService", ".", "EXIT_SECURITY_FAILURE", ",", "false", ")", ";", "SyncError", "ioError", "=", "syncManager", ".", "new", "SyncError", "(", "AbstractSyncService", ".", "EXIT_IO_ERROR", ",", "false", ")", ";", "SyncError", "securityErrorAccount2", "=", "syncManager", ".", "new", "SyncError", "(", "AbstractSyncService", ".", "EXIT_SECURITY_FAILURE", ",", "false", ")", ";", "Account", "acct1", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT:1>", "\"", ",", "true", ",", "context", ")", ";", "Mailbox", "box1", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT:1>", "\"", ",", "acct1", ".", "mId", ",", "true", ",", "context", ")", ";", "Mailbox", "box2", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT:2>", "\"", ",", "acct1", ".", "mId", ",", "true", ",", "context", ")", ";", "Account", "acct2", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT:2>", "\"", ",", "true", ",", "context", ")", ";", "Mailbox", "box3", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT:3>", "\"", ",", "acct2", ".", "mId", ",", "true", ",", "context", ")", ";", "Mailbox", "box4", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT:4>", "\"", ",", "acct2", ".", "mId", ",", "true", ",", "context", ")", ";", "HashMap", "<", "Long", ",", "SyncError", ">", "errorMap", "=", "syncManager", ".", "mSyncErrorMap", ";", "errorMap", ".", "put", "(", "box1", ".", "mId", ",", "securityErrorAccount1", ")", ";", "errorMap", ".", "put", "(", "box2", ".", "mId", ",", "ioError", ")", ";", "errorMap", ".", "put", "(", "box3", ".", "mId", ",", "securityErrorAccount2", ")", ";", "errorMap", ".", "put", "(", "box4", ".", "mId", ",", "securityErrorAccount2", ")", ";", "assertEquals", "(", "<NUM_LIT:4>", ",", "errorMap", ".", "keySet", "(", ")", ".", "size", "(", ")", ")", ";", "syncManager", ".", "releaseSyncHolds", "(", "context", ",", "AbstractSyncService", ".", "EXIT_SECURITY_FAILURE", ",", "acct2", ")", ";", "assertEquals", "(", "<NUM_LIT:2>", ",", "errorMap", ".", "keySet", "(", ")", ".", "size", "(", ")", ")", ";", "assertNotNull", "(", "errorMap", ".", "get", "(", "box2", ".", "mId", ")", ")", ";", "assertNotNull", "(", "errorMap", ".", "get", "(", "box1", ".", "mId", ")", ")", ";", "errorMap", ".", "put", "(", "box3", ".", "mId", ",", "securityErrorAccount2", ")", ";", "errorMap", ".", "put", "(", "box4", ".", "mId", ",", "securityErrorAccount2", ")", ";", "assertEquals", "(", "<NUM_LIT:4>", ",", "errorMap", ".", "keySet", "(", ")", ".", "size", "(", ")", ")", ";", "syncManager", ".", "releaseSyncHolds", "(", "context", ",", "AbstractSyncService", ".", "EXIT_SECURITY_FAILURE", ",", "null", ")", ";", "assertEquals", "(", "1", ",", "errorMap", ".", "keySet", "(", ")", ".", "size", "(", ")", ")", ";", "assertNotNull", "(", "errorMap", ".", "get", "(", "box2", ".", "mId", ")", ")", ";", "syncManager", ".", "releaseSyncHolds", "(", "context", ",", "AbstractSyncService", ".", "EXIT_IO_ERROR", ",", "acct2", ")", ";", "assertEquals", "(", "1", ",", "errorMap", ".", "keySet", "(", ")", ".", "size", "(", ")", ")", ";", "syncManager", ".", "releaseSyncHolds", "(", "context", ",", "AbstractSyncService", ".", "EXIT_IO_ERROR", ",", "acct1", ")", ";", "assertEquals", "(", "0", ",", "errorMap", ".", "keySet", "(", ")", ".", "size", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testUndisclosedRecipients", "(", ")", "throws", "MessagingException", ",", "IOException", "{", "String", "entireMessage", "=", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", ";", "MimeMessage", "mm", "=", "null", ";", "mm", "=", "new", "MimeMessage", "(", "new", "ByteArrayInputStream", "(", "entireMessage", ".", "getBytes", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "assertEquals", "(", "0", ",", "mm", ".", "getRecipients", "(", "MimeMessage", ".", "RecipientType", ".", "TO", ")", ".", "length", ")", ";", "assertEquals", "(", "0", ",", "mm", ".", "getRecipients", "(", "MimeMessage", ".", "RecipientType", ".", "CC", ")", ".", "length", ")", ";", "assertEquals", "(", "0", ",", "mm", ".", "getRecipients", "(", "MimeMessage", ".", "RecipientType", ".", "BCC", ")", ".", "length", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testInvalidHeaders", "(", ")", "throws", "MessagingException", ",", "IOException", "{", "String", "entireMessage", "=", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", ";", "MimeMessage", "mm", "=", "null", ";", "mm", "=", "new", "MimeMessage", "(", "new", "ByteArrayInputStream", "(", "entireMessage", ".", "getBytes", "(", "\"", "<STR_LIT>", "\"", ")", ")", ")", ";", "assertEquals", "(", "0", ",", "mm", ".", "getRecipients", "(", "MimeMessage", ".", "RecipientType", ".", "TO", ")", ".", "length", ")", ";", "assertEquals", "(", "1", ",", "mm", ".", "getRecipients", "(", "MimeMessage", ".", "RecipientType", ".", "CC", ")", ".", "length", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "mm", ".", "getRecipients", "(", "MimeMessage", ".", "RecipientType", ".", "CC", ")", "[", "0", "]", ".", "getAddress", "(", ")", ")", ";", "assertEquals", "(", "0", ",", "mm", ".", "getRecipients", "(", "MimeMessage", ".", "RecipientType", ".", "BCC", ")", ".", "length", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "mm", ".", "getMessageId", "(", ")", ")", ";", "}", "</s>"]
["<s>", "public", "int", "getBackupFlags", "(", ")", "{", "return", "mBackupFlags", ";", "}", "</s>"]
["<s>", "public", "void", "setBackupFlags", "(", "int", "flags", ")", "{", "mBackupFlags", "=", "flags", ";", "}", "</s>"]
["<s>", "public", "static", "void", "actionStart", "(", "Activity", "fromActivity", ")", "{", "Intent", "i", "=", "new", "Intent", "(", "fromActivity", ",", "UpgradeAccounts", ".", "class", ")", ";", "fromActivity", ".", "startActivity", "(", "i", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "onCreate", "(", "Bundle", "icicle", ")", "{", "super", ".", "onCreate", "(", "icicle", ")", ";", "Preferences", "p", "=", "Preferences", ".", "getPreferences", "(", "this", ")", ";", "loadAccountInfoArray", "(", "p", ".", "getAccounts", "(", ")", ")", ";", "Log", ".", "d", "(", "Email", ".", "LOG_TAG", ",", "\"", "<STR_LIT>", "\"", "+", "Integer", ".", "toString", "(", "mLegacyAccounts", ".", "length", ")", "+", "\"", "<STR_LIT>", "\"", ")", ";", "setContentView", "(", "R", ".", "layout", ".", "upgrade_accounts", ")", ";", "mListView", "=", "getListView", "(", ")", ";", "mProceedButton", "=", "(", "Button", ")", "findViewById", "(", "R", ".", "id", ".", "action_button", ")", ";", "mProceedButton", ".", "setEnabled", "(", "false", ")", ";", "mProceedButton", ".", "setOnClickListener", "(", "this", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "void", "onResume", "(", ")", "{", "super", ".", "onResume", "(", ")", ";", "updateList", "(", ")", ";", "mConversionTask", "=", "new", "ConversionTask", "(", "mLegacyAccounts", ")", ";", "mConversionTask", ".", "execute", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "void", "onDestroy", "(", ")", "{", "super", ".", "onDestroy", "(", ")", ";", "if", "(", "mConversionTask", "!", "=", "null", "&", "&", "mConversionTask", ".", "getStatus", "(", ")", "!", "=", "ConversionTask", ".", "Status", ".", "FINISHED", ")", "{", "mConversionTask", ".", "cancel", "(", "true", ")", ";", "mConversionTask", "=", "null", ";", "}", "}", "</s>"]
["<s>", "public", "void", "onClick", "(", "View", "v", ")", "{", "switch", "(", "v", ".", "getId", "(", ")", ")", "{", "case", "R", ".", "id", ".", "action_button", ":", "onClickOk", "(", ")", ";", "break", ";", "}", "}", "</s>"]
["<s>", "private", "void", "onClickOk", "(", ")", "{", "Welcome", ".", "actionStart", "(", "UpgradeAccounts", ".", "this", ")", ";", "finish", "(", ")", ";", "}", "</s>"]
["<s>", "private", "void", "updateList", "(", ")", "{", "mAdapter", "=", "new", "AccountsAdapter", "(", ")", ";", "getListView", "(", ")", ".", "setAdapter", "(", "mAdapter", ")", ";", "}", "</s>"]
["<s>", "private", "void", "loadAccountInfoArray", "(", "Account", "[", "]", "legacyAccounts", ")", "{", "mLegacyAccounts", "=", "new", "AccountInfo", "[", "legacyAccounts", ".", "length", "]", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "legacyAccounts", ".", "length", ";", "i", "+", "+", ")", "{", "AccountInfo", "ai", "=", "new", "AccountInfo", "(", ")", ";", "ai", ".", "account", "=", "legacyAccounts", "[", "i", "]", ";", "ai", ".", "maxProgress", "=", "0", ";", "ai", ".", "progress", "=", "0", ";", "ai", ".", "error", "=", "null", ";", "mLegacyAccounts", "[", "i", "]", "=", "ai", ";", "}", "}", "</s>"]
["<s>", "@", "Override", "public", "boolean", "hasStableIds", "(", ")", "{", "return", "true", ";", "}", "</s>"]
["<s>", "public", "int", "getCount", "(", ")", "{", "return", "mLegacyAccounts", ".", "length", ";", "}", "</s>"]
["<s>", "public", "Object", "getItem", "(", "int", "position", ")", "{", "return", "mLegacyAccounts", "[", "position", "]", ";", "}", "</s>"]
["<s>", "public", "long", "getItemId", "(", "int", "position", ")", "{", "return", "position", ";", "}", "</s>"]
["<s>", "public", "View", "getView", "(", "int", "position", ",", "View", "convertView", ",", "ViewGroup", "parent", ")", "{", "View", "v", ";", "if", "(", "convertView", "=", "=", "null", ")", "{", "v", "=", "newView", "(", "parent", ")", ";", "}", "else", "{", "v", "=", "convertView", ";", "}", "bindView", "(", "v", ",", "position", ")", ";", "return", "v", ";", "}", "</s>"]
["<s>", "public", "View", "newView", "(", "ViewGroup", "parent", ")", "{", "View", "v", "=", "mInflater", ".", "inflate", "(", "R", ".", "layout", ".", "upgrade_accounts_item", ",", "parent", ",", "false", ")", ";", "ViewHolder", "h", "=", "new", "ViewHolder", "(", ")", ";", "h", ".", "displayName", "=", "(", "TextView", ")", "v", ".", "findViewById", "(", "R", ".", "id", ".", "name", ")", ";", "h", ".", "progress", "=", "(", "ProgressBar", ")", "v", ".", "findViewById", "(", "R", ".", "id", ".", "progress", ")", ";", "h", ".", "errorReport", "=", "(", "TextView", ")", "v", ".", "findViewById", "(", "R", ".", "id", ".", "error", ")", ";", "v", ".", "setTag", "(", "h", ")", ";", "return", "v", ";", "}", "</s>"]
["<s>", "public", "void", "bindView", "(", "View", "view", ",", "int", "position", ")", "{", "ViewHolder", "vh", "=", "(", "ViewHolder", ")", "view", ".", "getTag", "(", ")", ";", "AccountInfo", "ai", "=", "mLegacyAccounts", "[", "position", "]", ";", "vh", ".", "displayName", ".", "setText", "(", "ai", ".", "account", ".", "getDescription", "(", ")", ")", ";", "if", "(", "ai", ".", "error", "=", "=", "null", ")", "{", "vh", ".", "errorReport", ".", "setVisibility", "(", "View", ".", "GONE", ")", ";", "vh", ".", "progress", ".", "setVisibility", "(", "View", ".", "VISIBLE", ")", ";", "vh", ".", "progress", ".", "setMax", "(", "ai", ".", "maxProgress", ")", ";", "vh", ".", "progress", ".", "setProgress", "(", "ai", ".", "progress", ")", ";", "}", "else", "{", "vh", ".", "progress", ".", "setVisibility", "(", "View", ".", "GONE", ")", ";", "vh", ".", "errorReport", ".", "setVisibility", "(", "View", ".", "VISIBLE", ")", ";", "vh", ".", "errorReport", ".", "setText", "(", "ai", ".", "error", ")", ";", "}", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "handleMessage", "(", "android", ".", "os", ".", "Message", "msg", ")", "{", "switch", "(", "msg", ".", "what", ")", "{", "case", "MSG_SET_MAX", ":", "mLegacyAccounts", "[", "msg", ".", "arg1", "]", ".", "maxProgress", "=", "msg", ".", "arg2", ";", "mListView", ".", "invalidateViews", "(", ")", ";", "break", ";", "case", "MSG_SET_PROGRESS", ":", "mLegacyAccounts", "[", "msg", ".", "arg1", "]", ".", "progress", "=", "msg", ".", "arg2", ";", "mListView", ".", "invalidateViews", "(", ")", ";", "break", ";", "case", "MSG_INC_PROGRESS", ":", "mLegacyAccounts", "[", "msg", ".", "arg1", "]", ".", "progress", "+", "+", ";", "mListView", ".", "invalidateViews", "(", ")", ";", "break", ";", "case", "MSG_ERROR", ":", "mLegacyAccounts", "[", "msg", ".", "arg1", "]", ".", "error", "=", "(", "String", ")", "msg", ".", "obj", ";", "mListView", ".", "invalidateViews", "(", ")", ";", "mProceedButton", ".", "setEnabled", "(", "true", ")", ";", "break", ";", "default", ":", "super", ".", "handleMessage", "(", "msg", ")", ";", "}", "}", "</s>"]
["<s>", "public", "void", "setMaxProgress", "(", "int", "accountNum", ",", "int", "max", ")", "{", "android", ".", "os", ".", "Message", "msg", "=", "android", ".", "os", ".", "Message", ".", "obtain", "(", ")", ";", "msg", ".", "what", "=", "MSG_SET_MAX", ";", "msg", ".", "arg1", "=", "accountNum", ";", "msg", ".", "arg2", "=", "max", ";", "sendMessage", "(", "msg", ")", ";", "}", "</s>"]
["<s>", "public", "void", "setProgress", "(", "int", "accountNum", ",", "int", "progress", ")", "{", "android", ".", "os", ".", "Message", "msg", "=", "android", ".", "os", ".", "Message", ".", "obtain", "(", ")", ";", "msg", ".", "what", "=", "MSG_SET_PROGRESS", ";", "msg", ".", "arg1", "=", "accountNum", ";", "msg", ".", "arg2", "=", "progress", ";", "sendMessage", "(", "msg", ")", ";", "}", "</s>"]
["<s>", "public", "void", "incProgress", "(", "int", "accountNum", ")", "{", "android", ".", "os", ".", "Message", "msg", "=", "android", ".", "os", ".", "Message", ".", "obtain", "(", ")", ";", "msg", ".", "what", "=", "MSG_INC_PROGRESS", ";", "msg", ".", "arg1", "=", "accountNum", ";", "sendMessage", "(", "msg", ")", ";", "}", "</s>"]
["<s>", "public", "void", "error", "(", "String", "error", ")", "{", "android", ".", "os", ".", "Message", "msg", "=", "android", ".", "os", ".", "Message", ".", "obtain", "(", ")", ";", "msg", ".", "what", "=", "MSG_ERROR", ";", "msg", ".", "obj", "=", "error", ";", "sendMessage", "(", "msg", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "Void", "doInBackground", "(", "Void", ".", ".", ".", "params", ")", "{", "UIHandler", "handler", "=", "UpgradeAccounts", ".", "this", ".", "mHandler", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "mAccountInfo", ".", "length", ";", "i", "+", "+", ")", "{", "int", "estimate", "=", "UpgradeAccounts", ".", "estimateWork", "(", "mContext", ",", "mAccountInfo", "[", "i", "]", ".", "account", ")", ";", "UpgradeAccounts", ".", "this", ".", "mHandler", ".", "setMaxProgress", "(", "i", ",", "estimate", ")", ";", "}", "for", "(", "int", "i", "=", "0", ";", "i", "<", "mAccountInfo", ".", "length", ";", "i", "+", "+", ")", "{", "if", "(", "mAccountInfo", "[", "i", "]", ".", "error", "=", "=", "null", ")", "{", "cleanImapAccount", "(", "mContext", ",", "mAccountInfo", "[", "i", "]", ".", "account", ",", "i", ",", "handler", ")", ";", "}", "}", "for", "(", "int", "i", "=", "0", ";", "i", "<", "mAccountInfo", ".", "length", ";", "i", "+", "+", ")", "{", "if", "(", "mAccountInfo", "[", "i", "]", ".", "error", "=", "=", "null", ")", "{", "copyAccount", "(", "mContext", ",", "mAccountInfo", "[", "i", "]", ".", "account", ",", "i", ",", "handler", ")", ";", "}", "deleteAccountStore", "(", "mContext", ",", "mAccountInfo", "[", "i", "]", ".", "account", ",", "handler", ")", ";", "mAccountInfo", "[", "i", "]", ".", "account", ".", "delete", "(", "mPreferences", ")", ";", "UpgradeAccounts", ".", "this", ".", "mHandler", ".", "setMaxProgress", "(", "i", ",", "<NUM_LIT:100>", ")", ";", "UpgradeAccounts", ".", "this", ".", "mHandler", ".", "setProgress", "(", "i", ",", "<NUM_LIT:100>", ")", ";", "}", "return", "null", ";", "}", "</s>"]
["<s>", "@", "Override", "protected", "void", "onPostExecute", "(", "Void", "result", ")", "{", "if", "(", "!", "isCancelled", "(", ")", ")", "{", "if", "(", "!", "mProceedButton", ".", "isEnabled", "(", ")", ")", "{", "onClickOk", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "static", "int", "estimateWork", "(", "Context", "context", ",", "Account", "account", ")", "{", "int", "estimate", "=", "1", ";", "try", "{", "Store", "store", "=", "LocalStore", ".", "newInstance", "(", "account", ".", "getLocalStoreUri", "(", ")", ",", "context", ",", "null", ")", ";", "Folder", "[", "]", "folders", "=", "store", ".", "getPersonalNamespaces", "(", ")", ";", "estimate", "+", "=", "folders", ".", "length", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "folders", ".", "length", ";", "i", "+", "+", ")", "{", "Folder", "folder", "=", "folders", "[", "i", "]", ";", "folder", ".", "open", "(", "Folder", ".", "OpenMode", ".", "READ_ONLY", ",", "null", ")", ";", "estimate", "+", "=", "folder", ".", "getMessageCount", "(", ")", ";", "}", "estimate", "+", "=", "(", "(", "LocalStore", ")", "store", ")", ".", "getStoredAttachmentCount", "(", ")", ";", "}", "catch", "(", "MessagingException", "e", ")", "{", "Log", ".", "d", "(", "Email", ".", "LOG_TAG", ",", "\"", "<STR_LIT>", "\"", "+", "e", ")", ";", "}", "return", "estimate", ";", "}", "</s>"]
["<s>", "void", "cleanImapAccount", "(", "Context", "context", ",", "Account", "account", ",", "int", "accountNum", ",", "UIHandler", "handler", ")", "{", "String", "storeUri", "=", "account", ".", "getStoreUri", "(", ")", ";", "if", "(", "!", "storeUri", ".", "startsWith", "(", "Store", ".", "STORE_SCHEME_IMAP", ")", ")", "{", "return", ";", "}", "if", "(", "handler", "!", "=", "null", ")", "{", "handler", ".", "incProgress", "(", "accountNum", ")", ";", "}", "}", "</s>"]
["<s>", "void", "copyAccount", "(", "Context", "context", ",", "Account", "account", ",", "int", "accountNum", ",", "UIHandler", "handler", ")", "{", "int", "existCount", "=", "EmailContent", ".", "count", "(", "context", ",", "EmailContent", ".", "Account", ".", "CONTENT_URI", ",", "WHERE_ACCOUNT_UUID_IS", ",", "new", "String", "[", "]", "{", "account", ".", "getUuid", "(", ")", "}", ")", ";", "if", "(", "existCount", ">", "0", ")", "{", "Log", ".", "d", "(", "Email", ".", "LOG_TAG", ",", "\"", "<STR_LIT>", "\"", "+", "account", ".", "getDescription", "(", ")", ")", ";", "if", "(", "handler", "!", "=", "null", ")", "{", "handler", ".", "error", "(", "context", ".", "getString", "(", "R", ".", "string", ".", "upgrade_accounts_error", ")", ")", ";", "}", "return", ";", "}", "EmailContent", ".", "Account", "newAccount", "=", "LegacyConversions", ".", "makeAccount", "(", "context", ",", "account", ")", ";", "newAccount", ".", "save", "(", "context", ")", ";", "if", "(", "handler", "!", "=", "null", ")", "{", "handler", ".", "incProgress", "(", "accountNum", ")", ";", "}", "}", "</s>"]
["<s>", "void", "deleteAccountStore", "(", "Context", "context", ",", "Account", "account", ",", "UIHandler", "handler", ")", "{", "try", "{", "Store", "store", "=", "LocalStore", ".", "newInstance", "(", "account", ".", "getLocalStoreUri", "(", ")", ",", "context", ",", "null", ")", ";", "store", ".", "delete", "(", ")", ";", "}", "catch", "(", "MessagingException", "e", ")", "{", "Log", ".", "d", "(", "Email", ".", "LOG_TAG", ",", "\"", "<STR_LIT>", "\"", "+", "e", ")", ";", "if", "(", "handler", "!", "=", "null", ")", "{", "handler", ".", "error", "(", "context", ".", "getString", "(", "R", ".", "string", ".", "upgrade_accounts_error", ")", ")", ";", "}", "}", "}", "</s>"]
["<s>", "boolean", "bulkUpgradesRequired", "(", "Context", "context", ",", "Preferences", "preferences", ")", "{", "if", "(", "DEBUG_FORCE_UPGRADES", ")", "{", "Account", "fake", "=", "new", "Account", "(", "this", ")", ";", "fake", ".", "setDescription", "(", "\"", "<STR_LIT>", "\"", ")", ";", "fake", ".", "setEmail", "(", "\"", "<STR_LIT>", "\"", ")", ";", "fake", ".", "setName", "(", "\"", "<STR_LIT>", "\"", ")", ";", "fake", ".", "setSenderUri", "(", "\"", "<STR_LIT>", "\"", ")", ";", "fake", ".", "setStoreUri", "(", "\"", "<STR_LIT>", "\"", ")", ";", "fake", ".", "save", "(", "preferences", ")", ";", "return", "true", ";", "}", "Account", "[", "]", "legacyAccounts", "=", "preferences", ".", "getAccounts", "(", ")", ";", "if", "(", "legacyAccounts", ".", "length", "=", "=", "0", ")", "{", "return", "false", ";", "}", "if", "(", "0", "!", "=", "(", "legacyAccounts", "[", "0", "]", ".", "getBackupFlags", "(", ")", "&", "Account", ".", "BACKUP_FLAGS_IS_BACKUP", ")", ")", "{", "return", "false", ";", "}", "else", "{", "return", "true", ";", "}", "}", "</s>"]
["<s>", "public", "int", "getStoredAttachmentCount", "(", ")", "{", "try", "{", "File", "[", "]", "attachments", "=", "mAttachmentsDir", ".", "listFiles", "(", ")", ";", "return", "attachments", ".", "length", ";", "}", "catch", "(", "Exception", "e", ")", "{", "return", "0", ";", "}", "}", "</s>"]
["<s>", "@", "Override", "protected", "void", "onPostExecute", "(", "Object", "[", "]", "result", ")", "{", "if", "(", "result", "=", "=", "null", ")", "{", "return", ";", "}", "final", "String", "accountName", "=", "(", "String", ")", "result", "[", "0", "]", ";", "if", "(", "accountName", "=", "=", "null", ")", "{", "finish", "(", ")", ";", "}", "final", "int", "nAccounts", "=", "(", "Integer", ")", "result", "[", "1", "]", ";", "setTitleAccountName", "(", "accountName", ",", "nAccounts", ">", "1", ")", ";", "}", "</s>"]
["<s>", "public", "void", "onClick", "(", "View", "v", ")", "{", "switch", "(", "v", ".", "getId", "(", ")", ")", "{", "case", "R", ".", "id", ".", "account_title_button", ":", "onAccounts", "(", ")", ";", "break", ";", "}", "}", "</s>"]
["<s>", "private", "void", "setTitleAccountName", "(", "String", "accountName", ",", "boolean", "showAccountsButton", ")", "{", "TextView", "accountsButton", "=", "(", "TextView", ")", "findViewById", "(", "R", ".", "id", ".", "account_title_button", ")", ";", "TextView", "textPlain", "=", "(", "TextView", ")", "findViewById", "(", "R", ".", "id", ".", "title_right_text", ")", ";", "if", "(", "showAccountsButton", ")", "{", "accountsButton", ".", "setVisibility", "(", "View", ".", "VISIBLE", ")", ";", "textPlain", ".", "setVisibility", "(", "View", ".", "GONE", ")", ";", "accountsButton", ".", "setText", "(", "accountName", ")", ";", "}", "else", "{", "accountsButton", ".", "setVisibility", "(", "View", ".", "GONE", ")", ";", "textPlain", ".", "setVisibility", "(", "View", ".", "VISIBLE", ")", ";", "textPlain", ".", "setText", "(", "accountName", ")", ";", "}", "}", "</s>"]
["<s>", "@", "Override", "protected", "void", "onPostExecute", "(", "Object", "[", "]", "result", ")", "{", "if", "(", "result", "=", "=", "null", ")", "{", "return", ";", "}", "final", "int", "nAccounts", "=", "(", "Integer", ")", "result", "[", "<NUM_LIT:2>", "]", ";", "if", "(", "result", "[", "0", "]", "!", "=", "null", ")", "{", "setTitleAccountName", "(", "(", "String", ")", "result", "[", "0", "]", ",", "nAccounts", ">", "1", ")", ";", "}", "if", "(", "result", "[", "1", "]", "!", "=", "null", ")", "{", "mLeftTitle", ".", "setText", "(", "(", "String", ")", "result", "[", "1", "]", ")", ";", "}", "}", "</s>"]
["<s>", "void", "setInitialComposeText", "(", "CharSequence", "text", ",", "String", "signature", ")", "{", "int", "textLength", "=", "0", ";", "if", "(", "text", "!", "=", "null", ")", "{", "mMessageContentView", ".", "append", "(", "text", ")", ";", "textLength", "=", "text", ".", "length", "(", ")", ";", "}", "if", "(", "!", "TextUtils", ".", "isEmpty", "(", "signature", ")", ")", "{", "if", "(", "textLength", "=", "=", "0", "|", "|", "text", ".", "charAt", "(", "textLength", "-", "1", ")", "!", "=", "<STR_LIT:\\n>", ")", "{", "mMessageContentView", ".", "append", "(", "\"", "<STR_LIT>", "<STR_LIT>", "\"", ")", ";", "}", "mMessageContentView", ".", "append", "(", "signature", ")", ";", "}", "}", "</s>"]
["<s>", "void", "setMessageContentSelection", "(", "String", "signature", ")", "{", "int", "selection", "=", "mMessageContentView", ".", "length", "(", ")", ";", "if", "(", "!", "TextUtils", ".", "isEmpty", "(", "signature", ")", ")", "{", "int", "signatureLength", "=", "signature", ".", "length", "(", ")", ";", "int", "estimatedSelection", "=", "selection", "-", "signatureLength", ";", "if", "(", "estimatedSelection", ">", "=", "0", ")", "{", "CharSequence", "text", "=", "mMessageContentView", ".", "getText", "(", ")", ";", "int", "i", "=", "0", ";", "while", "(", "i", "<", "signatureLength", "&", "&", "text", ".", "charAt", "(", "estimatedSelection", "+", "i", ")", "=", "=", "signature", ".", "charAt", "(", "i", ")", ")", "{", "+", "+", "i", ";", "}", "if", "(", "i", "=", "=", "signatureLength", ")", "{", "selection", "=", "estimatedSelection", ";", "while", "(", "selection", ">", "0", "&", "&", "text", ".", "charAt", "(", "selection", "-", "1", ")", "=", "=", "<STR_LIT:\\n>", ")", "{", "-", "-", "selection", ";", "}", "}", "}", "}", "mMessageContentView", ".", "setSelection", "(", "selection", ",", "selection", ")", ";", "}", "</s>"]
["<s>", "private", "void", "checkFields", "(", "String", "to", ",", "String", "cc", ",", "String", "bcc", ",", "String", "subject", ",", "String", "content", ",", "String", "signature", ")", "{", "String", "toText", "=", "mToView", ".", "getText", "(", ")", ".", "toString", "(", ")", ";", "if", "(", "to", "=", "=", "null", ")", "{", "assertEquals", "(", "0", ",", "toText", ".", "length", "(", ")", ")", ";", "}", "else", "{", "assertEquals", "(", "to", ",", "toText", ")", ";", "}", "String", "subjectText", "=", "mSubjectView", ".", "getText", "(", ")", ".", "toString", "(", ")", ";", "if", "(", "subject", "=", "=", "null", ")", "{", "assertEquals", "(", "0", ",", "subjectText", ".", "length", "(", ")", ")", ";", "}", "else", "{", "assertEquals", "(", "subject", ",", "subjectText", ")", ";", "}", "String", "contentText", "=", "mMessageView", ".", "getText", "(", ")", ".", "toString", "(", ")", ";", "if", "(", "content", "=", "=", "null", ")", "{", "assertEquals", "(", "0", ",", "contentText", ".", "length", "(", ")", ")", ";", "}", "else", "{", "if", "(", "signature", "!", "=", "null", ")", "{", "int", "textLength", "=", "content", ".", "length", "(", ")", ";", "if", "(", "textLength", "=", "=", "0", "|", "|", "content", ".", "charAt", "(", "textLength", "-", "1", ")", "!", "=", "<STR_LIT:\\n>", ")", "{", "content", "+", "=", "\"", "<STR_LIT>", "<STR_LIT>", "\"", ";", "}", "content", "+", "=", "signature", ";", "}", "assertEquals", "(", "content", ",", "contentText", ")", ";", "}", "}", "</s>"]
["<s>", "public", "void", "testSetInitialComposeTextAndSelection", "(", ")", "throws", "MessagingException", ",", "Throwable", "{", "final", "Message", "msg", "=", "buildTestMessage", "(", "null", ",", "null", ",", "null", ",", "BODY", ")", ";", "final", "Intent", "intent", "=", "new", "Intent", "(", "ACTION_EDIT_DRAFT", ")", ";", "final", "Account", "account", "=", "new", "Account", "(", ")", ";", "final", "MessageCompose", "a", "=", "getActivity", "(", ")", ";", "a", ".", "setIntent", "(", "intent", ")", ";", "runTestOnUiThread", "(", "new", "Runnable", "(", ")", "{", "public", "void", "run", "(", ")", "{", "resetViews", "(", ")", ";", "a", ".", "setInitialComposeText", "(", "BODY", ",", "SIGNATURE", ")", ";", "checkFields", "(", "null", ",", "null", ",", "null", ",", "null", ",", "BODY", ",", "SIGNATURE", ")", ";", "a", ".", "setMessageContentSelection", "(", "SIGNATURE", ")", ";", "assertEquals", "(", "BODY", ".", "length", "(", ")", ",", "mMessageView", ".", "getSelectionStart", "(", ")", ")", ";", "}", "}", ")", ";", "runTestOnUiThread", "(", "new", "Runnable", "(", ")", "{", "public", "void", "run", "(", ")", "{", "resetViews", "(", ")", ";", "a", ".", "setInitialComposeText", "(", "BODY", ",", "null", ")", ";", "checkFields", "(", "null", ",", "null", ",", "null", ",", "null", ",", "BODY", ",", "null", ")", ";", "a", ".", "setMessageContentSelection", "(", "null", ")", ";", "assertEquals", "(", "BODY", ".", "length", "(", ")", ",", "mMessageView", ".", "getSelectionStart", "(", ")", ")", ";", "}", "}", ")", ";", "runTestOnUiThread", "(", "new", "Runnable", "(", ")", "{", "public", "void", "run", "(", ")", "{", "resetViews", "(", ")", ";", "final", "String", "body2", "=", "BODY", "+", "\"", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "<STR_LIT>", "\"", ";", "a", ".", "setInitialComposeText", "(", "body2", ",", "SIGNATURE", ")", ";", "checkFields", "(", "null", ",", "null", ",", "null", ",", "null", ",", "body2", ",", "SIGNATURE", ")", ";", "a", ".", "setMessageContentSelection", "(", "SIGNATURE", ")", ";", "assertEquals", "(", "BODY", ".", "length", "(", ")", "+", "<NUM_LIT:3>", ",", "mMessageView", ".", "getSelectionStart", "(", ")", ")", ";", "}", "}", ")", ";", "}", "</s>"]
["<s>", "public", "static", "Mailbox", "restoreMailboxOfType", "(", "Context", "context", ",", "long", "accountId", ",", "int", "type", ")", "{", "long", "mailboxId", "=", "findMailboxOfType", "(", "context", ",", "accountId", ",", "type", ")", ";", "if", "(", "mailboxId", "!", "=", "Mailbox", ".", "NO_MAILBOX", ")", "{", "return", "Mailbox", ".", "restoreMailboxWithId", "(", "context", ",", "mailboxId", ")", ";", "}", "return", "null", ";", "}", "</s>"]
["<s>", "private", "void", "registerCalendarObserver", "(", "Account", "account", ")", "{", "CalendarObserver", "observer", "=", "new", "CalendarObserver", "(", "mHandler", ",", "account", ")", ";", "if", "(", "observer", ".", "mCalendarId", "!", "=", "0", ")", "{", "mCalendarObservers", ".", "put", "(", "observer", ".", "mCalendarId", ",", "observer", ")", ";", "mResolver", ".", "registerContentObserver", "(", "ContentUris", ".", "withAppendedId", "(", "Calendars", ".", "CONTENT_URI", ",", "observer", ".", "mCalendarId", ")", ",", "false", ",", "observer", ")", ";", "}", "}", "</s>"]
["<s>", "private", "void", "unregisterCalendarObservers", "(", ")", "{", "for", "(", "CalendarObserver", "observer", ":", "mCalendarObservers", ".", "values", "(", ")", ")", "{", "mResolver", ".", "unregisterContentObserver", "(", "observer", ")", ";", "}", "mCalendarObservers", ".", "clear", "(", ")", ";", "}", "</s>"]
["<s>", "@", "Override", "public", "void", "onChange", "(", "boolean", "selfChange", ")", "{", "if", "(", "!", "selfChange", ")", "{", "Cursor", "c", "=", "mResolver", ".", "query", "(", "Calendars", ".", "CONTENT_URI", ",", "new", "String", "[", "]", "{", "Calendars", ".", "SYNC_EVENTS", "}", ",", "Calendars", ".", "_ID", "+", "\"", "<STR_LIT>", "\"", ",", "new", "String", "[", "]", "{", "Long", ".", "toString", "(", "mCalendarId", ")", "}", ",", "null", ")", ";", "try", "{", "if", "(", "c", ".", "moveToFirst", "(", ")", ")", "{", "long", "newSyncEvents", "=", "c", ".", "getLong", "(", "0", ")", ";", "if", "(", "newSyncEvents", "!", "=", "mSyncEvents", ")", "{", "android", ".", "accounts", ".", "Account", "account", "=", "new", "android", ".", "accounts", ".", "Account", "(", "mAccountName", ",", "Email", ".", "EXCHANGE_ACCOUNT_MANAGER_TYPE", ")", ";", "ContentResolver", ".", "setSyncAutomatically", "(", "account", ",", "Calendar", ".", "AUTHORITY", ",", "newSyncEvents", "!", "=", "0", ")", ";", "if", "(", "newSyncEvents", "=", "=", "0", ")", "{", "Mailbox", "mailbox", "=", "Mailbox", ".", "restoreMailboxOfType", "(", "INSTANCE", ",", "mAccountId", ",", "Mailbox", ".", "TYPE_CALENDAR", ")", ";", "EasSyncService", "service", "=", "new", "EasSyncService", "(", "INSTANCE", ",", "mailbox", ")", ";", "CalendarSyncAdapter", "adapter", "=", "new", "CalendarSyncAdapter", "(", "mailbox", ",", "service", ")", ";", "try", "{", "adapter", ".", "setSyncKey", "(", "\"", "<STR_LIT:0>", "\"", ",", "false", ")", ";", "}", "catch", "(", "IOException", "e", ")", "{", "}", "ContentValues", "cv", "=", "new", "ContentValues", "(", ")", ";", "cv", ".", "put", "(", "Mailbox", ".", "SYNC_KEY", ",", "\"", "<STR_LIT:0>", "\"", ")", ";", "mResolver", ".", "update", "(", "ContentUris", ".", "withAppendedId", "(", "Mailbox", ".", "CONTENT_URI", ",", "mailbox", ".", "mId", ")", ",", "cv", ",", "null", ",", "null", ")", ";", "}", "mSyncEvents", "=", "newSyncEvents", ";", "}", "}", "}", "finally", "{", "c", ".", "close", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "private", "void", "updatePIMSyncSettings", "(", "Account", "providerAccount", ",", "int", "mailboxType", ",", "String", "authority", ")", "{", "ContentValues", "cv", "=", "new", "ContentValues", "(", ")", ";", "long", "mailboxId", "=", "Mailbox", ".", "findMailboxOfType", "(", "this", ",", "providerAccount", ".", "mId", ",", "mailboxType", ")", ";", "if", "(", "mailboxId", "!", "=", "Mailbox", ".", "NO_MAILBOX", ")", "{", "android", ".", "accounts", ".", "Account", "acct", "=", "new", "android", ".", "accounts", ".", "Account", "(", "providerAccount", ".", "mEmailAddress", ",", "Email", ".", "EXCHANGE_ACCOUNT_MANAGER_TYPE", ")", ";", "Mailbox", "mailbox", "=", "Mailbox", ".", "restoreMailboxWithId", "(", "this", ",", "mailboxId", ")", ";", "int", "syncInterval", "=", "mailbox", ".", "mSyncInterval", ";", "if", "(", "ContentResolver", ".", "getIsSyncable", "(", "acct", ",", "authority", ")", ">", "0", ")", "{", "if", "(", "ContentResolver", ".", "getSyncAutomatically", "(", "acct", ",", "authority", ")", ")", "{", "if", "(", "syncInterval", "=", "=", "Mailbox", ".", "CHECK_INTERVAL_NEVER", "|", "|", "syncInterval", ">", "0", ")", "{", "log", "(", "\"", "<STR_LIT>", "\"", "+", "mailbox", ".", "mDisplayName", "+", "\"", "<STR_LIT>", "\"", "+", "acct", ".", "name", "+", "\"", "<STR_LIT>", "\"", ")", ";", "cv", ".", "put", "(", "MailboxColumns", ".", "SYNC_INTERVAL", ",", "Mailbox", ".", "CHECK_INTERVAL_PUSH", ")", ";", "}", "}", "else", "if", "(", "syncInterval", "!", "=", "Mailbox", ".", "CHECK_INTERVAL_NEVER", ")", "{", "log", "(", "\"", "<STR_LIT>", "\"", "+", "mailbox", ".", "mDisplayName", "+", "\"", "<STR_LIT>", "\"", "+", "acct", ".", "name", "+", "\"", "<STR_LIT>", "\"", ")", ";", "cv", ".", "put", "(", "MailboxColumns", ".", "SYNC_INTERVAL", ",", "Mailbox", ".", "CHECK_INTERVAL_NEVER", ")", ";", "}", "}", "else", "if", "(", "syncInterval", "!", "=", "Mailbox", ".", "CHECK_INTERVAL_NEVER", ")", "{", "log", "(", "\"", "<STR_LIT>", "\"", "+", "mailbox", ".", "mDisplayName", "+", "\"", "<STR_LIT>", "\"", "+", "acct", ".", "name", "+", "\"", "<STR_LIT>", "\"", ")", ";", "cv", ".", "put", "(", "MailboxColumns", ".", "SYNC_INTERVAL", ",", "Mailbox", ".", "CHECK_INTERVAL_NEVER", ")", ";", "}", "if", "(", "cv", ".", "containsKey", "(", "MailboxColumns", ".", "SYNC_INTERVAL", ")", ")", "{", "mResolver", ".", "update", "(", "ContentUris", ".", "withAppendedId", "(", "Mailbox", ".", "CONTENT_URI", ",", "mailboxId", ")", ",", "cv", ",", "null", ",", "null", ")", ";", "kick", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "}", "}", "</s>"]
["<s>", "public", "static", "Mailbox", "setupMailbox", "(", "String", "name", ",", "long", "accountId", ",", "boolean", "saveIt", ",", "Context", "context", ",", "int", "type", ")", "{", "Mailbox", "box", "=", "new", "Mailbox", "(", ")", ";", "box", ".", "mDisplayName", "=", "name", ";", "box", ".", "mServerId", "=", "\"", "<STR_LIT:->", "\"", "+", "name", ";", "box", ".", "mParentServerId", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "box", ".", "mAccountKey", "=", "accountId", ";", "box", ".", "mType", "=", "type", ";", "box", ".", "mDelimiter", "=", "1", ";", "box", ".", "mSyncKey", "=", "\"", "<STR_LIT>", "\"", "+", "name", ";", "box", ".", "mSyncLookback", "=", "<NUM_LIT:2>", ";", "box", ".", "mSyncInterval", "=", "EmailContent", ".", "Account", ".", "CHECK_INTERVAL_NEVER", ";", "box", ".", "mSyncTime", "=", "<NUM_LIT:3>", ";", "box", ".", "mUnreadCount", "=", "0", ";", "box", ".", "mFlagVisible", "=", "true", ";", "box", ".", "mFlags", "=", "<NUM_LIT:5>", ";", "box", ".", "mVisibleLimit", "=", "<NUM_LIT:6>", ";", "if", "(", "saveIt", ")", "{", "box", ".", "save", "(", "context", ")", ";", "}", "return", "box", ";", "}", "</s>"]
["<s>", "public", "void", "testFindMailboxOfType", "(", ")", "{", "final", "Context", "context", "=", "mMockContext", ";", "Account", "acct1", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT:1>", "\"", ",", "true", ",", "context", ")", ";", "Mailbox", "acct1Inbox", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT>", "\"", ",", "acct1", ".", "mId", ",", "true", ",", "context", ",", "Mailbox", ".", "TYPE_INBOX", ")", ";", "Mailbox", "acct1Calendar", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT>", "\"", ",", "acct1", ".", "mId", ",", "true", ",", "context", ",", "Mailbox", ".", "TYPE_CALENDAR", ")", ";", "Mailbox", "acct1Contacts", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT>", "\"", ",", "acct1", ".", "mId", ",", "true", ",", "context", ",", "Mailbox", ".", "TYPE_CONTACTS", ")", ";", "Account", "acct2", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT:1>", "\"", ",", "true", ",", "context", ")", ";", "Mailbox", "acct2Inbox", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT>", "\"", ",", "acct2", ".", "mId", ",", "true", ",", "context", ",", "Mailbox", ".", "TYPE_INBOX", ")", ";", "Mailbox", "acct2Calendar", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT>", "\"", ",", "acct2", ".", "mId", ",", "true", ",", "context", ",", "Mailbox", ".", "TYPE_CALENDAR", ")", ";", "Mailbox", "acct2Contacts", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT>", "\"", ",", "acct2", ".", "mId", ",", "true", ",", "context", ",", "Mailbox", ".", "TYPE_CONTACTS", ")", ";", "assertEquals", "(", "acct1Inbox", ".", "mId", ",", "Mailbox", ".", "findMailboxOfType", "(", "context", ",", "acct1", ".", "mId", ",", "Mailbox", ".", "TYPE_INBOX", ")", ")", ";", "assertEquals", "(", "acct2Inbox", ".", "mId", ",", "Mailbox", ".", "findMailboxOfType", "(", "context", ",", "acct2", ".", "mId", ",", "Mailbox", ".", "TYPE_INBOX", ")", ")", ";", "assertEquals", "(", "acct1Calendar", ".", "mId", ",", "Mailbox", ".", "findMailboxOfType", "(", "context", ",", "acct1", ".", "mId", ",", "Mailbox", ".", "TYPE_CALENDAR", ")", ")", ";", "assertEquals", "(", "acct2Calendar", ".", "mId", ",", "Mailbox", ".", "findMailboxOfType", "(", "context", ",", "acct2", ".", "mId", ",", "Mailbox", ".", "TYPE_CALENDAR", ")", ")", ";", "assertEquals", "(", "acct1Contacts", ".", "mId", ",", "Mailbox", ".", "findMailboxOfType", "(", "context", ",", "acct1", ".", "mId", ",", "Mailbox", ".", "TYPE_CONTACTS", ")", ")", ";", "assertEquals", "(", "acct2Contacts", ".", "mId", ",", "Mailbox", ".", "findMailboxOfType", "(", "context", ",", "acct2", ".", "mId", ",", "Mailbox", ".", "TYPE_CONTACTS", ")", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testRestoreMailboxOfType", "(", ")", "{", "final", "Context", "context", "=", "mMockContext", ";", "Account", "acct1", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT:1>", "\"", ",", "true", ",", "context", ")", ";", "Mailbox", "acct1Inbox", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT>", "\"", ",", "acct1", ".", "mId", ",", "true", ",", "context", ",", "Mailbox", ".", "TYPE_INBOX", ")", ";", "Mailbox", "acct1Calendar", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT>", "\"", ",", "acct1", ".", "mId", ",", "true", ",", "context", ",", "Mailbox", ".", "TYPE_CALENDAR", ")", ";", "Mailbox", "acct1Contacts", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT>", "\"", ",", "acct1", ".", "mId", ",", "true", ",", "context", ",", "Mailbox", ".", "TYPE_CONTACTS", ")", ";", "Account", "acct2", "=", "ProviderTestUtils", ".", "setupAccount", "(", "\"", "<STR_LIT:1>", "\"", ",", "true", ",", "context", ")", ";", "Mailbox", "acct2Inbox", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT>", "\"", ",", "acct2", ".", "mId", ",", "true", ",", "context", ",", "Mailbox", ".", "TYPE_INBOX", ")", ";", "Mailbox", "acct2Calendar", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT>", "\"", ",", "acct2", ".", "mId", ",", "true", ",", "context", ",", "Mailbox", ".", "TYPE_CALENDAR", ")", ";", "Mailbox", "acct2Contacts", "=", "ProviderTestUtils", ".", "setupMailbox", "(", "\"", "<STR_LIT>", "\"", ",", "acct2", ".", "mId", ",", "true", ",", "context", ",", "Mailbox", ".", "TYPE_CONTACTS", ")", ";", "ProviderTestUtils", ".", "assertMailboxEqual", "(", "\"", "<STR_LIT>", "\"", ",", "acct1Inbox", ",", "Mailbox", ".", "restoreMailboxOfType", "(", "context", ",", "acct1", ".", "mId", ",", "Mailbox", ".", "TYPE_INBOX", ")", ")", ";", "ProviderTestUtils", ".", "assertMailboxEqual", "(", "\"", "<STR_LIT>", "\"", ",", "acct2Inbox", ",", "Mailbox", ".", "restoreMailboxOfType", "(", "context", ",", "acct2", ".", "mId", ",", "Mailbox", ".", "TYPE_INBOX", ")", ")", ";", "ProviderTestUtils", ".", "assertMailboxEqual", "(", "\"", "<STR_LIT>", "\"", ",", "acct1Calendar", ",", "Mailbox", ".", "restoreMailboxOfType", "(", "context", ",", "acct1", ".", "mId", ",", "Mailbox", ".", "TYPE_CALENDAR", ")", ")", ";", "ProviderTestUtils", ".", "assertMailboxEqual", "(", "\"", "<STR_LIT>", "\"", ",", "acct2Calendar", ",", "Mailbox", ".", "restoreMailboxOfType", "(", "context", ",", "acct2", ".", "mId", ",", "Mailbox", ".", "TYPE_CALENDAR", ")", ")", ";", "ProviderTestUtils", ".", "assertMailboxEqual", "(", "\"", "<STR_LIT>", "\"", ",", "acct1Contacts", ",", "Mailbox", ".", "restoreMailboxOfType", "(", "context", ",", "acct1", ".", "mId", ",", "Mailbox", ".", "TYPE_CONTACTS", ")", ")", ";", "ProviderTestUtils", ".", "assertMailboxEqual", "(", "\"", "<STR_LIT>", "\"", ",", "acct2Contacts", ",", "Mailbox", ".", "restoreMailboxOfType", "(", "context", ",", "acct2", ".", "mId", ",", "Mailbox", ".", "TYPE_CONTACTS", ")", ")", ";", "}", "</s>"]
["<s>", "static", "String", "recurrenceUntilToEasUntil", "(", "String", "until", ")", "{", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", ")", ";", "sb", ".", "append", "(", "until", ".", "substring", "(", "0", ",", "<NUM_LIT:4>", ")", ")", ";", "sb", ".", "append", "(", "<CHAR_LIT:->", ")", ";", "sb", ".", "append", "(", "until", ".", "substring", "(", "<NUM_LIT:4>", ",", "<NUM_LIT:6>", ")", ")", ";", "sb", ".", "append", "(", "<CHAR_LIT:->", ")", ";", "if", "(", "until", ".", "length", "(", ")", "=", "=", "<NUM_LIT:8>", ")", "{", "sb", ".", "append", "(", "until", ".", "substring", "(", "<NUM_LIT:6>", ",", "<NUM_LIT:8>", ")", ")", ";", "sb", ".", "append", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "else", "{", "sb", ".", "append", "(", "until", ".", "substring", "(", "<NUM_LIT:6>", ",", "<NUM_LIT:11>", ")", ")", ";", "sb", ".", "append", "(", "<CHAR_LIT::>", ")", ";", "sb", ".", "append", "(", "until", ".", "substring", "(", "<NUM_LIT:11>", ",", "<NUM_LIT>", ")", ")", ";", "sb", ".", "append", "(", "<CHAR_LIT::>", ")", ";", "sb", ".", "append", "(", "until", ".", "substring", "(", "<NUM_LIT>", ",", "<NUM_LIT:15>", ")", ")", ";", "}", "sb", ".", "append", "(", "\"", "<STR_LIT>", "\"", ")", ";", "return", "sb", ".", "toString", "(", ")", ";", "}", "</s>"]
["<s>", "static", "void", "addUntil", "(", "String", "rrule", ",", "Serializer", "s", ")", "throws", "IOException", "{", "String", "until", "=", "tokenFromRrule", "(", "rrule", ",", "\"", "<STR_LIT>", "\"", ")", ";", "if", "(", "until", "!", "=", "null", ")", "{", "s", ".", "data", "(", "Tags", ".", "CALENDAR_RECURRENCE_UNTIL", ",", "recurrenceUntilToEasUntil", "(", "until", ")", ")", ";", "}", "}", "</s>"]
["<s>", "public", "void", "testRecurrenceUntilToEasUntil", "(", ")", "{", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "CalendarUtilities", ".", "recurrenceUntilToEasUntil", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "assertEquals", "(", "\"", "<STR_LIT>", "\"", ",", "CalendarUtilities", ".", "recurrenceUntilToEasUntil", "(", "\"", "<STR_LIT>", "\"", ")", ")", ";", "}", "</s>"]
["<s>", "private", "String", "getPolicyType", "(", ")", "{", "return", "(", "mProtocolVersionDouble", ">", "=", "<NUM_LIT>", ")", "?", "EAS_12_POLICY_TYPE", ":", "EAS_2_POLICY_TYPE", ";", "}", "</s>"]
["<s>", "public", "void", "parseProvisionDocXml", "(", "String", "doc", ")", "throws", "IOException", "{", "ShadowPolicySet", "sps", "=", "new", "ShadowPolicySet", "(", ")", ";", "try", "{", "XmlPullParserFactory", "factory", "=", "XmlPullParserFactory", ".", "newInstance", "(", ")", ";", "XmlPullParser", "parser", "=", "factory", ".", "newPullParser", "(", ")", ";", "parser", ".", "setInput", "(", "new", "ByteArrayInputStream", "(", "doc", ".", "getBytes", "(", ")", ")", ",", "\"", "<STR_LIT:UTF-8>", "\"", ")", ";", "int", "type", "=", "parser", ".", "getEventType", "(", ")", ";", "if", "(", "type", "=", "=", "XmlPullParser", ".", "START_DOCUMENT", ")", "{", "type", "=", "parser", ".", "next", "(", ")", ";", "if", "(", "type", "=", "=", "XmlPullParser", ".", "START_TAG", ")", "{", "String", "tagName", "=", "parser", ".", "getName", "(", ")", ";", "if", "(", "tagName", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "parseWapProvisioningDoc", "(", "parser", ",", "sps", ")", ";", "}", "}", "}", "}", "catch", "(", "XmlPullParserException", "e", ")", "{", "throw", "new", "IOException", "(", ")", ";", "}", "mPolicySet", "=", "new", "PolicySet", "(", "sps", ".", "mMinPasswordLength", ",", "sps", ".", "mPasswordMode", ",", "sps", ".", "mMaxPasswordFails", ",", "sps", ".", "mMaxScreenLockTime", ",", "true", ")", ";", "}", "</s>"]
["<s>", "boolean", "parseSecurityPolicy", "(", "XmlPullParser", "parser", ",", "ShadowPolicySet", "sps", ")", "throws", "XmlPullParserException", ",", "IOException", "{", "boolean", "passwordRequired", "=", "true", ";", "while", "(", "true", ")", "{", "int", "type", "=", "parser", ".", "nextTag", "(", ")", ";", "if", "(", "type", "=", "=", "XmlPullParser", ".", "END_TAG", "&", "&", "parser", ".", "getName", "(", ")", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "break", ";", "}", "else", "if", "(", "type", "=", "=", "XmlPullParser", ".", "START_TAG", ")", "{", "String", "tagName", "=", "parser", ".", "getName", "(", ")", ";", "if", "(", "tagName", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "String", "name", "=", "parser", ".", "getAttributeValue", "(", "null", ",", "\"", "<STR_LIT>", "\"", ")", ";", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "String", "value", "=", "parser", ".", "getAttributeValue", "(", "null", ",", "\"", "<STR_LIT>", "\"", ")", ";", "if", "(", "value", ".", "equals", "(", "\"", "<STR_LIT:1>", "\"", ")", ")", "{", "passwordRequired", "=", "false", ";", "}", "}", "}", "}", "}", "return", "passwordRequired", ";", "}", "</s>"]
["<s>", "void", "parseCharacteristic", "(", "XmlPullParser", "parser", ",", "ShadowPolicySet", "sps", ")", "throws", "XmlPullParserException", ",", "IOException", "{", "boolean", "enforceInactivityTimer", "=", "true", ";", "while", "(", "true", ")", "{", "int", "type", "=", "parser", ".", "nextTag", "(", ")", ";", "if", "(", "type", "=", "=", "XmlPullParser", ".", "END_TAG", "&", "&", "parser", ".", "getName", "(", ")", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "break", ";", "}", "else", "if", "(", "type", "=", "=", "XmlPullParser", ".", "START_TAG", ")", "{", "if", "(", "parser", ".", "getName", "(", ")", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "String", "name", "=", "parser", ".", "getAttributeValue", "(", "null", ",", "\"", "<STR_LIT>", "\"", ")", ";", "String", "value", "=", "parser", ".", "getAttributeValue", "(", "null", ",", "\"", "<STR_LIT>", "\"", ")", ";", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "if", "(", "enforceInactivityTimer", ")", "{", "if", "(", "value", ".", "equals", "(", "\"", "<STR_LIT:0>", "\"", ")", ")", "{", "sps", ".", "mMaxScreenLockTime", "=", "1", ";", "}", "else", "{", "sps", ".", "mMaxScreenLockTime", "=", "<NUM_LIT>", "*", "Integer", ".", "parseInt", "(", "value", ")", ";", "}", "}", "}", "else", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "if", "(", "value", ".", "equals", "(", "\"", "<STR_LIT:0>", "\"", ")", ")", "{", "enforceInactivityTimer", "=", "false", ";", "}", "}", "else", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "sps", ".", "mMaxPasswordFails", "=", "Integer", ".", "parseInt", "(", "value", ")", ";", "}", "else", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "}", "else", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "sps", ".", "mMinPasswordLength", "=", "Integer", ".", "parseInt", "(", "value", ")", ";", "}", "else", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "if", "(", "value", ".", "equals", "(", "\"", "<STR_LIT:0>", "\"", ")", ")", "{", "sps", ".", "mPasswordMode", "=", "PolicySet", ".", "PASSWORD_MODE_STRONG", ";", "}", "else", "{", "sps", ".", "mPasswordMode", "=", "PolicySet", ".", "PASSWORD_MODE_SIMPLE", ";", "}", "}", "}", "}", "}", "}", "</s>"]
["<s>", "void", "parseRegistry", "(", "XmlPullParser", "parser", ",", "ShadowPolicySet", "sps", ")", "throws", "XmlPullParserException", ",", "IOException", "{", "while", "(", "true", ")", "{", "int", "type", "=", "parser", ".", "nextTag", "(", ")", ";", "if", "(", "type", "=", "=", "XmlPullParser", ".", "END_TAG", "&", "&", "parser", ".", "getName", "(", ")", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "break", ";", "}", "else", "if", "(", "type", "=", "=", "XmlPullParser", ".", "START_TAG", ")", "{", "String", "name", "=", "parser", ".", "getName", "(", ")", ";", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "parseCharacteristic", "(", "parser", ",", "sps", ")", ";", "}", "}", "}", "}", "</s>"]
["<s>", "void", "parseWapProvisioningDoc", "(", "XmlPullParser", "parser", ",", "ShadowPolicySet", "sps", ")", "throws", "XmlPullParserException", ",", "IOException", "{", "while", "(", "true", ")", "{", "int", "type", "=", "parser", ".", "nextTag", "(", ")", ";", "if", "(", "type", "=", "=", "XmlPullParser", ".", "END_TAG", "&", "&", "parser", ".", "getName", "(", ")", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "break", ";", "}", "else", "if", "(", "type", "=", "=", "XmlPullParser", ".", "START_TAG", ")", "{", "String", "name", "=", "parser", ".", "getName", "(", ")", ";", "if", "(", "name", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "String", "atype", "=", "parser", ".", "getAttributeValue", "(", "null", ",", "\"", "<STR_LIT>", "\"", ")", ";", "if", "(", "atype", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "if", "(", "!", "parseSecurityPolicy", "(", "parser", ",", "sps", ")", ")", "{", "return", ";", "}", "}", "else", "if", "(", "atype", ".", "equals", "(", "\"", "<STR_LIT>", "\"", ")", ")", "{", "parseRegistry", "(", "parser", ",", "sps", ")", ";", "return", ";", "}", "}", "}", "}", "}", "</s>"]
["<s>", "public", "void", "testWapProvisionParser1", "(", ")", "throws", "IOException", "{", "ProvisionParser", "parser", "=", "new", "ProvisionParser", "(", "mTestInputStream", ",", "getTestService", "(", ")", ")", ";", "parser", ".", "parseProvisionDocXml", "(", "mWapProvisioningDoc1", ")", ";", "PolicySet", "ps", "=", "parser", ".", "getPolicySet", "(", ")", ";", "assertNotNull", "(", "ps", ")", ";", "assertEquals", "(", "<NUM_LIT:5>", "*", "<NUM_LIT>", ",", "ps", ".", "mMaxScreenLockTime", ")", ";", "assertEquals", "(", "<NUM_LIT:8>", ",", "ps", ".", "mMinPasswordLength", ")", ";", "assertEquals", "(", "PolicySet", ".", "PASSWORD_MODE_STRONG", ",", "ps", ".", "mPasswordMode", ")", ";", "assertEquals", "(", "<NUM_LIT:20>", ",", "ps", ".", "mMaxPasswordFails", ")", ";", "assertTrue", "(", "ps", ".", "mRequireRemoteWipe", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testWapProvisionParser2", "(", ")", "throws", "IOException", "{", "ProvisionParser", "parser", "=", "new", "ProvisionParser", "(", "mTestInputStream", ",", "getTestService", "(", ")", ")", ";", "parser", ".", "parseProvisionDocXml", "(", "mWapProvisioningDoc2", ")", ";", "PolicySet", "ps", "=", "parser", ".", "getPolicySet", "(", ")", ";", "assertNotNull", "(", "ps", ")", ";", "assertEquals", "(", "PolicySet", ".", "PASSWORD_MODE_NONE", ",", "ps", ".", "mPasswordMode", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testWapProvisionParser3", "(", ")", "throws", "IOException", "{", "ProvisionParser", "parser", "=", "new", "ProvisionParser", "(", "mTestInputStream", ",", "getTestService", "(", ")", ")", ";", "parser", ".", "parseProvisionDocXml", "(", "mWapProvisioningDoc3", ")", ";", "PolicySet", "ps", "=", "parser", ".", "getPolicySet", "(", ")", ";", "assertNotNull", "(", "ps", ")", ";", "assertEquals", "(", "<NUM_LIT:2>", "*", "<NUM_LIT>", ",", "ps", ".", "mMaxScreenLockTime", ")", ";", "assertEquals", "(", "<NUM_LIT:4>", ",", "ps", ".", "mMinPasswordLength", ")", ";", "assertEquals", "(", "PolicySet", ".", "PASSWORD_MODE_SIMPLE", ",", "ps", ".", "mPasswordMode", ")", ";", "assertEquals", "(", "<NUM_LIT:5>", ",", "ps", ".", "mMaxPasswordFails", ")", ";", "assertTrue", "(", "ps", ".", "mRequireRemoteWipe", ")", ";", "}", "</s>"]
["<s>", "private", "void", "meetingRequestParser", "(", "Message", "msg", ")", "throws", "IOException", "{", "while", "(", "nextTag", "(", "Tags", ".", "EMAIL_MEETING_REQUEST", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "EMAIL_START_TIME", ":", "msg", ".", "mMeetingInfo", "=", "Long", ".", "toString", "(", "CalendarUtilities", ".", "parseEmailDateTimeToMillis", "(", "getValue", "(", ")", ")", ")", ";", "break", ";", "case", "Tags", ".", "EMAIL_CATEGORIES", ":", "nullParser", "(", ")", ";", "break", ";", "case", "Tags", ".", "EMAIL_RECURRENCES", ":", "recurrencesParser", "(", ")", ";", "break", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "private", "void", "nullParser", "(", ")", "throws", "IOException", "{", "while", "(", "nextTag", "(", "Tags", ".", "EMAIL_CATEGORIES", ")", "!", "=", "END", ")", "{", "skipTag", "(", ")", ";", "}", "}", "</s>"]
["<s>", "private", "void", "recurrencesParser", "(", ")", "throws", "IOException", "{", "while", "(", "nextTag", "(", "Tags", ".", "EMAIL_RECURRENCES", ")", "!", "=", "END", ")", "{", "switch", "(", "tag", ")", "{", "case", "Tags", ".", "EMAIL_RECURRENCE", ":", "nullParser", "(", ")", ";", "default", ":", "skipTag", "(", ")", ";", "}", "}", "}", "</s>"]
["<s>", "static", "public", "long", "parseEmailDateTimeToMillis", "(", "String", "date", ")", "{", "GregorianCalendar", "cal", "=", "new", "GregorianCalendar", "(", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "0", ",", "<NUM_LIT:4>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:5>", ",", "<NUM_LIT:7>", ")", ")", "-", "1", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:8>", ",", "<NUM_LIT:10>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT:11>", ",", "<NUM_LIT>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT>", ",", "<NUM_LIT:16>", ")", ")", ",", "Integer", ".", "parseInt", "(", "date", ".", "substring", "(", "<NUM_LIT>", ",", "<NUM_LIT>", ")", ")", ")", ";", "cal", ".", "setTimeZone", "(", "TimeZone", ".", "getTimeZone", "(", "\"", "<STR_LIT:GMT>", "\"", ")", ")", ";", "return", "cal", ".", "getTimeInMillis", "(", ")", ";", "}", "</s>"]
["<s>", "public", "void", "testParseEmailDateTimeToMillis", "(", "String", "date", ")", "{", "String", "dateString", "=", "\"", "<STR_LIT>", "\"", ";", "long", "dateTime", "=", "CalendarUtilities", ".", "parseEmailDateTimeToMillis", "(", "dateString", ")", ";", "GregorianCalendar", "cal", "=", "new", "GregorianCalendar", "(", ")", ";", "cal", ".", "setTimeInMillis", "(", "dateTime", ")", ";", "cal", ".", "setTimeZone", "(", "TimeZone", ".", "getTimeZone", "(", "\"", "<STR_LIT:GMT>", "\"", ")", ")", ";", "assertEquals", "(", "cal", ".", "get", "(", "Calendar", ".", "YEAR", ")", ",", "<NUM_LIT>", ")", ";", "assertEquals", "(", "cal", ".", "get", "(", "Calendar", ".", "MONTH", ")", ",", "1", ")", ";", "assertEquals", "(", "cal", ".", "get", "(", "Calendar", ".", "DAY_OF_MONTH", ")", ",", "<NUM_LIT>", ")", ";", "assertEquals", "(", "cal", ".", "get", "(", "Calendar", ".", "HOUR_OF_DAY", ")", ",", "<NUM_LIT:16>", ")", ";", "assertEquals", "(", "cal", ".", "get", "(", "Calendar", ".", "MINUTE", ")", ",", "<NUM_LIT:16>", ")", ";", "assertEquals", "(", "cal", ".", "get", "(", "Calendar", ".", "SECOND", ")", ",", "<NUM_LIT>", ")", ";", "}", "</s>"]
