["<s>", "@", "Before", "@", "CallSuper", "public", "void", "setUp", "(", ")", "{", "TestActivity", "activity", "=", "testActivity", ".", "getActivity", "(", ")", ";", "scrollView", "=", "activity", ".", "getScrollView", "(", ")", ";", "adapter", "=", "testActivity", ".", "getActivity", "(", ")", ".", "getAdapter", "(", ")", ";", "List", "<", "IdlingResource", ">", "resources", "=", "activity", ".", "getIdlingResources", "(", ")", ";", "idlingResources", "=", "resources", ".", "toArray", "(", "new", "IdlingResource", "[", "resources", ".", "size", "(", ")", "]", ")", ";", "IdlingRegistry", ".", "getInstance", "(", ")", ".", "register", "(", "idlingResources", ")", ";", "}", "</s>"]
["<s>", "@", "After", "@", "CallSuper", "public", "void", "tearDown", "(", ")", "{", "IdlingRegistry", ".", "getInstance", "(", ")", ".", "unregister", "(", "idlingResources", ")", ";", "}", "</s>"]
["<s>", "protected", "ViewInteraction", "onScrollView", "(", ")", "{", "return", "Espresso", ".", "onView", "(", "Matchers", ".", "<", "View", ">", "is", "(", "scrollView", ")", ")", ";", "}", "</s>"]
["<s>", "protected", "void", "waitUntilScrollEnd", "(", ")", "{", "testActivity", ".", "getActivity", "(", ")", ".", "incrementExpectedScrollEndCalls", "(", ")", ";", "}", "</s>"]
["<s>", "protected", "void", "ensurePositionIs", "(", "final", "int", "position", ")", "{", "onUiThread", "(", "new", "Runnable", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "scrollView", ".", "scrollToPosition", "(", "position", ")", ";", "}", "}", ")", ";", "onScrollView", "(", ")", ".", "check", "(", "currentPositionIs", "(", "position", ")", ")", ";", "}", "</s>"]
["<s>", "protected", "void", "onUiThread", "(", "Runnable", "runnable", ")", "{", "try", "{", "testActivity", ".", "runOnUiThread", "(", "runnable", ")", ";", "}", "catch", "(", "Throwable", "throwable", ")", "{", "throw", "new", "RuntimeException", "(", "throwable", ")", ";", "}", "}", "</s>"]
["<s>", "public", "static", "ViewAssertion", "currentPositionIs", "(", "final", "int", "expectedPosition", ")", "{", "return", "new", "ViewAssertion", "(", ")", "{", "@", "Override", "public", "void", "check", "(", "View", "view", ",", "NoMatchingViewException", "noViewFoundException", ")", "{", "ensureViewFound", "(", "noViewFoundException", ")", ";", "assertThat", "(", "view", ",", "isAssignableFrom", "(", "DiscreteScrollView", ".", "class", ")", ")", ";", "DiscreteScrollView", "dsv", "=", "(", "DiscreteScrollView", ")", "view", ";", "assertThat", "(", "dsv", ".", "getCurrentItem", "(", ")", ",", "is", "(", "equalTo", "(", "expectedPosition", ")", ")", ")", ";", "View", "midChild", "=", "findCenteredChildIn", "(", "dsv", ")", ";", "assertThat", "(", "midChild", ",", "is", "(", "notNullValue", "(", ")", ")", ")", ";", "RecyclerView", ".", "ViewHolder", "holder", "=", "dsv", ".", "getChildViewHolder", "(", "midChild", ")", ";", "assertThat", "(", "holder", ".", "getAdapterPosition", "(", ")", ",", "is", "(", "equalTo", "(", "expectedPosition", ")", ")", ")", ";", "}", "}", ";", "}", "</s>"]
["<s>", "public", "static", "ViewAssertion", "doesNotHaveChildren", "(", ")", "{", "return", "new", "ViewAssertion", "(", ")", "{", "@", "Override", "public", "void", "check", "(", "View", "view", ",", "NoMatchingViewException", "noViewFoundException", ")", "{", "ensureViewFound", "(", "noViewFoundException", ")", ";", "assertThat", "(", "view", ",", "isAssignableFrom", "(", "ViewGroup", ".", "class", ")", ")", ";", "ViewGroup", "viewGroup", "=", "(", "ViewGroup", ")", "view", ";", "assertThat", "(", "viewGroup", ".", "getChildCount", "(", ")", ",", "is", "(", "equalTo", "(", "0", ")", ")", ")", ";", "}", "}", ";", "}", "</s>"]
["<s>", "private", "static", "View", "findCenteredChildIn", "(", "DiscreteScrollView", "dsv", ")", "{", "final", "int", "centerX", "=", "dsv", ".", "getWidth", "(", ")", "/", "<NUM_LIT:2>", ";", "final", "int", "centerY", "=", "dsv", ".", "getHeight", "(", ")", "/", "<NUM_LIT:2>", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "dsv", ".", "getChildCount", "(", ")", ";", "i", "+", "+", ")", "{", "View", "child", "=", "dsv", ".", "getChildAt", "(", "i", ")", ";", "if", "(", "centerX", "=", "=", "(", "child", ".", "getLeft", "(", ")", "+", "child", ".", "getWidth", "(", ")", "/", "<NUM_LIT:2>", ")", "&", "&", "centerY", "=", "=", "(", "child", ".", "getTop", "(", ")", "+", "child", ".", "getHeight", "(", ")", "/", "<NUM_LIT:2>", ")", ")", "{", "return", "child", ";", "}", "}", "throw", "new", "AssertionError", "(", "\"", "<STR_LIT>", "\"", ")", ";", "}", "</s>"]
["<s>", "private", "static", "boolean", "isMidpoint", "(", "int", "value", ",", "int", "rangeStart", ",", "int", "rangeEnd", ")", "{", "return", "value", "=", "=", "(", "rangeStart", "+", "rangeEnd", ")", "/", "<NUM_LIT:2>", ";", "}", "</s>"]
["<s>", "private", "static", "void", "ensureViewFound", "(", "NoMatchingViewException", "exception", ")", "{", "if", "(", "exception", "!", "=", "null", ")", "{", "throw", "exception", ";", "}", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "scrollToPosition_afterCurrent_changesPosition", "(", ")", "{", "final", "int", "initialPosition", "=", "scrollView", ".", "getCurrentItem", "(", ")", ";", "assertThat", "(", "initialPosition", ",", "is", "(", "lessThan", "(", "adapter", ".", "getItemCount", "(", ")", "-", "1", ")", ")", ")", ";", "onUiThread", "(", "new", "Runnable", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "scrollView", ".", "scrollToPosition", "(", "initialPosition", "+", "1", ")", ";", "}", "}", ")", ";", "onScrollView", "(", ")", ".", "check", "(", "currentPositionIs", "(", "initialPosition", "+", "1", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "scrollToPosition_beforeCurrent_changesPosition", "(", ")", "{", "assertThat", "(", "adapter", ".", "getItemCount", "(", ")", ",", "is", "(", "greaterThan", "(", "1", ")", ")", ")", ";", "final", "int", "initialPosition", "=", "adapter", ".", "getItemCount", "(", ")", "/", "<NUM_LIT:2>", ";", "ensurePositionIs", "(", "initialPosition", ")", ";", "onUiThread", "(", "new", "Runnable", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "scrollView", ".", "scrollToPosition", "(", "initialPosition", "-", "1", ")", ";", "}", "}", ")", ";", "onScrollView", "(", ")", ".", "check", "(", "currentPositionIs", "(", "initialPosition", "-", "1", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "smoothScrollToPosition_afterCurrent_changesPosition", "(", ")", "{", "final", "int", "initialPosition", "=", "scrollView", ".", "getCurrentItem", "(", ")", ";", "assertThat", "(", "initialPosition", ",", "is", "(", "lessThan", "(", "adapter", ".", "getItemCount", "(", ")", "-", "1", ")", ")", ")", ";", "waitUntilScrollEnd", "(", ")", ";", "onUiThread", "(", "new", "Runnable", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "scrollView", ".", "setItemTransitionTimeMillis", "(", "<NUM_LIT:10>", ")", ";", "scrollView", ".", "smoothScrollToPosition", "(", "initialPosition", "+", "1", ")", ";", "}", "}", ")", ";", "onScrollView", "(", ")", ".", "check", "(", "currentPositionIs", "(", "initialPosition", "+", "1", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "smoothScrollToPosition_beforeCurrent_changesPosition", "(", ")", "{", "assertThat", "(", "adapter", ".", "getItemCount", "(", ")", ",", "is", "(", "greaterThan", "(", "1", ")", ")", ")", ";", "final", "int", "initialPosition", "=", "adapter", ".", "getItemCount", "(", ")", "/", "<NUM_LIT:2>", ";", "ensurePositionIs", "(", "initialPosition", ")", ";", "waitUntilScrollEnd", "(", ")", ";", "onUiThread", "(", "new", "Runnable", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "scrollView", ".", "setItemTransitionTimeMillis", "(", "<NUM_LIT:10>", ")", ";", "scrollView", ".", "smoothScrollToPosition", "(", "initialPosition", "-", "1", ")", ";", "}", "}", ")", ";", "onScrollView", "(", ")", ".", "check", "(", "currentPositionIs", "(", "initialPosition", "-", "1", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "smoothScrollToPosition_throughSeveralPositionsAfterCurrent_changesPosition", "(", ")", "{", "final", "int", "initialPosition", "=", "scrollView", ".", "getCurrentItem", "(", ")", ";", "final", "int", "targetPosition", "=", "adapter", ".", "getItemCount", "(", ")", "-", "1", ";", "assertThat", "(", "targetPosition", "-", "initialPosition", ",", "is", "(", "greaterThan", "(", "1", ")", ")", ")", ";", "waitUntilScrollEnd", "(", ")", ";", "onUiThread", "(", "new", "Runnable", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "scrollView", ".", "setItemTransitionTimeMillis", "(", "<NUM_LIT:10>", ")", ";", "scrollView", ".", "smoothScrollToPosition", "(", "targetPosition", ")", ";", "}", "}", ")", ";", "onScrollView", "(", ")", ".", "check", "(", "currentPositionIs", "(", "targetPosition", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "smoothScrollToPosition_throughSeveralPositionsBeforeCurrent_changesPosition", "(", ")", "{", "final", "int", "initialPosition", "=", "adapter", ".", "getItemCount", "(", ")", "-", "1", ";", "final", "int", "targetPosition", "=", "0", ";", "ensurePositionIs", "(", "initialPosition", ")", ";", "assertThat", "(", "initialPosition", ",", "is", "(", "greaterThan", "(", "0", ")", ")", ")", ";", "waitUntilScrollEnd", "(", ")", ";", "onUiThread", "(", "new", "Runnable", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "scrollView", ".", "setItemTransitionTimeMillis", "(", "<NUM_LIT:10>", ")", ";", "scrollView", ".", "smoothScrollToPosition", "(", "targetPosition", ")", ";", "}", "}", ")", ";", "onScrollView", "(", ")", ".", "check", "(", "currentPositionIs", "(", "targetPosition", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "notifyItemInserted_afterCurrentPosition_currentPositionIsNotAffected", "(", ")", "{", "final", "int", "initialPosition", "=", "scrollView", ".", "getCurrentItem", "(", ")", ";", "onUiThread", "(", "new", "Runnable", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "List", "<", "TestData", ">", "data", "=", "adapter", ".", "getData", "(", ")", ";", "data", ".", "add", "(", "initialPosition", "+", "1", ",", "new", "TestData", "(", ")", ")", ";", "adapter", ".", "notifyItemInserted", "(", "initialPosition", "+", "1", ")", ";", "}", "}", ")", ";", "onScrollView", "(", ")", ".", "check", "(", "currentPositionIs", "(", "initialPosition", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "notifyItemInserted_beforeCurrentPosition_currentPositionIsShifterRightByOne", "(", ")", "{", "final", "int", "initialPosition", "=", "scrollView", ".", "getCurrentItem", "(", ")", ";", "onUiThread", "(", "new", "Runnable", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "List", "<", "TestData", ">", "data", "=", "adapter", ".", "getData", "(", ")", ";", "data", ".", "add", "(", "initialPosition", ",", "new", "TestData", "(", ")", ")", ";", "adapter", ".", "notifyItemInserted", "(", "initialPosition", ")", ";", "}", "}", ")", ";", "onScrollView", "(", ")", ".", "check", "(", "currentPositionIs", "(", "initialPosition", "+", "1", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "notifyItemRemoved_afterCurrentPosition_currentPositionIsNotAffected", "(", ")", "{", "final", "int", "initialPosition", "=", "scrollView", ".", "getCurrentItem", "(", ")", ";", "assertThat", "(", "adapter", ".", "getItemCount", "(", ")", ",", "is", "(", "greaterThan", "(", "1", ")", ")", ")", ";", "onUiThread", "(", "new", "Runnable", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "List", "<", "TestData", ">", "data", "=", "adapter", ".", "getData", "(", ")", ";", "data", ".", "remove", "(", "initialPosition", "+", "1", ")", ";", "adapter", ".", "notifyItemRemoved", "(", "initialPosition", "+", "1", ")", ";", "}", "}", ")", ";", "onScrollView", "(", ")", ".", "check", "(", "currentPositionIs", "(", "initialPosition", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "notifyItemRemoved_beforeCurrentPosition_currentPositionIsShifterLeftByOne", "(", ")", "{", "assertThat", "(", "adapter", ".", "getItemCount", "(", ")", ",", "is", "(", "greaterThan", "(", "1", ")", ")", ")", ";", "final", "int", "initialPosition", "=", "adapter", ".", "getItemCount", "(", ")", "/", "<NUM_LIT:2>", ";", "ensurePositionIs", "(", "initialPosition", ")", ";", "onUiThread", "(", "new", "Runnable", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "List", "<", "TestData", ">", "data", "=", "adapter", ".", "getData", "(", ")", ";", "data", ".", "remove", "(", "initialPosition", "-", "1", ")", ";", "adapter", ".", "notifyItemRemoved", "(", "initialPosition", "-", "1", ")", ";", "}", "}", ")", ";", "onScrollView", "(", ")", ".", "check", "(", "currentPositionIs", "(", "initialPosition", "-", "1", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "notifyItemInserted_multipleInsertsBeforeCurrent_currentIsShiftedCorrectly", "(", ")", "{", "final", "int", "numberOfInserts", "=", "<NUM_LIT:5>", ";", "final", "int", "initialPosition", "=", "scrollView", ".", "getCurrentItem", "(", ")", ";", "onUiThread", "(", "new", "Runnable", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "List", "<", "TestData", ">", "data", "=", "adapter", ".", "getData", "(", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "numberOfInserts", ";", "i", "+", "+", ")", "{", "data", ".", "add", "(", "initialPosition", ",", "new", "TestData", "(", ")", ")", ";", "adapter", ".", "notifyItemInserted", "(", "initialPosition", ")", ";", "}", "}", "}", ")", ";", "onScrollView", "(", ")", ".", "check", "(", "currentPositionIs", "(", "initialPosition", "+", "numberOfInserts", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "notifyItemRemoved_calledUntilEmpty_scrollViewIsEmpty", "(", ")", "{", "onUiThread", "(", "new", "Runnable", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "List", "<", "TestData", ">", "data", "=", "adapter", ".", "getData", "(", ")", ";", "while", "(", "data", ".", "size", "(", ")", ">", "0", ")", "{", "data", ".", "remove", "(", "0", ")", ";", "adapter", ".", "notifyItemRemoved", "(", "0", ")", ";", "}", "}", "}", ")", ";", "onScrollView", "(", ")", ".", "check", "(", "doesNotHaveChildren", "(", ")", ")", ";", "}", "</s>"]
["<s>", "@", "Test", "public", "void", "notifyItemRangeInserted_afterCurrentPosition_positionIsNotAffected", "(", ")", "{", "final", "int", "numOfItemsToInsert", "=", "<NUM_LIT:5>", ";", "final", "int", "initialPosition", "=", "scrollView", ".", "getCurrentItem", "(", ")", ";", "onUiThread", "(", "new", "Runnable", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "List", "<", "TestData", ">", "data", "=", "adapter", ".", "getData", "(", ")", ";", "data", ".", "addAll", "(", "initialPosition", "+", "1", ",", "createItems", "(", "numOfItemsToInsert", ")", ")", ";", "adapter", ".", "notifyItemRangeInserted", "(", "initialPosition", "+", "1", ",", "numOfItemsToInsert", ")", ";", "}", "}", ")", ";", "onScrollView", "(", ")", ".", "check", "(", "currentPositionIs", "(", "initialPosition", ")", ")", ";", "}", "</s>"]
